webpackJsonp([4],{"5le6":function(e,t,i){"use strict";var n=i("mvHQ"),s=i.n(n),h=i("Zrlr"),a=i.n(h),o=i("wxAW"),r=i.n(o),u=function(){function e(){a()(this,e)}return r()(e,[{key:"setItemObj",value:function(e,t){var i=s()(t);localStorage.setItem(e,i)}},{key:"getItemObj",value:function(e){var t=localStorage.getItem(e);return JSON.parse(t)}},{key:"removeItem",value:function(e){localStorage.removeItem(e)}},{key:"clear",value:function(){localStorage.clear()}}]),e}();t.a=u},HpSm:function(e,t,i){"use strict";i.d(t,"c",function(){return n}),i.d(t,"d",function(){return s}),i.d(t,"e",function(){return h}),i.d(t,"f",function(){return a}),i.d(t,"k",function(){return o}),i.d(t,"l",function(){return r}),i.d(t,"a",function(){return u}),i.d(t,"b",function(){return l}),i.d(t,"g",function(){return d}),i.d(t,"h",function(){return c}),i.d(t,"i",function(){return v}),i.d(t,"j",function(){return w}),i.d(t,"m",function(){return f});var n="SELECT_GLASSES",s={LEFT_RED_RIGHT_BLUE:"LEFT_RED_RIGHT_BLUE",LEFT_BLUE_RIGHT_RED:"LEFT_BLUE_RIGHT_RED"},h="SELECT_LAZY_EYE",a={OD:"OD",OS:"OS"},o="SELECT_VISUAL_ACUITY",r={LEVEL_1:.02,LEVEL_2:.08,LEVEL_3:.2,LEVEL_4:.8,LEVEL_5:1},u="SELECT_FUSE_TYPE",l={CENTER:"CENTER",ROUND:"ROUND",ENTIRE:"ENTIRE"},d="SELECT_TWINKLE_TYPE",c={ALTERMATE:"ALTERMATE",LAZY:"LAZY",SAME_TIME:"SAME_TIME"},v="SELECT_VERGENCE_DIRECTION",w={PFV:"PFV",NFV:"NFV"},f="TEST_FOR_FU"},vRXC:function(e,t,i){"use strict";var n=i("Zrlr"),s=i.n(n),h=i("wxAW"),a=i.n(h);var o=36,r=36,u=1280,l=720,d=[{x:.3*u,y:0},{x:.7*u,y:0}],c=["eraser","brick","steel","water","tree"],v=function(e){var t="./static/image/VTX/an907",i="./static",n=[];c.forEach(function(e){n.push({id:e,src:t+"/tiles/"+e+".png"})}),n.push({id:"hero",src:t+"/tank/hero.png"},{id:"home",src:t+"/other/home.png"},{id:"enemy",src:t+"/tank/enemy.png"},{id:"bullet",src:t+"/other/bullet.png"},{id:"born-enemy",src:t+"/other/born-enemy.png"},{id:"armor",src:t+"/other/armor.png"},{id:"explosion-tank",src:t+"/explosion/explosion-tank.png"},{id:"explosion-bullet",src:t+"/explosion/explosion-bullet.png"},{id:"explosion-home",src:t+"/explosion/explosion-home.png"},{id:"outframe",src:t+"/other/outframe.png"},{id:"life",src:t+"/other/life.png"},{id:"success",src:t+"/other/success.png"},{id:"fail",src:t+"/other/fail.png"},{id:"begin",src:t+"/page/begin.png"},{id:"begin-hover",src:t+"/page/begin-hover.png"},{id:"page",src:t+"/page/page.jpg"},{id:"mBG",src:i+"/audio/bgm/war1.mp3"},{id:"mExplosion",src:i+"/audio/sounds/explosion/explosion1.mp3"},{id:"mExplosion-home",src:i+"/audio/sounds/explosion/explosion0.mp3"},{id:"mShoot",src:i+"/audio/sounds/shoot/shoot0.mp3"});var s=new createjs.LoadQueue;s.setMaxConnections(100),s.maintainScriptOrder=!0,s.installPlugin(createjs.Sound),s.addEventListener("complete",function(){e(s)}),s.loadManifest(n)},w=i("Zx67"),f=i.n(w),y=i("zwoO"),g=i.n(y),m=i("Pf15"),p=i.n(m),b=1,k=.5,T=.5,E="rectangle",C="circle",L=[],R=[],x={LEFT:1*-Math.PI/2,RIGHT:1*Math.PI/2,UP:0,DOWN:Math.PI},S=i("27bh"),V=i.n(S),A=V.a.Common.Math.b2Vec2,B=V.a.Dynamics.b2BodyDef,D=V.a.Dynamics.b2Body,I=V.a.Dynamics.b2FixtureDef,M=V.a.Dynamics.b2World,_=V.a.Collision.Shapes.b2PolygonShape,j=V.a.Collision.Shapes.b2CircleShape,G=(V.a.Dynamics.b2DebugDraw,V.a.Dynamics.b2ContactListener),O=function(){function e(){s()(this,e)}return a()(e,[{key:"createStaticBodyDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new B;return n.type=D.b2_staticBody,n.position.x=e/30,n.position.y=t/30,i&&(n.angle=Math.PI*i/180),n}},{key:"createDynamicBodyDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new B;return n.type=D.b2_dynamicBody,n.position.x=e/30,n.position.y=t/30,i&&(n.angle=Math.PI*i/180),n}},{key:"createBodyDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=new B;return s.type=i?D.b2_staticBody:D.b2_dynamicBody,s.position.x=e/30,s.position.y=t/30,n&&(s.angle=Math.PI*n/180),s}},{key:"createRectangleFixtureDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,h=new I;return h.density=i,h.friction=n,h.restitution=s,h.shape=new _,h.shape.SetAsBox(.5*e/30,.5*t/30),h}},{key:"createCircleFixtureDef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=new I;return s.density=t,s.friction=i,s.restitution=n,s.shape=new j(e/30),s}},{key:"createSimplePolygonFixtureDef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=new I;return s.density=t,s.friction=i,s.restitution=n,s.shape=new _,s.shape.SetAsArray(e,e.length),s}},{key:"createBody",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=e.CreateBody(t);return s.SetUserData(n),s.CreateFixture(i),s}},{key:"createRectangle",value:function(e,t,i,n,s){var h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:.5,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:.1,d=this.createBodyDef(e,t,o,a),c=this.createRectangleFixtureDef(i,n,r,u,l);return this.createBody(s,d,c,h)}},{key:"createCircle",value:function(e,t,i,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:.5,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:.5,l=this.createBodyDef(e,t,a,h),d=this.createCircleFixtureDef(i,o,r,u);return this.createBody(n,l,d,s)}}]),e}(),N=null,F=new(function(){function e(){if(s()(this,e),N)return N;this.initData(),this.init(),N=this}return a()(e,[{key:"initData",value:function(){this.initModuleData()}},{key:"init",value:function(){this.buildWorld(),this.event()}},{key:"initModuleData",value:function(){this.boxCreateBody=new O}},{key:"buildWorld",value:function(){var e=new A(0,0);this.world=new M(e,!0)}},{key:"event",value:function(){this.listener=new G,this.world.SetContactListener(this.listener),this.listener.BeginContact=function(e){var t=e.GetFixtureA().GetBody().self,i=e.GetFixtureB().GetBody().self;t.handleCollision&&t.handleCollision(i),i.handleCollision&&i.handleCollision(t)}}},{key:"destroyAll",value:function(){for(var e=this,t=this.world.GetBodyList();t;)this.world.DestroyBody(t),t=t.GetNext();L.forEach(function(t){e.world.DestroyBody(t.body),t.viewLeft.parent&&t.viewLeft.parent.removeChild(t.viewLeft),t.viewRight.parent&&t.viewRight.parent.removeChild(t.viewRight);var i=R.indexOf(t);-1!==i&&R.splice(i,1)})}},{key:"update",value:function(e){this.world.Step(.001*e,8,8),this.world.DrawDebugData(),this.world.ClearForces()}}]),e}()),P=F.world,H=function(){F.destroyAll()},U=function(){function e(){s()(this,e),this.boxCreateBody=new O,this.tag="",this.imageId="",this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.radio=void 0,this.angle=void 0,this.isStatic=void 0,this.userData=null,this.body=null,this.maxV=10,this.destroyed=!1}return a()(e,[{key:"buildView",value:function(){var e=window.gameResource.getResult(this.imageId);this.view=this.buildBitmap(e),this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeft.addChild(this.view);var t=this.buildBitmap(e);this.viewRight.addChild(t),this.width=e.width,this.height=e.height,this.regx=.5*e.width,this.regy=.5*e.height,this.view.set({x:this.x,y:this.y}),t.set({x:this.x,y:this.y})}},{key:"buildBitmap",value:function(e){var t=new createjs.Bitmap(e);return t.set({regX:e.width/2,regY:e.height/2}),t}},{key:"buildBody",value:function(e){switch(e){case E:this.buildRectangleBody();break;case C:this.buildCircleBody();break;default:this.buildRectangleBody()}}},{key:"buildRectangleBody",value:function(){this.body=this.boxCreateBody.createRectangle(this.x,this.y,this.width,this.height,P,this.userData,this.angle,this.isStatic,b,k,T)}},{key:"buildCircleBody",value:function(){this.body=this.boxCreateBody.createCircle(this.x,this.y,this.radius,P,this.userData,this.angle,this.isStatic,b,k,T)}},{key:"updateViewPosition",value:function(){this.view.x=30*this.body.GetPosition().x,this.view.y=30*this.body.GetPosition().y,this.view.rotation=57.3*this.body.GetAngle()}}]),e}(),W=function(e){function t(e,i,n){s()(this,t);var h=g()(this,(t.__proto__||f()(t)).call(this));return h.imageId=e,h.x=i,h.y=n,h.tag="Tile",h.isStatic=!0,h.userData={isDeath:!1},h.init(),h}return p()(t,e),a()(t,[{key:"init",value:function(){this.buildView(),this.initBody()}},{key:"initBody",value:function(){"tree"!==this.imageId&&(this.buildBody(E),this.body.self=this)}},{key:"handleCollision",value:function(e){"Bullet"===e.tag&&"brick"===this.imageId&&L.push(this)}}]),t}(U),Y=[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,3,3,3,3,3,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0],[2,2,4,4,1,4,4,1,4,4,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,4,4,1,4,4,1,4,4,2,2],[2,2,4,4,1,4,4,1,4,4,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,4,4,1,4,4,1,4,4,2,2],[0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,3,3,3,3,3,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[4,4,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,4,4],[4,4,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,4,4],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0],[1,1,1,3,3,3,1,1,1,0,0,1,1,0,0,0,2,2,2,0,0,0,1,1,0,0,1,1,1,3,3,3,1,1,1],[0,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,2,2,2,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0],[0,0,0,3,3,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,3,3,0,0,0],[4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4],[4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4]],[[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0],[0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0],[0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0],[0,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4],[4,4,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,4,4],[4,4,4,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,4,4,4],[4,4,4,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,4,4,4],[4,4,4,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,4,4,4]]],J=function e(t,i,n){var h=this;s()(this,e);var a={images:[window.gameResource.getResult("explosion-home")],frames:{width:100,height:100},animations:{explode:[0,8,null,.1]}},o=new createjs.SpriteSheet(a);this.view=new createjs.Sprite(o),this.view.set({x:t,y:i,regX:50,regY:50}),this.view.gotoAndPlay("explode"),this.view.addEventListener("animationend",function(){h.view.parent.removeChild(h.view),n&&n()})},X=function(e){function t(){s()(this,t);var e=g()(this,(t.__proto__||f()(t)).call(this));return e.imageId="home",e.tag="heart",e.x=.5*u,e.y=l-37,e.angle=0,e.isStatic=!0,e.buildView(),e.initBody(),e}return p()(t,e),a()(t,[{key:"initBody",value:function(){this.buildBody(),this.body.self=this}},{key:"handleCollision",value:function(e){if(!this.destroyed&&"Bullet"===e.tag){this.destroyed=!0;var t=new J(this.view.x,this.view.y,function(){window.game.fail()});this.viewLeft.parent.addChild(t.view),this.viewRight.parent.addChild(t.view.clone()),this.viewLeft.parent.removeChild(this.viewLeft),this.viewRight.parent.removeChild(this.viewRight),createjs.Sound.play("mExplosion-home",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0)}}}]),t}(U),z=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,1,1,1,1,9,9,1,1],K=function(){function e(){s()(this,e),this.row=6,this.cow=4,this.width=o*this.row,this.height=r*this.cow,this.regx=.5*this.width,this.regy=.5*this.height,this.buildBrickView()}return a()(e,[{key:"buildBrickView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container;for(var e=0;e<z.length;e++)if(1===z[e]){var t=(e%this.row-2.5)*o+.5*u,i=(Math.floor(e/this.row)-3.5)*r+l,n=new W("brick",t,i);this.viewLeft.addChild(n.viewLeft),this.viewRight.addChild(n.viewRight)}}}]),e}(),Z=function(){function e(){s()(this,e),this.buildView()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.heart=new X,this.guard=new K,this.viewLeft.addChild(this.heart.viewLeft,this.guard.viewLeft),this.viewRight.addChild(this.heart.viewRight,this.guard.viewRight)}}]),e}(),q=function(){function e(){s()(this,e);var t={images:[window.gameResource.getResult("born-enemy")],frames:{width:74,height:74},animations:{open:[0,3,"close",.1],close:{frames:[3,2,1,0],next:"normal",speed:.2},normal:0}},i=new createjs.SpriteSheet(t);this.view=new createjs.Sprite(i),this.view.set({regX:37}),this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.rightView=this.view.clone(),this.viewLeft.addChild(this.view),this.viewRight.addChild(this.rightView)}return a()(e,[{key:"open",value:function(){this.view.gotoAndPlay("open"),this.rightView.gotoAndPlay("open")}}]),e}(),Q=null,$=function(){function e(){if(s()(this,e),Q)return Q;this.value=1,Q=this}return a()(e,[{key:"getLevel",value:function(){return this.value}},{key:"changeValue",value:function(e){this.value+=e}},{key:"addLevel",value:function(){this.value++}},{key:"subLevel",value:function(){this.value--}}]),e}(),ee=function(){function e(){s()(this,e),this.levelObj=new $,this.data=Y[this.levelObj.value%Y.length],this.buildView(),this.buildHome(),this.buildEnemyGate()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeftTop=new createjs.Container,this.viewRightTop=new createjs.Container;for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++){var i=this.data[e][t];if(0!==i){var n=new W(c[i],o*t+.5*o,r*e+20);"tree"===c[i]?(this.viewLeftTop.addChild(n.viewLeft),this.viewRightTop.addChild(n.viewRight)):(this.viewLeft.addChild(n.viewLeft),this.viewRight.addChild(n.viewRight))}}}},{key:"buildHome",value:function(){this.home=new Z,this.viewLeft.addChild(this.home.viewLeft),this.viewRight.addChild(this.home.viewRight)}},{key:"buildEnemyGate",value:function(){var e=this;this.enemyGates=[],d.forEach(function(t){var i=new q;e.viewLeft.addChild(i.viewLeft),e.viewRight.addChild(i.viewRight),i.viewLeft.set({x:t.x}),i.viewRight.set({x:t.x}),e.enemyGates.push(i)})}},{key:"openGate",value:function(e){this.enemyGates[e].open()}},{key:"clear",value:function(){this.enemyGates=[]}}]),e}(),te=i("fZjL"),ie=i.n(te),ne=i("woOf"),se=i.n(ne),he=i("T/kv"),ae=function(){function e(){s()(this,e),this.activeValue=!1,this.buildView()}return a()(e,[{key:"update",value:function(e){this.view.rotation+=.1*e,this.viewLeft.rotation+=.1*e,this.viewRight.rotation+=.1*e}},{key:"buildView",value:function(){var e=window.gameResource.getResult("armor");this.view=this.buildViewBitmap(e),this.viewLeft=this.buildViewBitmap(e),this.viewRight=this.buildViewBitmap(e)}},{key:"buildViewBitmap",value:function(e){var t=new createjs.Bitmap(e);return t.set({regX:e.width/2,regY:e.height/2,visible:!1}),t}},{key:"active",value:function(){this.activeValue=!0,this.view.visible=!0,this.viewLeft.visible=!0,this.viewRight.visible=!0}},{key:"deactive",value:function(){this.activeValue=!1,this.view.visible=!1,this.viewLeft.visible=!1,this.viewRight.visible=!1}},{key:"isActive",value:function(){return this.activeValue}}]),e}(),oe=function(e){function t(e){s()(this,t);var i=g()(this,(t.__proto__||f()(t)).call(this));return i.type=e,i.view=new createjs.Container,i.view.set({x:0,y:0}),i.addChild(i.view),i.initData(),i.buildView(),i.buildTank(),i}return p()(t,e),a()(t,[{key:"initData",value:function(){this.initEnemyImageData(),this.initGameSettingData(),this.initHorJumpData(),this.initFreData(),this.initTotaJumpData()}},{key:"initEnemyImageData",value:function(){this.enemyImage=window.gameResource.getResult("enemy"),this.width=this.enemyImage.width,this.height=this.enemyImage.height,this.halfWidth=.5*this.enemyImage.width,this.halfHeight=.5*this.enemyImage.height}},{key:"initGameSettingData",value:function(){this.sight=GAME_SETTING.sight[this.type],this.viewMode=GAME_SETTING.sight.viewMode,this.horizontal=GAME_SETTING.vergence.horizontal,this.rotation=GAME_SETTING.vergence.rotation,this.baseAcuity=GAME_SETTING.sight.baseAcuity,this.scale=this.getScale()}},{key:"initHorJumpData",value:function(){this.horLastFrame=0,this.horiJumpMinDis=.5*this.horizontal.rangeMin,this.horiJumpMaxDis=.5*this.horizontal.rangeMax,this.horJumpTime=this.getInteget(this.horizontal.step/this.horizontal.speed*1e3),this.getHoriSpeed()}},{key:"getHoriSpeed",value:function(){"smooth"===this.horizontal.moveMode?this.horiSpeed=this.horizontal.speed:this.horiSpeed=this.horizontal.step}},{key:"getRotaSpeed",value:function(){"smooth"===this.rotation.moveMode?this.rotaSpeed=this.rotation.speed:this.rotaSpeed=this.rotation.step}},{key:"initTotaJumpData",value:function(){this.rotaLastFrame=0,this.rotaJumpMinDis=.5*this.rotation.rangeMin,this.rotaJumpMaxDis=.5*this.rotation.rangeMax,this.rotaJumpTime=this.getInteget(this.rotation.step/this.rotation.speed*1e3),this.getRotaSpeed()}},{key:"initFreData",value:function(){this.freLastFrame=0}},{key:"getScale",value:function(){var e=this.sight.relativeAcuity;return this.baseAcuity*e}},{key:"buildView",value:function(){this.set({x:.5*window.gameWidth,y:window.gameHeight-this.halfHeight-100})}},{key:"frequency",value:function(e){if(0!==this.sight.frequency){var t=500/this.sight.frequency;this.freLastFrame+=e,this.freLastFrame>=t&&(this.freLastFrame=0,!1===this.visible?this.visible=!0:this.visible=!1)}}},{key:"update",value:function(e){this.frequency(e),"smooth"===this.horizontal.moveMode&&this.horiSmoothMove(),this.horiJumpMove(e)}},{key:"horiSmoothMove",value:function(){"BOTH"===this.viewMode&&("OS"===this.type?((this.view.x-this.horiSpeed<=this.horiJumpMinDis||this.view.x-this.horiSpeed>=this.horiJumpMaxDis)&&(this.horiSpeed*=-1),this.view.x-=this.horiSpeed):((this.view.x+this.horiSpeed<=this.horiJumpMinDis||this.view.x+this.horiSpeed>=this.horiJumpMaxDis)&&(this.horiSpeed*=-1),this.view.x+=this.horiSpeed))}},{key:"move",value:function(e,t,i,n){"OS"===this.type?((e-t<=i||e-t>=n)&&(t*=-1),e-=t):((e+t<=i||e+t>=n)&&(t*=-1),e+=t)}},{key:"horiJumpMove",value:function(e){"BOTH"===this.viewMode&&"jump"===this.horizontal.moveMode&&(this.horLastFrame+=e,this.horLastFrame>=this.horJumpTime&&(this.horLastFrame=0,this.horiSmoothMove()))}},{key:"rotaSmoonMove",value:function(){"OS"===this.type?((this.view.rotation-this.rotaSpeed<=this.rotaJumpMinDis||this.view.rotation-this.rotaSpeed>=this.rotaJumpMaxDis)&&(this.rotaSpeed*=-1),this.view.rotation-=this.rotaSpeed):((this.view.rotation+this.rotaSpeed<=this.rotaJumpMinDis||this.view.rotation+this.rotaSpeed>=this.rotaJumpMaxDis)&&(this.rotaSpeed*=-1),this.view.rotation+=this.rotaSpeed)}},{key:"rotaJumpMove",value:function(e){this.rotaLastFrame+=e,this.rotaLastFrame>=this.rotaJumpTime&&(this.rotaLastFrame=0,this.rotaSmoonMove())}},{key:"getInteget",value:function(e){return Math.ceil(e)}},{key:"buildTank",value:function(){this.tank=this.buildTankBitmap(),this.view.addChild(this.tank)}},{key:"buildTankBitmap",value:function(){var e=new createjs.Bitmap(this.enemyImage);return e.set({x:0,y:0,regX:this.halfWidth,regY:this.halfHeight,scaleX:this.scale,scaleY:this.scale}),e}}]),t}(createjs.Container),re=function(){function e(t){s()(this,e),this.assignedTarget=t,this.initGameSetting(),this.buildData(),this.buildDirectionMap(),this.buildView(),this.buildTank(),this.buildBody(),this.buildArmor()}return a()(e,[{key:"initGameSetting",value:function(){this.gameSetting=GAME_SETTING,this.viewAcuity=GAME_SETTING.sight.viewMode}},{key:"buildData",value:function(){this.tag="Enemy",this.enemyImage=window.gameResource.getResult("enemy"),this.width=this.enemyImage.width,this.height=this.enemyImage.height,this.halfWidth=.5*this.enemyImage.width,this.halfHeight=.5*this.enemyImage.height,this.zeroVelocity=new A(0,0),this.maxVelocity=5,this.direction="DOWN",this.currentTime=0,this.lastTurnTime=0,this.lastShootTime=0,this.turnDeltaTime=he.a.randomRange(1e3,4e3)}},{key:"buildBody",value:function(){var e=new B;e.type=D.b2_dynamicBody;var t=d.map(function(e){return e.x*(1/30)});this.gateNum=he.a.randomRange(0,t.length),e.position.x=t[this.gateNum],e.position.y=this.halfHeight*(1/30),e.allowSleep=!1,e.linearVelocity=this.directionToVelocity[this.direction],e.angle=x[this.direction];var i=new I;i.shape=new _;i.shape.SetAsBox((this.halfWidth-6)*(1/30),(this.halfHeight-6)*(1/30)),this.body=P.CreateBody(e),this.body.self=this.assignedTarget,this.fixture=this.body.CreateFixture(i)}},{key:"buildDirectionMap",value:function(){this.directionToVelocity={LEFT:new A(-this.maxVelocity,0),RIGHT:new A(this.maxVelocity,0),UP:new A(0,-this.maxVelocity),DOWN:new A(0,this.maxVelocity)}}},{key:"buildView",value:function(){switch(this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.view=this.buildViewContain(),this.rightView=new oe("OD"),this.leftView=new oe("OS"),this.viewAcuity){case"BOTH":this.viewLeft.addChild(this.leftView),this.viewRight.addChild(this.rightView);break;case"OS":this.viewLeft.addChild(this.leftView);break;case"OD":this.viewRight.addChild(this.rightView)}}},{key:"buildViewContain",value:function(){var e=new createjs.Container;return e.set({x:.5*u,y:l-this.halfHeight-100}),e}},{key:"buildLeftView",value:function(){this.leftView=new createjs.Container,this.gameSetting.sight.OS,this.leftView.set({x:.5*u,y:l-this.halfHeight-100}),createjs.Tween.get(this.leftView,{loop:!0}).to({visible:!1},100).to({visible:!0},50)}},{key:"buildTank",value:function(){this.tank=this.buildTankBitmap(),this.view.addChild(this.tank),this.view.tank=this.tank,this.tankRight=this.rightView.tank}},{key:"buildTankBitmap",value:function(){var e=new createjs.Bitmap(this.enemyImage);return e.set({regX:this.halfWidth,regY:this.halfHeight}),e}},{key:"buildArmor",value:function(){this.armor=new ae,this.leftView.addChild(this.armor.viewLeft),this.rightView.addChild(this.armor.viewRight)}},{key:"clear",value:function(){this.zeroVelocity=new A(0,0),this.maxVelocity=5,this.direction="DOWN",this.currentTime=0,this.lastTurnTime=0,this.lastShootTime=0,this.turnDeltaTime=he.a.randomRange(1e3,4e3),this.buildDirectionMap()}}]),e}(),ue=function e(t,i,n){var h=this;s()(this,e);var a={images:[window.gameResource.getResult("explosion-bullet")],frames:{width:34,height:34},animations:{explode:[0,8,null,.5]}},o=new createjs.SpriteSheet(a);this.view=new createjs.Sprite(o),this.view.set({x:t,y:i,regX:17,regY:17}),this.view.gotoAndPlay("explode"),this.view.addEventListener("animationend",function(){h.view.parent.removeChild(h.view),n&&n()})},le=0,de=function(){function e(t,i,n,h){s()(this,e),le++,this.num=le,this.sx=t,this.sy=i,this.tag="Bullet",this.initX=t,this.initY=i,this.angle=n,this.shooter=h,this.radius=5,this.maxV=10,this.buildView(),this.buildBody(),R.push(this),this.isRemoveSelf=!1,this.update()}return a()(e,[{key:"update",value:function(){this.updateObj(this.viewLeft),this.updateObj(this.viewRight),this.removeSelf()}},{key:"removeSelf",value:function(){(Math.abs(this.viewLeft.x-this.sx)>400||Math.abs(this.viewLeft.y-this.sy)>400||this.viewLeft.x<0||this.viewLeft.x>u)&&(this.isRemoveSelf=!0,L.push(this),this.viewLeft.parent&&this.viewLeft.parent.removeChild(this.viewLeft),this.viewRight.parent&&this.viewRight.parent.removeChild(this.viewRight))}},{key:"updateObj",value:function(e){e&&(e.x=30*this.body.GetPosition().x,e.y=30*this.body.GetPosition().y,e.rotation=57.3*this.body.GetAngle())}},{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container;var e=window.gameResource.getResult("bullet");this.view=this.buildBitmap(e),this.rightView=this.buildBitmap(e),this.viewLeft.addChild(this.view),this.viewRight.addChild(this.rightView)}},{key:"buildBitmap",value:function(e){var t=new createjs.Bitmap(e);return t.set({regX:e.width/2,regY:e.height/2}),t}},{key:"buildBody",value:function(){var e=new B;e.type=D.b2_dynamicBody,e.position.x=this.initX*(1/30),e.position.y=this.initY*(1/30),e.angle=this.angle;var t=new A(Math.sin(this.angle),-Math.cos(this.angle));t.Multiply(this.maxV),e.linearVelocity=t;var i=new I;i.isSensor=!0,i.shape=new j,i.shape.SetRadius(this.radius*(1/30)),this.body=P.CreateBody(e),this.body.self=this,this.fixture=this.body.CreateFixture(i)}},{key:"handleCollision",value:function(e){if(this.shooter.tag!==e.tag&&"wall"!==e.tag&&("Tile"!==e.tag||!["tree","water"].includes(e.imageId))){if(this.viewLeft.parent){var t=new ue(this.viewLeft.x,this.viewLeft.y);this.viewLeft.parent.addChild(t.view.clone())}if(this.viewRight.parent){var i=new ue(this.viewRight.x,this.viewRight.y);this.viewRight.parent.addChild(i.view.clone())}L.push(this)}}},{key:"clear",value:function(){R.length=0,L.length=0}}]),e}(),ce=function e(t,i,n){var h=this;s()(this,e);var a={images:[window.gameResource.getResult("explosion-tank")],frames:{width:74,height:74},animations:{explode:[0,8,null,.2]}},o=new createjs.SpriteSheet(a);this.view=new createjs.Sprite(o),this.view.set({x:t,y:i,regX:37,regY:37}),this.view.gotoAndPlay("explode"),this.view.addEventListener("animationend",function(){h.view.parent.removeChild(h.view),n&&n()})},ve=function(){function e(t){s()(this,e),this.initDataObj=new re(this),se()(this,this.initDataObj),this.world=t,this.created()}return a()(e,[{key:"created",value:function(){var e=this;this.world.map.openGate(this.gateNum),R.push(this),this.armor.active(),setTimeout(function(){e.armor.deactive()},3e3)}},{key:"updateView",value:function(e){e.x=30*this.body.GetPosition().x,e.y=30*this.body.GetPosition().y,e.tank.rotation=57.3*this.body.GetAngle()}},{key:"update",value:function(e){this.updateView(this.view),this.updateView(this.rightView),this.updateView(this.leftView),this.rightView.update(e),this.leftView.update(e),this.currentTime+=e,this.armor.update(e),this.currentTime-this.lastTurnTime>this.turnDeltaTime&&this.turn(),this.currentTime,this.lastShootTime,this.body.SetLinearVelocity(this.directionToVelocity[this.direction])}},{key:"shoot",value:function(){this.lastShootTime=this.currentTime,this.bullet=new de(this.view.x,this.view.y,this.body.GetAngle(),this);var e=this.viewLeft.parent.children.indexOf(this.viewLeft);switch(this.viewAcuity){case"BOTH":this.viewLeft.parent.addChildAt(this.bullet.viewLeft,e),this.viewRight.parent.addChildAt(this.bullet.viewRight,e);break;case"OS":this.viewLeft.parent.addChildAt(this.bullet.viewLeft,e);break;case"OD":this.viewRight.parent.addChildAt(this.bullet.viewRight,e)}}},{key:"handleCollision",value:function(e){var t=this;if(!this.destroyed){if("Bullet"===e.tag&&e.shooter.tag!==this.tag){if(this.armor.isActive())return;var i=new ce(this.view.x,this.view.y);createjs.Sound.play("mExplosion",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0),this.viewRight.parent.addChild(i.view),this.viewLeft.parent.addChild(i.view.clone()),L.push(this),this.destroyed=!0}"Bullet"!==e.tag&&setTimeout(function(){t.turn()},200)}}},{key:"turn",value:function(){this.lastTurnTime=this.currentTime,this.turnDeltaTime=he.a.randomRange(1e3,5e3),he.a.choiceExcept=function(e,t){var i=he.a.randomChoice(e);return i===t?he.a.choiceExcept(e,t):i};var e=ie()(this.directionToVelocity);this.direction=this.checkLastRow()?this.checkLastRow():he.a.choiceExcept(e,this.direction),this.checkValid()?(this.body.SetLinearVelocity(this.directionToVelocity[this.direction]),this.body.SetAngle(x[this.direction])):this.turn()}},{key:"checkLastRow",value:function(){return this.view.y>=l-this.halfHeight&&(this.view.x<u/2?"RIGHT":"LEFT")}},{key:"checkValid",value:function(){return!(this.view.y<=this.width&&"UP"===this.direction)&&(!(this.view.x<=this.width&&"LEFT"===this.direction)&&(!(this.view.x>=u-this.width&&"RIGHT"===this.direction)&&!(this.view.y>=l-this.height&&"DOWN"===this.direction)))}},{key:"clear",value:function(){this.initDataObj.clear(),R.length=0,this.bullet.clear()}}]),e}(),we=function(){function e(t){s()(this,e),this.assignedTarget=t,this.blood=3,this.maxVelocity=7,this.heroImage=window.gameResource.getResult("hero"),this.halfWidth=.5*this.heroImage.width,this.halfHeight=.5*this.heroImage.height,this.zeroVelocity=new A(0,0),this.buildDirectionMap(),this.buildView(),this.buildArmor(),this.buildTank(),this.buildBody()}return a()(e,[{key:"initStatus",value:function(){this.status={status:"",moveType:""}}},{key:"buildBody",value:function(){var e=new B;e.type=D.b2_dynamicBody,e.position.x=1/30*(.5*u-150),e.position.y=1/30*(l-50),e.allowSleep=!1;var t=new I;t.shape=new _;t.shape.SetAsBox((this.halfWidth-6)*(1/30),(this.halfHeight-6)*(1/30)),this.body=P.CreateBody(e),this.body.self=this.assignedTarget,this.fixture=this.body.CreateFixture(t)}},{key:"buildDirectionMap",value:function(){this.directionToVelocity={LEFT:new A(-this.maxVelocity,0),RIGHT:new A(this.maxVelocity,0),UP:new A(0,-this.maxVelocity),DOWN:new A(0,this.maxVelocity)}}},{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.leftView=this.buildViewBody(),this.rightView=this.buildViewBody(),this.viewLeft.addChild(this.leftView),this.viewRight.addChild(this.rightView)}},{key:"buildViewBody",value:function(){var e=new createjs.Container;return e.set({x:.5*u,y:l-this.halfHeight-100}),e}},{key:"buildTankImage",value:function(){var e=new createjs.Bitmap(this.heroImage);return e.set({regX:this.halfWidth,regY:this.halfHeight}),e}},{key:"buildTank",value:function(){this.addRightTank(),this.addLeftTank()}},{key:"addLeftTank",value:function(){this.leftTank=this.buildTankImage(),this.leftView.addChild(this.leftTank),this.leftView.addChild(this.armor.viewLeft)}},{key:"addRightTank",value:function(){this.rightTank=this.buildTankImage(),this.rightView.addChild(this.rightTank),this.rightView.addChild(this.armor.viewRight)}},{key:"buildArmor",value:function(){this.armor=new ae}},{key:"clear",value:function(){this.blood=3,this.zeroVelocity=new A(0,0),this.maxVelocity=5,this.directionToVelocity={LEFT:new A(-this.maxVelocity,0),RIGHT:new A(this.maxVelocity,0),UP:new A(0,-this.maxVelocity),DOWN:new A(0,this.maxVelocity)}}}]),e}(),fe=function(){function e(t){s()(this,e),this.index=t,this.pressedMap={},this.oldPressedMap={},this.deadZone=.1,this.setMap()}return a()(e,[{key:"update",value:function(){var e=this;this.oldPressedMap=this.pressedMap,this.pressedMap={};var t=navigator.getGamepads()[this.index];t&&(t.buttons.forEach(function(t,i){var n=e.defaultMap.buttons[i];e.pressedMap[n]=t.pressed}),t.axes.forEach(function(t,i){var n=e.defaultMap.axes[i];Math.abs(t)<e.deadZone&&(t=0),e.pressedMap[n]=t}))}},{key:"justPressed",value:function(e){return this.pressedMap[e]&&!this.oldPressedMap[e]}},{key:"pressed",value:function(e){return this.pressedMap[e]}},{key:"justRelesed",value:function(e){return!this.pressedMap[e]&&this.oldPressedMap[e]}},{key:"setMap",value:function(){this.defaultMap={buttons:{0:"A",1:"B",2:"X",3:"Y",4:"LB",5:"RB",6:"LT",7:"RT",8:"BACK",9:"START",10:"LSTICK",11:"RSTICK",12:"UP",13:"DOWN",14:"LEFT",15:"RIGHT",16:"SWITCH"},axes:{0:"ALX",1:"ALY",2:"ARX",3:"ARY"}}}}]),e}(),ye=function(){function e(){s()(this,e),this.controllers=[];for(var t=0;t<4;t++){var i=new fe(t);this.controllers.push(i)}}return a()(e,[{key:"currentNum",value:function(){for(var e=navigator.getGamepads(),t=0,i=0;i<4;i++)e[i]&&(t+=1);return t}},{key:"checkValid",value:function(e){return navigator.getGamepads()[e]}},{key:"update",value:function(){this.controllers.forEach(function(e){e.update()})}},{key:"justPressed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.controllers[t].justPressed(e)}},{key:"pressed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.controllers[t].pressed(e)}},{key:"justRelesed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.controllers[t].justPressed(e)}},{key:"pressedAny",value:function(e){for(var t=!1,i=0;i<4;i++)if(t=this.controllers[i].pressed(e))return t;return t}},{key:"justPressedAny",value:function(e){for(var t=!1,i=0;i<4;i++)if(t=this.controllers[i].justPressed(e))return t;return t}},{key:"justRelesedAny",value:function(e){for(var t=!1,i=0;i<4;i++)if(t=this.controllers[i].justRelesed(e))return t;return t}}]),e}(),ge=function(){function e(t){s()(this,e),this.parent=t,this.joysticks=new ye,this.joysticksNum=this.joysticks.currentNum(),this.direction="",this.isFire=!1,this.isRun=!0}return a()(e,[{key:"update",value:function(){this.joysticksNum&&(this.joysticks.update(),this.addEvent())}},{key:"addEvent",value:function(){switch(!0){case this.joysticks.justRelesedAny("A",0):this.isFire=!0;break;case this.joysticks.pressedAny("RIGHT",0):this.direction="RIGHT";break;case this.joysticks.pressedAny("LEFT",0):this.direction="LEFT";break;case this.joysticks.pressedAny("UP",0):this.direction="UP";break;case this.joysticks.pressedAny("DOWN",0):this.direction="DOWN"}}},{key:"directionStyle",value:function(e){["RIGHT","LEFT","UP","DOWN"].includes(e)&&(this.joysticks.pressed(e,0)?this.direction=e:this.direction="")}},{key:"fireStyle",value:function(){this.joysticks.justRelesedAny("A",0)&&console.log("object-----a"),this.joysticks.pressedAny("A",0)?this.isFire=!0:this.isFire=!1}}]),e}(),me={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTR:17,ALT:18,CAPELOCK:20,ESC:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},pe=function(){function e(){var t=this;s()(this,e),this.listenSpaceDown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;e.preventDefault(),e.keyCode===me.SPACE&&(t.isFire=!0)},this.listenKeyDirectionDown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;if([me.UP,me.DOWN,me.LEFT,me.RIGHT].includes(e.keyCode)){switch(e.keyCode){case me.UP:t.direction="UP";break;case me.DOWN:t.direction="DOWN";break;case me.LEFT:t.direction="LEFT";break;case me.RIGHT:t.direction="RIGHT"}t.directions[e.keyCode]=t.direction}},this.listenKeyDirectionUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;if(e.preventDefault(),[me.UP,me.DOWN,me.LEFT,me.RIGHT].includes(e.keyCode))for(var i in t.directions[e.keyCode]="",t.directions)if(t.directions.hasOwnProperty(i)){var n=t.directions[i];if(n)return void(t.direction=n);t.direction=""}},this.listenKeySpaceUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;e.preventDefault(),!e.keyCode!==me.SPACE&&(t.isFire=!1)},this.isFire=!1,this.direction="",this.directions={},this.addEventListener()}return a()(e,[{key:"addEventListener",value:function(){document.addEventListener("keydown",this.listenSpaceDown,!1),document.addEventListener("keydown",this.listenKeyDirectionDown,!1),document.addEventListener("keyup",this.listenKeyDirectionUp,!1),document.addEventListener("keyup",this.listenKeySpaceUp,!1)}},{key:"removeEvtLister",value:function(){document.removeEventListener("keydown",this.listenKeyDown,!1),document.removeEventListener("keyup",this.listenKeySpaceUp,!1)}}]),e}(),be=function(){function e(t){s()(this,e),this.parent=t,this.handleEvent=new ge,this.keyEvent=new pe,this.isFire=!1,this.direction=""}return a()(e,[{key:"update",value:function(){this.handleEvent.joysticksNum&&this.handleEvent.update(),this.isFire=this.keyEvent.isFire||this.handleEvent.isFire,this.direction=this.keyEvent.direction||this.handleEvent.direction}},{key:"removeEvent",value:function(){this.keyEvent.removeEvtLister(),this.handleEvent.joysticksNum&&(this.handleEvent.isRun=!1)}},{key:"isHandle",value:function(){return this.handleEvent.joysticksNum}},{key:"restartFire",value:function(){this.handleEvent.joysticksNum&&(this.handleEvent.isFire=!1),this.keyEvent.isFire=!1,this.isFire=!1}},{key:"restartDirection",value:function(){this.handleEvent.joysticksNum&&(this.handleEvent.direction="")}}]),e}(),ke=function(e){function t(){s()(this,t);var e=g()(this,(t.__proto__||f()(t)).call(this));return e.imageId=null,e}return p()(t,e),a()(t,[{key:"build",value:function(){this.tag=this.imageId,this.id=this.imageId,this.image=window.gameResource.getResult(this.imageId),this.width=this.image.width,this.height=this.image.height,this.regx=.5*this.width,this.regy=.5*this.height}},{key:"getTag",value:function(){return this.tag}}]),t}(createjs.Bitmap),Te=function(e){function t(e){s()(this,t);var i=g()(this,(t.__proto__||f()(t)).call(this));return i.imageId=e,i.build(),i}return p()(t,e),t}(ke),Ee=null,Ce=function(e){function t(){var e;s()(this,t);var i=g()(this,(t.__proto__||f()(t)).call(this));return Ee?(e=Ee,g()(i,e)):(i.imageId="life",i.textNum=3,i.buildView(),Ee=i,i)}return p()(t,e),a()(t,[{key:"clear",value:function(){this.textNum=3}}]),t}(function(){function e(){s()(this,e),this.imageId=null,this.value=0}return a()(e,[{key:"buildView",value:function(){this.view=new createjs.Container,this.buildButton(),this.buildText()}},{key:"buildButton",value:function(){this.buttonImage=new Te(this.imageId),this.view.addChild(this.buttonImage)}},{key:"buildText",value:function(){this.textShow=new createjs.Text(this.textNum,"30px Arial","#ff7700"),this.textShow.set({x:144,y:this.buttonImage.regy,textAlign:"center",textBaseline:"middle"}),this.view.addChild(this.textShow)}},{key:"getValue",value:function(){return this.textShow.text}},{key:"changeValue",value:function(e){this.textShow.text+=e}},{key:"increaseValue",value:function(){this.textShow.text++}},{key:"reduceValue",value:function(){this.textShow.text--}}]),e}()),Le=function(){function e(t){s()(this,e),this.env=t,this.tag="Hero",this.shootTime=200,this.shootLastTime=0,this.event=new be(this),this.initDataObj=new we(this),se()(this,this.initDataObj),this.heroLife=new Ce,R.push(this),this.leftBullet=!1}return a()(e,[{key:"update",value:function(e){this.updateView(this.leftView),this.updateView(this.rightView),this.updateControled(e),this.armor.isActive()&&this.armor.update(e)}},{key:"updateView",value:function(e){e&&(e.x=30*this.body.GetPosition().x,e.y=30*this.body.GetPosition().y,e.rotation=57.3*this.body.GetAngle())}},{key:"shoot",value:function(){createjs.Sound.play("mShoot",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0),this.bullet=new de(this.rightView.x,this.rightView.y,this.body.GetAngle(),this);var e=this.viewRight.parent.children.indexOf(this.viewRight);this.viewLeft.parent.addChildAt(this.bullet.viewLeft,e),this.viewRight.parent.addChildAt(this.bullet.viewRight,e)}},{key:"shootUpdate",value:function(e){var t=Math.floor(e);if(this.shootLastTime+=t,this.shootLastTime>=this.shootTime&&this.event.isFire)return this.event.restartFire(),this.shoot(),void(this.shootLastTime=0)}},{key:"directionUpdate",value:function(e){if(this.event.direction){this.direction=this.event.direction;var t=this.direction;this.body.SetLinearDamping(0),this.body.SetLinearVelocity(this.directionToVelocity[t]),this.body.SetAngle(x[t]),this.event.restartDirection(),e=!0}e||this.body.SetLinearVelocity(this.zeroVelocity)}},{key:"updateControled",value:function(e){this.event.update(),this.shootUpdate(e),this.directionUpdate(!1)}},{key:"handleCollision",value:function(e){if(!this.armor.isActive()&&"Bullet"===e.tag&&e.shooter.tag!==this.tag){var t=new ce(this.leftView.x,this.leftView.y);if(this.viewLeft.parent.addChild(t.view),this.viewRight.parent.addChild(t.view.clone()),createjs.Sound.play("mExplosion",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0),this.heroLife.changeValue(-1),0===this.heroLife.getValue())return void window.game.fail();this.reborn()}}},{key:"reborn",value:function(){var e=this;this.rightTank&&(this.rightTank.visible=!1),this.leftTank&&(this.leftTank.visible=!1),this.armor.active(),setTimeout(function(){var t=1/30*(.5*u-150),i=1/30*(l-50);e.body.SetPosition(new A(t,i)),e.body.SetAngle(0)},0),setTimeout(function(){e.rightTank&&(e.rightTank.visible=!0),e.leftTank&&(e.leftTank.visible=!0)},1e3),setTimeout(function(){e.armor.deactive()},3e3)}},{key:"clear",value:function(){this.heroLife.clear(),this.initDataObj.clear(),this.bullet.clear()}}]),e}(),Re=function(){function e(t){s()(this,e),this.angle=t,this.tag="wall",this.buildBody()}return a()(e,[{key:"buildBody",value:function(){var e=this,t=new B;t.position.x=.5*u*(1/30),t.position.y=.5*l*(1/30),t.type=D.b2_staticBody,this.body=P.CreateBody(t),this.body.self=this;[{localPosition:new A((10+u)*(1/30)*.5,0),angle:0},{localPosition:new A(1/30*-(10+u)*.5,0),angle:0},{localPosition:new A(0,1/30*-(l+10)*.5),angle:.5*Math.PI},{localPosition:new A(0,(l+10)*(1/30)*.5),angle:.5*Math.PI}].forEach(function(t){var i=new _,n=t.localPosition;n.Add(new A(1/30*10,1/30*10));var s=t.angle;i.SetAsOrientedBox(1/30*10*.5,.5*u*(1/30),n,s),e.fixture=e.body.CreateFixture2(i)})}},{key:"handleCollision",value:function(e){"Bullet"===e.tag&&(this.tag="wall")}}]),e}(),xe=function(){function e(t){s()(this,e),this.game=t,createjs.Tween.removeAllTweens(),this.view=new createjs.Container,this.maxEnemies=20,this.enemyBuild=0,this.enemyArry=[],this.destroyedEnemy=0,this.buildView(),this.buildWall(),this.buildBG(),this.buildMap(),this.buildHero(),this.buildEnemy(3),this.addMapTop()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=(new createjs.Container).set({scaleX:.5}),this.viewRight=(new createjs.Container).set({scaleX:.5}),this.viewRight.set({x:.5*u}),this.view.addChild(this.viewLeft,this.viewRight)}},{key:"buildBG",value:function(){var e=new createjs.Shape;e.graphics.f("#cccccc").dr(0,0,1280,720),this.viewLeft.addChild(e),this.viewRight.addChild(e.clone())}},{key:"update",value:function(e){var t=this;!function(e){F.update(e)}(e),R.forEach(function(t){t.update(e)}),L.forEach(function(e){P.DestroyBody(e.body),e.viewLeft.parent&&e.viewLeft.parent.removeChild(e.viewLeft),e.viewRight.parent&&e.viewRight.parent.removeChild(e.viewRight);var i=R.indexOf(e);-1!==i&&R.splice(i,1),"Enemy"===e.tag&&t.handleEnemyDestroyed()}),L.length=0}},{key:"handleEnemyDestroyed",value:function(){this.destroyedEnemy++,this.destroyedEnemy!==this.maxEnemies||this.map.home.heart.destroyed?this.enemyBuild<this.maxEnemies&&this.buildEnemy():this.game.succeed()}},{key:"buildMap",value:function(){this.map=new ee,this.viewLeft.addChild(this.map.viewLeft),this.viewRight.addChild(this.map.viewRight)}},{key:"buildHero",value:function(){this.hero=new Le,this.viewLeft.addChildAt(this.hero.viewLeft,2),this.viewRight.addChildAt(this.hero.viewRight,2)}},{key:"buildEnemy",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.enemyBuild++,t--,setTimeout(function(){var t=new ve(e);e.enemyArry.push(t),e.viewLeft.addChildAt(t.viewLeft,2),e.viewRight.addChildAt(t.viewRight,2)},0),t>0&&setTimeout(function(){e.buildEnemy(t)},1e3)}},{key:"addMapTop",value:function(){this.viewLeft.addChild(this.map.viewLeftTop),this.viewRight.addChild(this.map.viewRightTop)}},{key:"buildWall",value:function(){this.wall=new Re}},{key:"clear",value:function(){this.hero.clear(),this.enemyArry.map(function(e){return e.clear()}),this.enemyArry=[]}}]),e}(),Se=function(e){function t(e){s()(this,t);var i=g()(this,(t.__proto__||f()(t)).call(this));return i.imageId=e,i.build(),i.x=.5*window.innerWidth,i.y=.5*window.innerHeight,i.regX=i.regx,i.regY=i.regy,i}return p()(t,e),t}(ke),Ve=function e(t){s()(this,e);var i=new Se(t),n=new Se(t);this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeft.addChild(i),this.viewRight.addChild(n)},Ae=function(e){function t(e){s()(this,t);var i=g()(this,(t.__proto__||f()(t)).call(this));return i.imageId=e,i.build(),i}return p()(t,e),t}(ke),Be=function(e){function t(e){s()(this,t);var i=g()(this,(t.__proto__||f()(t)).call(this));return i.callback=e,i.buildButton(),i}return p()(t,e),a()(t,[{key:"buildButton",value:function(){this.button=new Ae("begin"),this.buttonHover=new Ae("begin-hover"),this.buttonHover.visible=!1,this.addChild(this.button,this.buttonHover)}},{key:"addEvent",value:function(){var e=this;this.addEventListener("mouseover",function(){e.button.visible=!1,e.buttonHover.visible=!0,e.cursor="pointer"}),this.addEventListener("mouseout",function(){e.cursor="default",e.button.visible=!0,e.buttonHover.visible=!1}),this.addEventListener("mousedown",function(){e.cursor="pointer",e.callback()})}}]),t}(createjs.Container),De=function(){function e(t){s()(this,e),this.callback=t,this.buildView()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.buildBg(),this.buildButton(),this.buttonEvent()}},{key:"buildBg",value:function(){this.bg=new Ae("page"),this.viewLeft.addChild(this.bg),this.viewRight.addChild(this.bg.clone())}},{key:"buildButton",value:function(){this.leftButtonContain=new Be(this.callback),this.rightButtonContain=new Be(this.callback),this.leftButtonContain.set({x:890,y:535}),this.rightButtonContain.set({x:890,y:535}),this.viewLeft.addChild(this.leftButtonContain),this.viewRight.addChild(this.rightButtonContain)}},{key:"buttonEvent",value:function(){this.buttonEventBase(this.leftButtonContain,this.rightButtonContain),this.buttonEventBase(this.rightButtonContain,this.leftButtonContain)}},{key:"buttonEventBase",value:function(e,t){var i=this;e.addEventListener("mouseover",function(){e.button.visible=!1,e.buttonHover.visible=!0,e.cursor="pointer",t.button.visible=!1,t.buttonHover.visible=!0,t.cursor="pointer"}),e.addEventListener("mouseout",function(){e.cursor="default",e.button.visible=!0,e.buttonHover.visible=!1,t.cursor="default",t.button.visible=!0,t.buttonHover.visible=!1}),e.addEventListener("mousedown",function(){e.cursor="pointer",t.cursor="pointer",i.callback()})}}]),e}(),Ie=function(){function e(){var t=this;s()(this,e);var i=function(e){var t=document.createElement("canvas"),i=document.getElementById("stage");document.getElementsByTagName("main")[0],document.documentElement.style.overflow="hidden";var n=document.getElementById("main"),s=parseFloat(n.style.transform.match(/\d+(\.\d+)?/g)),h=window.innerWidth/1280,a=window.innerHeight/720;h>=a?(h/=s,a=1):(h=1,a/=s);var o=i.style.cssText,r="transform:scale("+h+","+a+")";return i.style.cssText=o+r,t.id="game-canvas",t.id=e,t.width=1280,t.height=720,i.appendChild(t),t}("game-canvas");this.stage=new createjs.Stage("game-canvas"),this.stage.width=i.width,this.stage.height=i.height,this.stage.enableMouseOver(),createjs.Touch.enable(this.stage),this.lastFrame=0,window.gameResource?this.onLoadingComplete():v(function(e){window.gameResource=e,t.onLoadingComplete()})}return a()(e,[{key:"buildView",value:function(){this.viewLeft=(new createjs.Container).set({scaleX:.5}),this.viewRight=(new createjs.Container).set({scaleX:.5}),this.viewRight.set({x:.5*u}),this.stage.addChild(this.viewLeft,this.viewRight)}},{key:"onLoadingComplete",value:function(){var e=this;this.buildView();var t=new De(function(){e.stage.removeAllChildren(),e.stage.removeAllEventListeners(),e.buildWorld(),e.buildLevel(),e.buildLife(),createjs.Sound.play("mBG",createjs.Sound.INTERRUPT_NONE,0,0,-1,.3,0)});this.viewLeft.addChild(t.viewLeft),this.viewRight.addChild(t.viewRight),this.render()}},{key:"buildWorld",value:function(){this.worldView&&this.stage.removeChild(this.worldView.view),H(),this.worldView=new xe(this),this.stage.addChildAt(this.worldView.view,0)}},{key:"buildLevel",value:function(){this.level=new $}},{key:"buildLife",value:function(){this.heroLife=new Ce}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!window.__GAME_STATE.pause&&!this.failValue){var i=t-this.lastFrame;(i>150||i<0)&&(i=0),this.lastFrame=t,this.worldView&&this.worldView.update(i),this.stage.update(),requestAnimationFrame(function(t){e.render(t)})}}},{key:"fail",value:function(){var e=new Ve("fail");"OS"===GAME_SETTING.sight.viewMode?this.worldView.viewLeft.addChild(e.viewLeft):this.worldView.viewRight.addChild(e.viewRight),H(),R.length=0,this.failValue=!0,setTimeout(function(){location.reload()},3e3)}},{key:"succeed",value:function(){var e=this,t=new Ve("success");R.length=0,L.length=0,"OS"===GAME_SETTING.sight.viewMode?this.worldView.viewLeft.addChild(t.viewLeft):this.worldView.viewRight.addChild(t.viewRight),setTimeout(function(){e.level.changeValue(1),e.stage.removeChild(t),e.buildWorld()},1e3)}},{key:"pause",value:function(){window.__GAME_STATE.pause=ture}},{key:"continue",value:function(){window.__GAME_STATE.pause&&(window.__GAME_STATE.pause=!1,this.render())}},{key:"replay",value:function(){this.stage.removeAllChildren(),this.stage.removeAllEventListeners(),this.stage.enableMouseOver(0),createjs.Sound.stop(),this.pause()}},{key:"close",value:function(){this.stage.removeAllChildren(),this.stage.removeAllEventListeners(),this.stage.enableMouseOver(0),createjs.Sound.stop(),H(),R.length=0,this.failValue=!0,setTimeout(function(){location.reload()},3e3)}}]),e}();t.a=Ie},vnc9:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Zx67"),s=i.n(n),h=i("Zrlr"),a=i.n(h),o=i("wxAW"),r=i.n(o),u=i("zwoO"),l=i.n(u),d=i("Pf15"),c=i.n(d),v=i("vRXC"),w=i("5le6");var f=function(){var e=(new w.a).getItemObj("settings");return{sight:{viewMode:"BOTH",baseAcuity:1,OD:{relativeAcuity:1,frequency:0,sensitivity:.5,blur:"",brightness:"",background:""},OS:{relativeAcuity:1,frequency:0,sensitivity:.5,blur:"",brightness:"",background:""}},vergence:{horizontal:{horizonAxis:"",rangeMin:parseInt(e.TEST_FOR_FU[1]),rangeMax:parseInt(e.TEST_FOR_FU[0]),moveMode:"smooth",speed:.5,step:10},rotation:{zAxis:1,rangeMin:-100,rangeMax:200,moveMode:"smooth",speed:10,step:1}},distance:1}},y=(i("xPv/"),i("x8p/"),i("HpSm")),g={BASE_CONFIG:{NAME:"坦克大战",TYPE:"VTX",INTRODUCTION:"本训练为脱抑制训练。场景中有敌方坦克巡逻，你的任务是控制\n    自己的坦克保卫下方的基地。使用方向键控制前进的方向。使用键盘空格键或手柄 A\n    发射子弹。当一定数量的坦克被摧毁后，进入下一关。\n    "},TRAINING_CONFIG:{TRAINING_SETTINGS:[y.c,y.m]},GAME_CONFIG:{GAME_ITEMS:[],GAME_SETTINGS:[]}},m=function(e){function t(){a()(this,t);var e=l()(this,(t.__proto__||s()(t)).call(this));return e.initializationConfig(),e}return c()(t,e),r()(t,[{key:"initializationConfig",value:function(){window.GAME_SETTING=f()}}]),t}(v.a);t.default=m;window._CONFIG=g,window._GAME=m},"x8p/":function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s});var n="SELECT_DIFFCULTY",s={EASY:"EASY",MEDIUM:"MEDIUM",HARD:"HARD"}},"xPv/":function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"c",function(){return s}),i.d(t,"a",function(){return h});var n="PAUSE_BUTTON",s="REPLAY_BUTTON",h="INTRODUCTION_BUTTON"}},["vnc9"]);