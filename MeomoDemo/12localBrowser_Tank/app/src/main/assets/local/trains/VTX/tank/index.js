webpackJsonp([7],{HpSm:function(e,t,i){"use strict";i.d(t,"c",function(){return n}),i.d(t,"d",function(){return s}),i.d(t,"e",function(){return h}),i.d(t,"f",function(){return a}),i.d(t,"k",function(){return o}),i.d(t,"l",function(){return r}),i.d(t,"a",function(){return l}),i.d(t,"b",function(){return u}),i.d(t,"g",function(){return d}),i.d(t,"h",function(){return c}),i.d(t,"i",function(){return v}),i.d(t,"j",function(){return w}),i.d(t,"m",function(){return f});var n="SELECT_GLASSES",s={LEFT_RED_RIGHT_BLUE:"LEFT_RED_RIGHT_BLUE",LEFT_BLUE_RIGHT_RED:"LEFT_BLUE_RIGHT_RED"},h="SELECT_LAZY_EYE",a={OD:"OD",OS:"OS"},o="SELECT_VISUAL_ACUITY",r={LEVEL_1:.02,LEVEL_2:.08,LEVEL_3:.2,LEVEL_4:.8,LEVEL_5:1},l="SELECT_FUSE_TYPE",u={CENTER:"CENTER",ROUND:"ROUND",ENTIRE:"ENTIRE"},d="SELECT_TWINKLE_TYPE",c={ALTERMATE:"ALTERMATE",LAZY:"LAZY",SAME_TIME:"SAME_TIME"},v="SELECT_VERGENCE_DIRECTION",w={PFV:"PFV",NFV:"NFV"},f="TEST_FOR_FU"},UR7H:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Zrlr"),s=i.n(n),h=i("wxAW"),a=i.n(h),o=i("xPv/"),r=i("x8p/"),l=i("HpSm"),u={BASE_CONFIG:{NAME:"坦克大战",TYPE:"VTX",INTRODUCTION:""},TRAINING_CONFIG:{TRAINING_SETTINGS:[l.c,l.e,l.k]},GAME_CONFIG:{GAME_ITEMS:[o.b,o.c,o.a],GAME_SETTINGS:[r.a]}};var d=36,c=36,v=1280,w=720,f=[{x:.3*v,y:0},{x:.7*v,y:0}],y=["eraser","brick","steel","water","tree"],g=function(e){var t="./static/image/VTX/an907",i="./static",n=[];y.forEach(function(e){n.push({id:e,src:t+"/tiles/"+e+".png"})}),n.push({id:"hero",src:t+"/tank/hero.png"},{id:"home",src:t+"/other/home.png"},{id:"enemy",src:t+"/tank/enemy.png"},{id:"bullet",src:t+"/other/bullet.png"},{id:"born-enemy",src:t+"/other/born-enemy.png"},{id:"armor",src:t+"/other/armor.png"},{id:"explosion-tank",src:t+"/explosion/explosion-tank.png"},{id:"explosion-bullet",src:t+"/explosion/explosion-bullet.png"},{id:"explosion-home",src:t+"/explosion/explosion-home.png"},{id:"outframe",src:t+"/other/outframe.png"},{id:"life",src:t+"/other/life.png"},{id:"success",src:t+"/other/success.png"},{id:"fail",src:t+"/other/fail.png"},{id:"begin",src:t+"/page/begin.png"},{id:"begin-hover",src:t+"/page/begin-hover.png"},{id:"page",src:t+"/page/page.jpg"},{id:"mBG",src:i+"/audio/bgm/war1.mp3"},{id:"mExplosion",src:i+"/audio/sounds/explosion/explosion1.mp3"},{id:"mExplosion-home",src:i+"/audio/sounds/explosion/explosion0.mp3"},{id:"mShoot",src:i+"/audio/sounds/shoot/shoot0.mp3"});var s=new createjs.LoadQueue;s.setMaxConnections(100),s.maintainScriptOrder=!0,s.installPlugin(createjs.Sound),s.addEventListener("complete",function(){e(s)}),s.loadManifest(n)},m=i("Zx67"),p=i.n(m),b=i("zwoO"),k=i.n(b),C=i("Pf15"),T=i.n(C),x=1,L=.5,E=.5,R="rectangle",S="circle",V=[],D=[],B={LEFT:1*-Math.PI/2,RIGHT:1*Math.PI/2,UP:0,DOWN:Math.PI},A=i("27bh"),j=i.n(A),I=j.a.Common.Math.b2Vec2,M=j.a.Dynamics.b2BodyDef,_=j.a.Dynamics.b2Body,F=j.a.Dynamics.b2FixtureDef,G=j.a.Dynamics.b2World,O=j.a.Collision.Shapes.b2PolygonShape,N=j.a.Collision.Shapes.b2CircleShape,P=(j.a.Dynamics.b2DebugDraw,j.a.Dynamics.b2ContactListener),H=function(){function e(){s()(this,e)}return a()(e,[{key:"createStaticBodyDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new M;return n.type=_.b2_staticBody,n.position.x=e/30,n.position.y=t/30,i&&(n.angle=Math.PI*i/180),n}},{key:"createDynamicBodyDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=new M;return n.type=_.b2_dynamicBody,n.position.x=e/30,n.position.y=t/30,i&&(n.angle=Math.PI*i/180),n}},{key:"createBodyDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=new M;return s.type=i?_.b2_staticBody:_.b2_dynamicBody,s.position.x=e/30,s.position.y=t/30,n&&(s.angle=Math.PI*n/180),s}},{key:"createRectangleFixtureDef",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,h=new F;return h.density=i,h.friction=n,h.restitution=s,h.shape=new O,h.shape.SetAsBox(.5*e/30,.5*t/30),h}},{key:"createCircleFixtureDef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=new F;return s.density=t,s.friction=i,s.restitution=n,s.shape=new N(e/30),s}},{key:"createSimplePolygonFixtureDef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=new F;return s.density=t,s.friction=i,s.restitution=n,s.shape=new O,s.shape.SetAsArray(e,e.length),s}},{key:"createBody",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=e.CreateBody(t);return s.SetUserData(n),s.CreateFixture(i),s}},{key:"createRectangle",value:function(e,t,i,n,s){var h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:.5,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:.1,d=this.createBodyDef(e,t,o,a),c=this.createRectangleFixtureDef(i,n,r,l,u);return this.createBody(s,d,c,h)}},{key:"createCircle",value:function(e,t,i,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:.5,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:.5,u=this.createBodyDef(e,t,a,h),d=this.createCircleFixtureDef(i,o,r,l);return this.createBody(n,u,d,s)}}]),e}(),U=null,W=new(function(){function e(){if(s()(this,e),U)return U;this.initData(),this.init(),U=this}return a()(e,[{key:"initData",value:function(){this.initModuleData()}},{key:"init",value:function(){this.buildWorld(),this.event()}},{key:"initModuleData",value:function(){this.boxCreateBody=new H}},{key:"buildWorld",value:function(){var e=new I(0,0);this.world=new G(e,!0)}},{key:"event",value:function(){this.listener=new P,this.world.SetContactListener(this.listener),this.listener.BeginContact=function(e){var t=e.GetFixtureA().GetBody().self,i=e.GetFixtureB().GetBody().self;t.handleCollision&&t.handleCollision(i),i.handleCollision&&i.handleCollision(t)}}},{key:"destroyAll",value:function(){for(var e=this.world.GetBodyList();e;)this.world.DestroyBody(e),e=e.GetNext()}},{key:"update",value:function(e){this.world.Step(.001*e,8,8),this.world.DrawDebugData(),this.world.ClearForces()}}]),e}()),Y=W.world,J=function(){function e(){s()(this,e),this.boxCreateBody=new H,this.tag="",this.imageId="",this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.radio=void 0,this.angle=void 0,this.isStatic=void 0,this.userData=null,this.body=null,this.maxV=10,this.destroyed=!1}return a()(e,[{key:"buildView",value:function(){var e=window.gameResource.getResult(this.imageId);this.view=this.buildBitmap(e),this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeft.addChild(this.view);var t=this.buildBitmap(e);this.viewRight.addChild(t),this.width=e.width,this.height=e.height,this.regx=.5*e.width,this.regy=.5*e.height,this.view.set({x:this.x,y:this.y}),t.set({x:this.x,y:this.y})}},{key:"buildBitmap",value:function(e){var t=new createjs.Bitmap(e);return t.set({regX:e.width/2,regY:e.height/2}),t}},{key:"buildBody",value:function(e){switch(e){case R:this.buildRectangleBody();break;case S:this.buildCircleBody();break;default:this.buildRectangleBody()}}},{key:"buildRectangleBody",value:function(){this.body=this.boxCreateBody.createRectangle(this.x,this.y,this.width,this.height,Y,this.userData,this.angle,this.isStatic,x,L,E)}},{key:"buildCircleBody",value:function(){this.body=this.boxCreateBody.createCircle(this.x,this.y,this.radius,Y,this.userData,this.angle,this.isStatic,x,L,E)}},{key:"updateViewPosition",value:function(){this.view.x=30*this.body.GetPosition().x,this.view.y=30*this.body.GetPosition().y,this.view.rotation=57.3*this.body.GetAngle()}}]),e}(),X=function(e){function t(e,i,n){s()(this,t);var h=k()(this,(t.__proto__||p()(t)).call(this));return h.imageId=e,h.x=i,h.y=n,h.tag="Tile",h.isStatic=!0,h.userData={isDeath:!1},h.init(),h}return T()(t,e),a()(t,[{key:"init",value:function(){this.buildView(),this.initBody()}},{key:"initBody",value:function(){"tree"!==this.imageId&&(this.buildBody(R),this.body.self=this)}},{key:"handleCollision",value:function(e){"Bullet"===e.tag&&"brick"===this.imageId&&V.push(this)}}]),t}(J),z=[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,3,3,3,3,3,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0],[2,2,4,4,1,4,4,1,4,4,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,4,4,1,4,4,1,4,4,2,2],[2,2,4,4,1,4,4,1,4,4,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,4,4,1,4,4,1,4,4,2,2],[0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,3,3,3,3,3,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[4,4,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,4,4],[4,4,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,4,4],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0],[1,1,1,3,3,3,1,1,1,0,0,1,1,0,0,0,2,2,2,0,0,0,1,1,0,0,1,1,1,3,3,3,1,1,1],[0,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,2,2,2,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0],[0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0],[0,0,0,3,3,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,3,3,0,0,0],[4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4],[4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4]],[[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1],[0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0],[0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0],[0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0],[0,0,0,0,1,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1,0,0,0,0],[0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4],[4,4,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,4,4],[4,4,4,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,4,4,4],[4,4,4,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,4,4,4],[4,4,4,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,4,4,4]]],K=function e(t,i,n){var h=this;s()(this,e);var a={images:[window.gameResource.getResult("explosion-home")],frames:{width:100,height:100},animations:{explode:[0,8,null,.1]}},o=new createjs.SpriteSheet(a);this.view=new createjs.Sprite(o),this.view.set({x:t,y:i,regX:50,regY:50}),this.view.gotoAndPlay("explode"),this.view.addEventListener("animationend",function(){h.view.parent.removeChild(h.view),n&&n()})},Z=function(e){function t(){s()(this,t);var e=k()(this,(t.__proto__||p()(t)).call(this));return e.imageId="home",e.tag="heart",e.x=.5*v,e.y=w-37,e.angle=0,e.isStatic=!0,e.buildView(),e.initBody(),e}return T()(t,e),a()(t,[{key:"initBody",value:function(){this.buildBody(),this.body.self=this}},{key:"handleCollision",value:function(e){if(!this.destroyed&&"Bullet"===e.tag){this.destroyed=!0;var t=new K(this.view.x,this.view.y,function(){window.game.fail()});this.viewLeft.parent.addChild(t.view),this.viewRight.parent.addChild(t.view.clone()),this.viewLeft.parent.removeChild(this.viewLeft),this.viewRight.parent.removeChild(this.viewRight),createjs.Sound.play("mExplosion-home",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0)}}}]),t}(J),q=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,1,1,1,1,9,9,1,1],Q=function(){function e(){s()(this,e),this.row=6,this.cow=4,this.width=d*this.row,this.height=c*this.cow,this.regx=.5*this.width,this.regy=.5*this.height,this.buildBrickView()}return a()(e,[{key:"buildBrickView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container;for(var e=0;e<q.length;e++)if(1===q[e]){var t=(e%this.row-2.5)*d+.5*v,i=(Math.floor(e/this.row)-3.5)*c+w,n=new X("brick",t,i);this.viewLeft.addChild(n.viewLeft),this.viewRight.addChild(n.viewRight)}}}]),e}(),$=function(){function e(){s()(this,e),this.buildView()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.heart=new Z,this.guard=new Q,this.viewLeft.addChild(this.heart.viewLeft,this.guard.viewLeft),this.viewRight.addChild(this.heart.viewRight,this.guard.viewRight)}}]),e}(),ee=function(){function e(){s()(this,e);var t={images:[window.gameResource.getResult("born-enemy")],frames:{width:74,height:74},animations:{open:[0,3,"close",.1],close:{frames:[3,2,1,0],next:"normal",speed:.2},normal:0}},i=new createjs.SpriteSheet(t);this.view=new createjs.Sprite(i),this.view.set({regX:37}),this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeft.addChild(this.view),this.viewRight.addChild(this.view.clone())}return a()(e,[{key:"open",value:function(){this.view.gotoAndPlay("open")}}]),e}(),te=null,ie=function(){function e(){if(s()(this,e),te)return te;this.value=1,te=this}return a()(e,[{key:"getLevel",value:function(){return this.value}},{key:"changeValue",value:function(e){this.value+=e}},{key:"addLevel",value:function(){this.value++}},{key:"subLevel",value:function(){this.value--}}]),e}(),ne=function(){function e(){s()(this,e),this.levelObj=new ie,this.data=z[this.levelObj.value%z.length],this.buildView(),this.buildHome(),this.buildEnemyGate()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeftTop=new createjs.Container,this.viewRightTop=new createjs.Container;for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].length;t++){var i=this.data[e][t];if(0!==i){var n=new X(y[i],d*t+.5*d,c*e+20);"tree"===y[i]?(this.viewLeftTop.addChild(n.viewLeft),this.viewRightTop.addChild(n.viewRight)):(this.viewLeft.addChild(n.viewLeft),this.viewRight.addChild(n.viewRight))}}}},{key:"buildHome",value:function(){this.home=new $,this.viewLeft.addChild(this.home.viewLeft),this.viewRight.addChild(this.home.viewRight)}},{key:"buildEnemyGate",value:function(){var e=this;this.enemyGates=[],f.forEach(function(t){var i=new ee;e.viewLeft.addChild(i.viewLeft),e.viewRight.addChild(i.viewRight),i.viewLeft.set({x:t.x}),i.viewRight.set({x:t.x}),e.enemyGates.push(i)})}},{key:"openGate",value:function(e){this.enemyGates[e].open()}},{key:"clear",value:function(){this.enemyGates=[]}}]),e}(),se=i("fZjL"),he=i.n(se),ae=i("woOf"),oe=i.n(ae),re=i("T/kv"),le=function(){function e(){s()(this,e),this.activeValue=!1,this.buildView()}return a()(e,[{key:"update",value:function(e){this.view.rotation+=.1*e,this.viewLeft.rotation+=.1*e,this.viewRight.rotation+=.1*e}},{key:"buildView",value:function(){var e=window.gameResource.getResult("armor");this.view=this.buildViewBitmap(e),this.viewLeft=this.buildViewBitmap(e),this.viewRight=this.buildViewBitmap(e)}},{key:"buildViewBitmap",value:function(e){var t=new createjs.Bitmap(e);return t.set({regX:e.width/2,regY:e.height/2,visible:!1}),t}},{key:"active",value:function(){this.activeValue=!0,this.view.visible=!0,this.viewLeft.visible=!0,this.viewRight.visible=!0}},{key:"deactive",value:function(){this.activeValue=!1,this.view.visible=!1,this.viewLeft.visible=!1,this.viewRight.visible=!1}},{key:"isActive",value:function(){return this.activeValue}}]),e}(),ue={sight:{viewMode:"BOTH",baseAcuity:1,OD:{relativeAcuity:1,frequency:0,sensitivity:.5,blur:"",brightness:"",background:""},OS:{relativeAcuity:.9,frequency:0,sensitivity:.5,blur:"",brightness:"",background:""}},vergence:{horizontal:{horizonAxis:"",rangeMin:-20,rangeMax:10,moveMode:"jump",speed:1,step:20},rotation:{zAxis:1,rangeMin:-10,rangeMax:20,moveMode:"smooth",speed:10,step:1}},distance:1},de=function(e){function t(e){s()(this,t);var i=k()(this,(t.__proto__||p()(t)).call(this));return i.type=e,i.view=new createjs.Container,i.view.set({x:0,y:0}),i.addChild(i.view),i.initData(),i.buildView(),i.buildTank(),i}return T()(t,e),a()(t,[{key:"initData",value:function(){this.initEnemyImageData(),this.initGameSettingData(),this.initHorJumpData(),this.initFreData(),this.initTotaJumpData()}},{key:"initEnemyImageData",value:function(){this.enemyImage=window.gameResource.getResult("enemy"),this.width=this.enemyImage.width,this.height=this.enemyImage.height,this.halfWidth=.5*this.enemyImage.width,this.halfHeight=.5*this.enemyImage.height}},{key:"initGameSettingData",value:function(){this.sight=ue.sight[this.type],this.horizontal=ue.vergence.horizontal,this.rotation=ue.vergence.rotation,this.baseAcuity=ue.sight.baseAcuity,this.scale=this.getScale()}},{key:"initHorJumpData",value:function(){this.horLastFrame=0,this.horiJumpMinDis=.5*this.horizontal.rangeMin,this.horiJumpMaxDis=.5*this.horizontal.rangeMax,this.horJumpTime=this.getInteget(this.horizontal.step/this.horizontal.speed*1e3),this.getHoriSpeed()}},{key:"getHoriSpeed",value:function(){"smooth"===this.horizontal.moveMode?this.horiSpeed=this.horizontal.speed:this.horiSpeed=this.horizontal.step}},{key:"getRotaSpeed",value:function(){"smooth"===this.rotation.moveMode?this.rotaSpeed=this.rotation.speed:this.rotaSpeed=this.rotation.step}},{key:"initTotaJumpData",value:function(){this.rotaLastFrame=0,this.rotaJumpMinDis=.5*this.rotation.rangeMin,this.rotaJumpMaxDis=.5*this.rotation.rangeMax,this.rotaJumpTime=this.getInteget(this.rotation.step/this.rotation.speed*1e3),this.getRotaSpeed()}},{key:"initFreData",value:function(){this.freLastFrame=0}},{key:"getScale",value:function(){var e=this.sight.relativeAcuity;return this.baseAcuity*e}},{key:"buildView",value:function(){this.set({x:.5*window.gameWidth,y:window.gameHeight-this.halfHeight-100})}},{key:"frequency",value:function(e){if(0!==this.sight.frequency){var t=500/this.sight.frequency;this.freLastFrame+=e,this.freLastFrame>=t&&(this.freLastFrame=0,!1===this.visible?this.visible=!0:this.visible=!1)}}},{key:"update",value:function(e){this.frequency(e),this.rotaJumpMove()}},{key:"horiSmoothMove",value:function(){"OS"===this.type?((this.view.x-this.horiSpeed<=this.horiJumpMinDis||this.view.x-this.horiSpeed>=this.horiJumpMaxDis)&&(this.horiSpeed*=-1),this.view.x-=this.horiSpeed):((this.view.x+this.horiSpeed<=this.horiJumpMinDis||this.view.x+this.horiSpeed>=this.horiJumpMaxDis)&&(this.horiSpeed*=-1),this.view.x+=this.horiSpeed)}},{key:"move",value:function(e,t,i,n){"OS"===this.type?((e-t<=i||e-t>=n)&&(t*=-1),e-=t):((e+t<=i||e+t>=n)&&(t*=-1),e+=t)}},{key:"horiJumpMove",value:function(e){this.horLastFrame+=e,this.horLastFrame>=this.horJumpTime&&(this.horLastFrame=0,this.horiSmoothMove())}},{key:"rotaSmoonMove",value:function(){"OS"===this.type?((this.view.rotation-this.rotaSpeed<=this.rotaJumpMinDis||this.view.rotation-this.rotaSpeed>=this.rotaJumpMaxDis)&&(this.rotaSpeed*=-1),this.view.rotation-=this.rotaSpeed):((this.view.rotation+this.rotaSpeed<=this.rotaJumpMinDis||this.view.rotation+this.rotaSpeed>=this.rotaJumpMaxDis)&&(this.rotaSpeed*=-1),this.view.rotation+=this.rotaSpeed)}},{key:"rotaJumpMove",value:function(e){this.rotaLastFrame+=e,this.rotaLastFrame>=this.rotaJumpTime&&(this.rotaLastFrame=0,this.rotaSmoonMove())}},{key:"getInteget",value:function(e){return Math.ceil(e)}},{key:"buildTank",value:function(){this.tank=this.buildTankBitmap(),this.view.addChild(this.tank)}},{key:"buildTankBitmap",value:function(){var e=new createjs.Bitmap(this.enemyImage);return e.set({x:0,y:0,regX:this.halfWidth,regY:this.halfHeight,scaleX:this.scale,scaleY:this.scale}),e}}]),t}(createjs.Container),ce=function(){function e(t){s()(this,e),this.assignedTarget=t,this.initGameSetting(),this.buildData(),this.buildDirectionMap(),this.buildView(),this.buildTank(),this.buildBody(),this.buildArmor()}return a()(e,[{key:"initGameSetting",value:function(){this.gameSetting=ue,this.viewAcuity=ue.sight.viewMode}},{key:"buildData",value:function(){this.tag="Enemy",this.enemyImage=window.gameResource.getResult("enemy"),this.width=this.enemyImage.width,this.height=this.enemyImage.height,this.halfWidth=.5*this.enemyImage.width,this.halfHeight=.5*this.enemyImage.height,this.zeroVelocity=new I(0,0),this.maxVelocity=5,this.direction="DOWN",this.currentTime=0,this.lastTurnTime=0,this.lastShootTime=0,this.turnDeltaTime=re.a.randomRange(1e3,4e3)}},{key:"buildBody",value:function(){var e=new M;e.type=_.b2_dynamicBody;var t=f.map(function(e){return e.x*(1/30)});this.gateNum=re.a.randomRange(0,t.length),e.position.x=t[this.gateNum],e.position.y=this.halfHeight*(1/30),e.allowSleep=!1,e.linearVelocity=this.directionToVelocity[this.direction],e.angle=B[this.direction];var i=new F;i.shape=new O;i.shape.SetAsBox((this.halfWidth-6)*(1/30),(this.halfHeight-6)*(1/30)),this.body=Y.CreateBody(e),this.body.self=this.assignedTarget,this.fixture=this.body.CreateFixture(i)}},{key:"buildDirectionMap",value:function(){this.directionToVelocity={LEFT:new I(-this.maxVelocity,0),RIGHT:new I(this.maxVelocity,0),UP:new I(0,-this.maxVelocity),DOWN:new I(0,this.maxVelocity)}}},{key:"buildView",value:function(){switch(this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.view=this.buildViewContain(),this.rightView=new de("OD"),this.leftView=new de("OS"),this.viewAcuity){case"BOTH":this.viewLeft.addChild(this.leftView),this.viewRight.addChild(this.rightView);break;case"OS":this.viewLeft.addChild(this.leftView);break;case"OD":this.viewRight.addChild(this.rightView)}}},{key:"buildViewContain",value:function(){var e=new createjs.Container;return e.set({x:.5*v,y:w-this.halfHeight-100}),e}},{key:"buildLeftView",value:function(){this.leftView=new createjs.Container,this.gameSetting.sight.OS,this.leftView.set({x:.5*v,y:w-this.halfHeight-100}),createjs.Tween.get(this.leftView,{loop:!0}).to({visible:!1},100).to({visible:!0},50)}},{key:"buildTank",value:function(){this.tank=this.buildTankBitmap(),this.view.addChild(this.tank),this.view.tank=this.tank,this.tankRight=this.rightView.tank}},{key:"buildTankBitmap",value:function(){var e=new createjs.Bitmap(this.enemyImage);return e.set({regX:this.halfWidth,regY:this.halfHeight}),e}},{key:"buildArmor",value:function(){this.armor=new le,this.leftView.addChild(this.armor.viewLeft),this.rightView.addChild(this.armor.viewRight)}},{key:"clear",value:function(){this.zeroVelocity=new I(0,0),this.maxVelocity=5,this.direction="DOWN",this.currentTime=0,this.lastTurnTime=0,this.lastShootTime=0,this.turnDeltaTime=re.a.randomRange(1e3,4e3),this.buildDirectionMap()}}]),e}(),ve=function e(t,i,n){var h=this;s()(this,e);var a={images:[window.gameResource.getResult("explosion-bullet")],frames:{width:34,height:34},animations:{explode:[0,8,null,.5]}},o=new createjs.SpriteSheet(a);this.view=new createjs.Sprite(o),this.view.set({x:t,y:i,regX:17,regY:17}),this.view.gotoAndPlay("explode"),this.view.addEventListener("animationend",function(){h.view.parent.removeChild(h.view),n&&n()})},we=function(){function e(t,i,n,h){s()(this,e),this.sx=t,this.sy=i,this.tag="Bullet",this.initX=t,this.initY=i,this.angle=n,this.shooter=h,this.radius=5,this.maxV=10,this.buildView(),this.buildBody(),D.push(this),this.update()}return a()(e,[{key:"update",value:function(){this.updateObj(this.viewLeft),this.updateObj(this.viewRight),(Math.abs(this.viewLeft.x-this.sx)>400||Math.abs(this.viewLeft.y-this.sy)>400)&&(V.push(this),this.viewLeft.parent.removeChild(this.viewLeft),this.viewRight.parent.removeChild(this.viewRight))}},{key:"updateObj",value:function(e){e&&(e.x=30*this.body.GetPosition().x,e.y=30*this.body.GetPosition().y,e.rotation=57.3*this.body.GetAngle())}},{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container;var e=window.gameResource.getResult("bullet");this.view=this.buildBitmap(e),this.rightView=this.buildBitmap(e),this.viewLeft.addChild(this.view),this.viewRight.addChild(this.rightView)}},{key:"buildBitmap",value:function(e){var t=new createjs.Bitmap(e);return t.set({regX:e.width/2,regY:e.height/2}),t}},{key:"buildBody",value:function(){var e=new M;e.type=_.b2_dynamicBody,e.position.x=this.initX*(1/30),e.position.y=this.initY*(1/30),e.angle=this.angle;var t=new I(Math.sin(this.angle),-Math.cos(this.angle));t.Multiply(this.maxV),e.linearVelocity=t;var i=new F;i.isSensor=!0,i.shape=new N,i.shape.SetRadius(this.radius*(1/30)),this.body=Y.CreateBody(e),this.body.self=this,this.fixture=this.body.CreateFixture(i)}},{key:"handleCollision",value:function(e){if(this.shooter.tag!==e.tag&&"wall"!==e.tag&&("Tile"!==e.tag||!["tree","water"].includes(e.imageId))){if(this.viewLeft.parent){var t=new ve(this.viewLeft.x,this.viewLeft.y);this.viewLeft.parent.addChild(t.view.clone())}if(this.viewRight.parent){var i=new ve(this.viewRight.x,this.viewRight.y);this.viewRight.parent.addChild(i.view.clone())}V.push(this)}}},{key:"clear",value:function(){D.length=0,V.length=0}}]),e}(),fe=function e(t,i,n){var h=this;s()(this,e);var a={images:[window.gameResource.getResult("explosion-tank")],frames:{width:74,height:74},animations:{explode:[0,8,null,.2]}},o=new createjs.SpriteSheet(a);this.view=new createjs.Sprite(o),this.view.set({x:t,y:i,regX:37,regY:37}),this.view.gotoAndPlay("explode"),this.view.addEventListener("animationend",function(){h.view.parent.removeChild(h.view),n&&n()})},ye=function(){function e(t){s()(this,e),this.initDataObj=new ce(this),oe()(this,this.initDataObj),this.world=t,this.created()}return a()(e,[{key:"created",value:function(){var e=this;this.world.map.openGate(this.gateNum),D.push(this),this.armor.active(),setTimeout(function(){e.armor.deactive()},3e3)}},{key:"updateView",value:function(e){e.x=30*this.body.GetPosition().x,e.y=30*this.body.GetPosition().y,e.tank.rotation=57.3*this.body.GetAngle()}},{key:"update",value:function(e){this.updateView(this.view),this.updateView(this.rightView),this.updateView(this.leftView),this.rightView.update(e),this.leftView.update(e),this.currentTime+=e,this.armor.update(e),this.currentTime-this.lastTurnTime>this.turnDeltaTime&&this.turn(),this.currentTime-this.lastShootTime>1500&&this.shoot(),this.body.SetLinearVelocity(this.directionToVelocity[this.direction])}},{key:"shoot",value:function(){this.lastShootTime=this.currentTime,this.bullet=new we(this.view.x,this.view.y,this.body.GetAngle(),this);var e=this.viewLeft.parent.children.indexOf(this.viewLeft);switch(this.viewAcuity){case"BOTH":this.viewLeft.parent.addChildAt(this.bullet.viewLeft,e),this.viewRight.parent.addChildAt(this.bullet.viewRight,e);break;case"OS":this.viewLeft.parent.addChildAt(this.bullet.viewLeft,e);break;case"OD":this.viewRight.parent.addChildAt(this.bullet.viewRight,e)}}},{key:"handleCollision",value:function(e){var t=this;if(!this.destroyed){if("Bullet"===e.tag&&e.shooter.tag!==this.tag){if(this.armor.isActive())return;var i=new fe(this.view.x,this.view.y);createjs.Sound.play("mExplosion",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0),this.viewRight.parent.addChild(i.view),this.viewLeft.parent.addChild(i.view.clone()),V.push(this),this.destroyed=!0}"Bullet"!==e.tag&&setTimeout(function(){t.turn()},200)}}},{key:"turn",value:function(){this.lastTurnTime=this.currentTime,this.turnDeltaTime=re.a.randomRange(1e3,5e3),re.a.choiceExcept=function(e,t){var i=re.a.randomChoice(e);return i===t?re.a.choiceExcept(e,t):i};var e=he()(this.directionToVelocity);this.direction=this.checkLastRow()?this.checkLastRow():re.a.choiceExcept(e,this.direction),this.checkValid()?(this.body.SetLinearVelocity(this.directionToVelocity[this.direction]),this.body.SetAngle(B[this.direction])):this.turn()}},{key:"checkLastRow",value:function(){return this.view.y>=w-this.halfHeight&&(this.view.x<v/2?"RIGHT":"LEFT")}},{key:"checkValid",value:function(){return!(this.view.y<=this.width&&"UP"===this.direction)&&(!(this.view.x<=this.width&&"LEFT"===this.direction)&&(!(this.view.x>=v-this.width&&"RIGHT"===this.direction)&&!(this.view.y>=w-this.height&&"DOWN"===this.direction)))}},{key:"clear",value:function(){this.initDataObj.clear(),D.length=0,this.bullet.clear()}}]),e}(),ge=function(){function e(t){s()(this,e),this.assignedTarget=t,this.blood=3,this.maxVelocity=5,this.heroImage=window.gameResource.getResult("hero"),this.halfWidth=.5*this.heroImage.width,this.halfHeight=.5*this.heroImage.height,this.zeroVelocity=new I(0,0),this.buildDirectionMap(),this.buildView(),this.buildArmor(),this.buildTank(),this.buildBody()}return a()(e,[{key:"initStatus",value:function(){this.status={status:"",moveType:""}}},{key:"buildBody",value:function(){var e=new M;e.type=_.b2_dynamicBody,e.position.x=1/30*(.5*v-150),e.position.y=1/30*(w-50),e.allowSleep=!1;var t=new F;t.shape=new O;t.shape.SetAsBox((this.halfWidth-6)*(1/30),(this.halfHeight-6)*(1/30)),this.body=Y.CreateBody(e),this.body.self=this.assignedTarget,this.fixture=this.body.CreateFixture(t)}},{key:"buildDirectionMap",value:function(){this.directionToVelocity={LEFT:new I(-this.maxVelocity,0),RIGHT:new I(this.maxVelocity,0),UP:new I(0,-this.maxVelocity),DOWN:new I(0,this.maxVelocity)}}},{key:"buildView",value:function(){this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.leftView=this.buildViewBody(),this.rightView=this.buildViewBody(),this.viewLeft.addChild(this.leftView),this.viewRight.addChild(this.rightView)}},{key:"buildViewBody",value:function(){var e=new createjs.Container;return e.set({x:.5*v,y:w-this.halfHeight-100}),e}},{key:"buildTankImage",value:function(){var e=new createjs.Bitmap(this.heroImage);return e.set({regX:this.halfWidth,regY:this.halfHeight}),e}},{key:"buildTank",value:function(){this.addRightTank(),this.addLeftTank()}},{key:"addLeftTank",value:function(){this.leftTank=this.buildTankImage(),this.leftView.addChild(this.leftTank),this.leftView.addChild(this.armor.viewLeft)}},{key:"addRightTank",value:function(){this.rightTank=this.buildTankImage(),this.rightView.addChild(this.rightTank),this.rightView.addChild(this.armor.viewRight)}},{key:"buildArmor",value:function(){this.armor=new le}},{key:"clear",value:function(){this.blood=3,this.zeroVelocity=new I(0,0),this.maxVelocity=5,this.directionToVelocity={LEFT:new I(-this.maxVelocity,0),RIGHT:new I(this.maxVelocity,0),UP:new I(0,-this.maxVelocity),DOWN:new I(0,this.maxVelocity)}}}]),e}(),me=function(){function e(t){s()(this,e),this.index=t,this.pressedMap={},this.oldPressedMap={},this.deadZone=.1,this.setMap()}return a()(e,[{key:"update",value:function(){var e=this;this.oldPressedMap=this.pressedMap,this.pressedMap={};var t=navigator.getGamepads()[this.index];t&&(t.buttons.forEach(function(t,i){var n=e.defaultMap.buttons[i];e.pressedMap[n]=t.pressed}),t.axes.forEach(function(t,i){var n=e.defaultMap.axes[i];Math.abs(t)<e.deadZone&&(t=0),e.pressedMap[n]=t}))}},{key:"justPressed",value:function(e){return this.pressedMap[e]&&!this.oldPressedMap[e]}},{key:"pressed",value:function(e){return this.pressedMap[e]}},{key:"justRelesed",value:function(e){return!this.pressedMap[e]&&this.oldPressedMap[e]}},{key:"setMap",value:function(){this.defaultMap={buttons:{0:"A",1:"B",2:"X",3:"Y",4:"LB",5:"RB",6:"LT",7:"RT",8:"BACK",9:"START",10:"LSTICK",11:"RSTICK",12:"UP",13:"DOWN",14:"LEFT",15:"RIGHT",16:"SWITCH"},axes:{0:"ALX",1:"ALY",2:"ARX",3:"ARY"}}}}]),e}(),pe=function(){function e(){s()(this,e),this.controllers=[];for(var t=0;t<4;t++){var i=new me(t);this.controllers.push(i)}}return a()(e,[{key:"currentNum",value:function(){for(var e=navigator.getGamepads(),t=0,i=0;i<4;i++)e[i]&&(t+=1);return t}},{key:"checkValid",value:function(e){return navigator.getGamepads()[e]}},{key:"update",value:function(){this.controllers.forEach(function(e){e.update()})}},{key:"justPressed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.controllers[t].justPressed(e)}},{key:"pressed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.controllers[t].pressed(e)}},{key:"justRelesed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.controllers[t].justPressed(e)}}]),e}(),be=function(){function e(t){s()(this,e),this.parent=t,this.joysticks=new pe,this.joysticksNum=this.joysticks.currentNum(),this.direction="",this.isFire=!1,this.isRun=!0}return a()(e,[{key:"update",value:function(){this.joysticksNum&&(this.joysticks.update(),this.addEvent())}},{key:"addEvent",value:function(){switch(!0){case this.joysticks.justRelesed("A",0):this.isFire=!0;break;case this.joysticks.pressed("RIGHT",0):this.direction="RIGHT";break;case this.joysticks.pressed("LEFT",0):this.direction="LEFT";break;case this.joysticks.pressed("UP",0):this.direction="UP";break;case this.joysticks.pressed("DOWN",0):this.direction="DOWN"}}},{key:"directionStyle",value:function(e){["RIGHT","LEFT","UP","DOWN"].includes(e)&&(this.joysticks.pressed(e,0)?this.direction=e:this.direction="")}},{key:"fireStyle",value:function(){this.joysticks.justRelesed("A",0)&&console.log("object-----a"),this.joysticks.pressed("A",0)?this.isFire=!0:this.isFire=!1}}]),e}(),ke={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTR:17,ALT:18,CAPELOCK:20,ESC:27,SPACE:32,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},Ce=function(){function e(){var t=this;s()(this,e),this.listenKeyDown=function(){switch((arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event).keyCode){case ke.SPACE:t.isFire=!0;break;case ke.UP:t.direction="UP";break;case ke.DOWN:t.direction="DOWN";break;case ke.LEFT:t.direction="LEFT";break;case ke.RIGHT:t.direction="RIGHT"}},this.listenKeyDirectionUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;e.preventDefault(),[ke.UP,ke.DOWN,ke.LEFT,ke.RIGHT].includes(e.keyCode)&&(t.direction="")},this.listenKeySpaceUp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;e.preventDefault(),!e.keyCode!==ke.SPACE&&(t.isFire=!1)},this.isFire=!1,this.direction="",this.addEventListener()}return a()(e,[{key:"addEventListener",value:function(){document.addEventListener("keydown",this.listenKeyDown,!1),document.addEventListener("keyup",this.listenKeyDirectionUp,!1),document.addEventListener("keyup",this.listenKeySpaceUp,!1)}},{key:"removeEvtLister",value:function(){document.removeEventListener("keydown",this.listenKeyDown,!1),document.removeEventListener("keyup",this.listenKeySpaceUp,!1)}}]),e}(),Te=function(){function e(t){s()(this,e),this.parent=t,this.handleEvent=new be,this.keyEvent=new Ce,this.isFire=!1,this.direction=""}return a()(e,[{key:"update",value:function(){this.handleEvent.joysticksNum&&this.handleEvent.update(),this.isFire=this.keyEvent.isFire||this.handleEvent.isFire,this.direction=this.keyEvent.direction||this.handleEvent.direction}},{key:"removeEvent",value:function(){this.keyEvent.removeEvtLister(),this.handleEvent.joysticksNum&&(this.handleEvent.isRun=!1)}},{key:"isHandle",value:function(){return this.handleEvent.joysticksNum}},{key:"restartFire",value:function(){this.handleEvent.joysticksNum&&(this.handleEvent.isFire=!1),this.keyEvent.isFire=!1,this.isFire=!1}},{key:"restartDirection",value:function(){this.handleEvent.joysticksNum&&(this.handleEvent.direction="")}}]),e}(),xe=function(e){function t(){s()(this,t);var e=k()(this,(t.__proto__||p()(t)).call(this));return e.imageId=null,e}return T()(t,e),a()(t,[{key:"build",value:function(){this.tag=this.imageId,this.id=this.imageId,this.image=window.gameResource.getResult(this.imageId),this.width=this.image.width,this.height=this.image.height,this.regx=.5*this.width,this.regy=.5*this.height}},{key:"getTag",value:function(){return this.tag}}]),t}(createjs.Bitmap),Le=function(e){function t(e){s()(this,t);var i=k()(this,(t.__proto__||p()(t)).call(this));return i.imageId=e,i.build(),i}return T()(t,e),t}(xe),Ee=null,Re=function(e){function t(){var e;s()(this,t);var i=k()(this,(t.__proto__||p()(t)).call(this));return Ee?(e=Ee,k()(i,e)):(i.imageId="life",i.textNum=3,i.buildView(),Ee=i,i)}return T()(t,e),a()(t,[{key:"clear",value:function(){this.textNum=3}}]),t}(function(){function e(){s()(this,e),this.imageId=null,this.value=0}return a()(e,[{key:"buildView",value:function(){this.view=new createjs.Container,this.buildButton(),this.buildText()}},{key:"buildButton",value:function(){this.buttonImage=new Le(this.imageId),this.view.addChild(this.buttonImage)}},{key:"buildText",value:function(){this.textShow=new createjs.Text(this.textNum,"30px Arial","#ff7700"),this.textShow.set({x:144,y:this.buttonImage.regy,textAlign:"center",textBaseline:"middle"}),this.view.addChild(this.textShow)}},{key:"getValue",value:function(){return this.textShow.text}},{key:"changeValue",value:function(e){this.textShow.text+=e}},{key:"increaseValue",value:function(){this.textShow.text++}},{key:"reduceValue",value:function(){this.textShow.text--}}]),e}()),Se=function(){function e(t){s()(this,e),this.env=t,this.tag="Hero",this.event=new Te(this),this.initDataObj=new ge(this),oe()(this,this.initDataObj),this.heroLife=new Re,D.push(this),this.leftBullet=!1}return a()(e,[{key:"update",value:function(e){this.updateView(this.leftView),this.updateView(this.rightView),this.updateControled(),this.armor.isActive()&&this.armor.update(e)}},{key:"updateView",value:function(e){e&&(e.x=30*this.body.GetPosition().x,e.y=30*this.body.GetPosition().y,e.rotation=57.3*this.body.GetAngle())}},{key:"shootLeft",value:function(){if(this.leftTank){this.bullet=new we(this.leftView.x,this.leftView.y,this.body.GetAngle(),this);var e=this.viewLeft.parent.children.indexOf(this.viewLeft);this.viewLeft.parent.addChildAt(this.bullet.viewLeft,e),this.leftBullet=!0}}},{key:"shootRight",value:function(){if(this.rightTank){this.leftBullet||(this.bullet=new we(this.rightView.x,this.rightView.y,this.body.GetAngle(),this));var e=this.viewRight.parent.children.indexOf(this.viewRight);this.viewRight.parent.addChildAt(this.bullet.viewRight,e)}}},{key:"updateControled",value:function(){var e=!1;if(this.event.update(),this.event.isFire)return this.event.restartFire(),this.leftTank&&!0===this.leftTank.visible&&this.shootLeft(),void(this.rightTank&&!0===this.rightTank.visible&&this.shootRight());if(this.event.direction){this.direction=this.event.direction;var t=this.direction;this.body.SetLinearDamping(0),this.body.SetLinearVelocity(this.directionToVelocity[t]),this.body.SetAngle(B[t]),this.event.restartDirection(),e=!0}e||this.body.SetLinearVelocity(this.zeroVelocity)}},{key:"handleCollision",value:function(e){if(!this.armor.isActive()&&"Bullet"===e.tag&&e.shooter.tag!==this.tag){if(this.leftTank){var t=new fe(this.leftView.x,this.leftView.y);this.viewLeft.parent.addChild(t.view)}if(this.rightTank){var i=new fe(this.rightView.x,this.rightView.y);this.viewRight.parent.addChild(i.view)}if(createjs.Sound.play("mExplosion",createjs.Sound.INTERRUPT_NONE,0,0,0,1,0),this.heroLife.changeValue(-1),0===this.heroLife.getValue())return void window.game.fail();this.reborn()}}},{key:"reborn",value:function(){var e=this;this.rightTank&&(this.rightTank.visible=!1),this.leftTank&&(this.leftTank.visible=!1),this.armor.active(),setTimeout(function(){var t=1/30*(.5*v-150),i=1/30*(w-50);e.body.SetPosition(new I(t,i)),e.body.SetAngle(0)},0),setTimeout(function(){e.rightTank&&(e.rightTank.visible=!0),e.leftTank&&(e.leftTank.visible=!0)},1e3),setTimeout(function(){e.armor.deactive()},3e3)}},{key:"clear",value:function(){this.heroLife.clear(),this.initDataObj.clear(),this.bullet.clear()}}]),e}(),Ve=function(){function e(t){s()(this,e),this.angle=t,this.tag="wall",this.buildBody()}return a()(e,[{key:"buildBody",value:function(){var e=this,t=new M;t.position.x=.5*v*(1/30),t.position.y=.5*w*(1/30),t.type=_.b2_staticBody,this.body=Y.CreateBody(t),this.body.self=this;[{localPosition:new I((10+v)*(1/30)*.5,0),angle:0},{localPosition:new I(1/30*-(10+v)*.5,0),angle:0},{localPosition:new I(0,1/30*-(w+10)*.5),angle:.5*Math.PI},{localPosition:new I(0,(w+10)*(1/30)*.5),angle:.5*Math.PI}].forEach(function(t){var i=new O,n=t.localPosition;n.Add(new I(1/30*10,1/30*10));var s=t.angle;i.SetAsOrientedBox(1/30*10*.5,.5*v*(1/30),n,s),e.fixture=e.body.CreateFixture2(i)})}},{key:"handleCollision",value:function(e){"Bullet"===e.tag&&(this.tag="wall")}}]),e}(),De=function(){function e(t){s()(this,e),this.game=t,createjs.Tween.removeAllTweens(),this.view=new createjs.Container,this.maxEnemies=20,this.enemyBuild=0,this.enemyArry=[],this.destroyedEnemy=0,this.buildView(),this.buildWall(),this.buildBG(),this.buildMap(),this.buildHero(),this.buildEnemy(3),this.addMapTop()}return a()(e,[{key:"buildView",value:function(){this.viewLeft=(new createjs.Container).set({scaleX:.5}),this.viewRight=(new createjs.Container).set({scaleX:.5}),this.viewRight.set({x:.5*v}),this.view.addChild(this.viewLeft,this.viewRight)}},{key:"buildBG",value:function(){var e=new createjs.Shape;e.graphics.f("#cccccc").dr(0,0,1280,720),this.viewLeft.addChild(e),this.viewRight.addChild(e.clone())}},{key:"update",value:function(e){var t=this;!function(e){W.update(e)}(e),D.forEach(function(t){t.update(e)}),V.forEach(function(e){Y.DestroyBody(e.body),e.viewLeft.parent&&e.viewLeft.parent.removeChild(e.viewLeft),e.viewRight.parent&&e.viewRight.parent.removeChild(e.viewRight);var i=D.indexOf(e);-1!==i&&D.splice(i,1),"Enemy"===e.tag&&t.handleEnemyDestroyed()}),V.length=0}},{key:"handleEnemyDestroyed",value:function(){this.destroyedEnemy++,this.destroyedEnemy!==this.maxEnemies||this.map.home.heart.destroyed?this.enemyBuild<this.maxEnemies&&this.buildEnemy():this.game.succeed()}},{key:"buildMap",value:function(){this.map=new ne,this.viewLeft.addChild(this.map.viewLeft),this.viewRight.addChild(this.map.viewRight)}},{key:"buildHero",value:function(){this.hero=new Se,this.viewLeft.addChildAt(this.hero.viewLeft,1),this.viewRight.addChildAt(this.hero.viewRight,1)}},{key:"buildEnemy",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.enemyBuild++,t--,setTimeout(function(){var t=new ye(e);e.enemyArry.push(t),e.viewLeft.addChildAt(t.viewLeft,1),e.viewRight.addChildAt(t.viewRight,1)},0),t>0&&setTimeout(function(){e.buildEnemy(t)},1e3)}},{key:"addMapTop",value:function(){this.viewLeft.addChild(this.map.viewLeftTop),this.viewRight.addChild(this.map.viewRightTop)}},{key:"buildWall",value:function(){this.wall=new Ve}},{key:"clear",value:function(){this.hero.clear(),this.enemyArry.map(function(e){return e.clear()}),this.enemyArry=[]}}]),e}(),Be=j.a.Common.Math.b2Vec2,Ae=(j.a.Dynamics.b2BodyDef,j.a.Dynamics.b2Body,j.a.Dynamics.b2FixtureDef,j.a.Dynamics.b2World),je=(j.a.Collision.Shapes.b2PolygonShape,j.a.Collision.Shapes.b2CircleShape,j.a.Dynamics.b2DebugDraw),Ie=j.a.Dynamics.b2ContactListener,Me=new(function(){function e(){s()(this,e),this.init()}return a()(e,[{key:"init",value:function(){this.b2world=new Ae(new Be(0,0),!0),this.events()}},{key:"update",value:function(e){this.b2world.Step(.001*e,8,8),this.b2world.DrawDebugData(),this.b2world.ClearForces()}},{key:"bulidDebugDraw",value:function(){var e=new je;initCanvas("box2d-debug");e.SetSprite(document.getElementById("box2d-debug").getContext("2d")),e.SetDrawScale(30),e.SetFillAlpha(.3),e.SetLineThickness(1),e.SetFlags(je.e_shapeBit|je.e_jointBit),this.b2world.SetDebugDraw(e)}},{key:"events",value:function(){this.listener=new Ie,this.b2world.SetContactListener(this.listener),this.listener.BeginContact=function(e){var t=e.GetFixtureA().GetBody().self,i=e.GetFixtureB().GetBody().self;t.handleCollision&&t.handleCollision(i),i.handleCollision&&i.handleCollision(t)}}},{key:"destroyAll",value:function(){for(var e=this.b2world.GetBodyList();e;)this.b2world.DestroyBody(e),e=e.GetNext()}}]),e}()),_e=(Me.b2world,function(){Me.destroyAll()}),Fe=function(e){function t(e){s()(this,t);var i=k()(this,(t.__proto__||p()(t)).call(this));return i.imageId=e,i.build(),i.x=.5*window.innerWidth,i.y=.5*window.innerHeight,i.regX=i.regx,i.regY=i.regy,i}return T()(t,e),t}(xe),Ge=function e(t){s()(this,e);var i=new Fe(t),n=new Fe(t);this.viewLeft=new createjs.Container,this.viewRight=new createjs.Container,this.viewLeft.addChild(i),this.viewRight.addChild(n)},Oe=function(e){function t(e){s()(this,t);var i=k()(this,(t.__proto__||p()(t)).call(this));return i.imageId=e,i.build(),i}return T()(t,e),t}(xe),Ne=function(){function e(t){s()(this,e),this.callback=t,this.buildView()}return a()(e,[{key:"buildView",value:function(){this.view=new createjs.Container,this.buildBg(),this.buildButton(),this.buttonEvent()}},{key:"buildBg",value:function(){this.bg=new Oe("page"),this.view.addChild(this.bg),this.bg.set({x:0,y:0})}},{key:"buildButton",value:function(){this.buttonContain=new createjs.Container,this.button=new Oe("begin"),this.buttonHover=new Oe("begin-hover"),this.buttonHover.visible=!1,this.buttonContain.addChild(this.button,this.buttonHover),this.view.addChild(this.buttonContain),this.buttonContain.set({x:890,y:535})}},{key:"buttonEvent",value:function(){var e=this;this.buttonContain.addEventListener("mouseover",function(){e.button.visible=!1,e.buttonHover.visible=!0,e.buttonContain.cursor="pointer"}),this.buttonContain.addEventListener("mouseout",function(){e.buttonContain.cursor="default",e.button.visible=!0,e.buttonHover.visible=!1}),this.buttonContain.addEventListener("mousedown",function(){e.buttonContain.cursor="pointer",e.callback()})}}]),e}(),Pe=function(){function e(){var t=this;s()(this,e);var i=function(e){var t=document.createElement("canvas"),i=document.getElementById("stage"),n=document.getElementsByTagName("main")[0];document.documentElement.style.overflow="hidden";var s=parseFloat(n.style.cssText.match(/\d+(\.\d+)?/g)),h=window.innerWidth/1280,a=window.innerHeight/720;h>=a?(h/=s,a=1):(h=1,a/=s);var o=i.style.cssText,r="transform:scale("+h+","+a+")";return i.style.cssText=o+r,t.id="game-canvas",t.id=e,t.width=1280,t.height=720,i.appendChild(t),t}("game-canvas");this.stage=new createjs.Stage("game-canvas"),this.stage.width=i.width,this.stage.height=i.height,this.stage.enableMouseOver(),createjs.Touch.enable(this.stage),this.lastFrame=0,window.gameResource?this.onLoadingComplete():g(function(e){window.gameResource=e,t.onLoadingComplete()})}return a()(e,[{key:"onLoadingComplete",value:function(){var e=this,t=new Ne(function(){e.stage.removeAllChildren(),e.stage.removeAllEventListeners(),e.buildWorld(),e.buildLevel(),e.buildLife(),createjs.Sound.play("mBG",createjs.Sound.INTERRUPT_NONE,0,0,-1,.3,0)});this.stage.addChild(t.view),this.render()}},{key:"buildWorld",value:function(){this.worldView&&this.stage.removeChild(this.worldView.view),_e(),this.worldView=new De(this),this.stage.addChildAt(this.worldView.view,0)}},{key:"buildLevel",value:function(){this.level=new ie}},{key:"buildLife",value:function(){this.heroLife=new Re}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.pauseValue&&!this.failValue){var i=t-this.lastFrame;(i>150||i<0)&&(i=0),this.lastFrame=t,this.worldView&&this.worldView.update(i),this.stage.update(),requestAnimationFrame(function(t){e.render(t)})}}},{key:"fail",value:function(){var e=new Ge("fail");"OS"===ue.sight.viewMode?this.worldView.viewLeft.addChild(e.viewLeft):this.worldView.viewRight.addChild(e.viewRight),_e(),D.length=0,this.failValue=!0,setTimeout(function(){location.reload()},3e3)}},{key:"pause",value:function(){console.log(createjs.Sound,"createjs.Sound.stop()"),createjs.Sound.stop(),this.pauseValue=!0}},{key:"continue",value:function(){this.pauseValue&&(this.pauseValue=!1,this.render()),window.__GAME_STATE.pause||(console.log(window.__GAME_STATE.pause),this.render())}},{key:"succeed",value:function(){var e=this,t=new Ge("success");"OS"===ue.sight.viewMode?this.worldView.viewLeft.addChild(t.viewLeft):this.worldView.viewRight.addChild(t.viewRight),setTimeout(function(){e.level.changeValue(1),e.stage.removeChild(t),e.buildWorld()},1e3)}},{key:"replay",value:function(){this.stage.removeAllChildren(),this.stage.removeAllEventListeners(),this.stage.enableMouseOver(0),createjs.Sound.stop(),this.pause()}},{key:"close",value:function(){this.stage.removeAllChildren(),this.stage.removeAllEventListeners(),this.stage.enableMouseOver(0),createjs.Sound.stop(),console.log(createjs.Sound,"createjs.Sound"),this.pause()}}]),e}();t.default=Pe;window._CONFIG=u,window._GAME=Pe},"x8p/":function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return s});var n="SELECT_DIFFCULTY",s={EASY:"EASY",MEDIUM:"MEDIUM",HARD:"HARD"}},"xPv/":function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"c",function(){return s}),i.d(t,"a",function(){return h});var n="PAUSE_BUTTON",s="REPLAY_BUTTON",h="INTRODUCTION_BUTTON"}},["UR7H"]);