"use strict";var Box2D={};(function(o,n){function _(){}o.inherit=function(S,g){_.prototype=g.prototype,S.prototype=new _,S.prototype.constructor=S},o.generateCallback=function(g,V){return function(){V.apply(g,arguments)}},o.NVector=function(g){g===n&&(g=0);for(var V=Array(g||0),M=0;M<g;++M)V[M]=0;return V},o.is=function(g,V){return null!==g&&(V instanceof Function&&g instanceof V||g.constructor.__implements!=n&&g.constructor.__implements[V])},o.parseUInt=function(S){return Math.abs(parseInt(S))}})(Box2D);var Vector=Array,Vector_a2j_Number=Box2D.NVector;"undefined"==typeof Box2D&&(Box2D={}),"undefined"==typeof Box2D.Collision&&(Box2D.Collision={}),"undefined"==typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={}),"undefined"==typeof Box2D.Common&&(Box2D.Common={}),"undefined"==typeof Box2D.Common.Math&&(Box2D.Common.Math={}),"undefined"==typeof Box2D.Dynamics&&(Box2D.Dynamics={}),"undefined"==typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={}),"undefined"==typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={}),"undefined"==typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={}),function(){function o(){o.b2AABB.apply(this,arguments)}function n(){n.b2Bound.apply(this,arguments)}function _(){_.b2BoundValues.apply(this,arguments),this.constructor===_&&this.b2BoundValues.apply(this,arguments)}function S(){S.b2Collision.apply(this,arguments)}function g(){g.b2ContactID.apply(this,arguments),this.constructor===g&&this.b2ContactID.apply(this,arguments)}function V(){V.b2ContactPoint.apply(this,arguments)}function M(){M.b2Distance.apply(this,arguments)}function w(){w.b2DistanceInput.apply(this,arguments)}function G(){G.b2DistanceOutput.apply(this,arguments)}function L(){L.b2DistanceProxy.apply(this,arguments)}function J(){J.b2DynamicTree.apply(this,arguments),this.constructor===J&&this.b2DynamicTree.apply(this,arguments)}function F(){F.b2DynamicTreeBroadPhase.apply(this,arguments)}function R(){R.b2DynamicTreeNode.apply(this,arguments)}function E(){E.b2DynamicTreePair.apply(this,arguments)}function N(){N.b2Manifold.apply(this,arguments),this.constructor===N&&this.b2Manifold.apply(this,arguments)}function U(){U.b2ManifoldPoint.apply(this,arguments),this.constructor===U&&this.b2ManifoldPoint.apply(this,arguments)}function q(){q.b2Point.apply(this,arguments)}function W(){W.b2RayCastInput.apply(this,arguments),this.constructor===W&&this.b2RayCastInput.apply(this,arguments)}function O(){O.b2RayCastOutput.apply(this,arguments)}function X(){X.b2Segment.apply(this,arguments)}function Z(){Z.b2SeparationFunction.apply(this,arguments)}function H(){H.b2Simplex.apply(this,arguments),this.constructor===H&&this.b2Simplex.apply(this,arguments)}function Y(){Y.b2SimplexCache.apply(this,arguments)}function Q(){Q.b2SimplexVertex.apply(this,arguments)}function $(){$.b2TimeOfImpact.apply(this,arguments)}function ee(){ee.b2TOIInput.apply(this,arguments)}function oe(){oe.b2WorldManifold.apply(this,arguments),this.constructor===oe&&this.b2WorldManifold.apply(this,arguments)}function te(){te.ClipVertex.apply(this,arguments)}function ne(){ne.Features.apply(this,arguments)}function ie(){ie.b2CircleShape.apply(this,arguments),this.constructor===ie&&this.b2CircleShape.apply(this,arguments)}function me(){me.b2EdgeChainDef.apply(this,arguments),this.constructor===me&&this.b2EdgeChainDef.apply(this,arguments)}function ae(){ae.b2EdgeShape.apply(this,arguments),this.constructor===ae&&this.b2EdgeShape.apply(this,arguments)}function le(){le.b2MassData.apply(this,arguments)}function re(){re.b2PolygonShape.apply(this,arguments),this.constructor===re&&this.b2PolygonShape.apply(this,arguments)}function se(){se.b2Shape.apply(this,arguments),this.constructor===se&&this.b2Shape.apply(this,arguments)}function _e(){_e.b2Color.apply(this,arguments),this.constructor===_e&&this.b2Color.apply(this,arguments)}function pe(){pe.b2Settings.apply(this,arguments)}function ye(){ye.b2Mat22.apply(this,arguments),this.constructor===ye&&this.b2Mat22.apply(this,arguments)}function xe(){xe.b2Mat33.apply(this,arguments),this.constructor===xe&&this.b2Mat33.apply(this,arguments)}function ue(){ue.b2Math.apply(this,arguments)}function de(){de.b2Sweep.apply(this,arguments)}function be(){be.b2Transform.apply(this,arguments),this.constructor===be&&this.b2Transform.apply(this,arguments)}function Ce(){Ce.b2Vec2.apply(this,arguments),this.constructor===Ce&&this.b2Vec2.apply(this,arguments)}function fe(){fe.b2Vec3.apply(this,arguments),this.constructor===fe&&this.b2Vec3.apply(this,arguments)}function Ae(){Ae.b2Body.apply(this,arguments),this.constructor===Ae&&this.b2Body.apply(this,arguments)}function Se(){Se.b2BodyDef.apply(this,arguments),this.constructor===Se&&this.b2BodyDef.apply(this,arguments)}function ge(){ge.b2ContactFilter.apply(this,arguments)}function De(){De.b2ContactImpulse.apply(this,arguments)}function ve(){ve.b2ContactListener.apply(this,arguments)}function he(){he.b2ContactManager.apply(this,arguments),this.constructor===he&&this.b2ContactManager.apply(this,arguments)}function Be(){Be.b2DebugDraw.apply(this,arguments),this.constructor===Be&&this.b2DebugDraw.apply(this,arguments)}function Ve(){Ve.b2DestructionListener.apply(this,arguments)}function Me(){Me.b2FilterData.apply(this,arguments)}function we(){we.b2Fixture.apply(this,arguments),this.constructor===we&&this.b2Fixture.apply(this,arguments)}function Ie(){Ie.b2FixtureDef.apply(this,arguments),this.constructor===Ie&&this.b2FixtureDef.apply(this,arguments)}function Ge(){Ge.b2Island.apply(this,arguments),this.constructor===Ge&&this.b2Island.apply(this,arguments)}function Le(){Le.b2TimeStep.apply(this,arguments)}function Je(){Je.b2World.apply(this,arguments),this.constructor===Je&&this.b2World.apply(this,arguments)}function Fe(){Fe.b2CircleContact.apply(this,arguments)}function Pe(){Pe.b2Contact.apply(this,arguments),this.constructor===Pe&&this.b2Contact.apply(this,arguments)}function Re(){Re.b2ContactConstraint.apply(this,arguments),this.constructor===Re&&this.b2ContactConstraint.apply(this,arguments)}function Te(){Te.b2ContactConstraintPoint.apply(this,arguments)}function ze(){ze.b2ContactEdge.apply(this,arguments)}function Ee(){Ee.b2ContactFactory.apply(this,arguments),this.constructor===Ee&&this.b2ContactFactory.apply(this,arguments)}function ke(){ke.b2ContactRegister.apply(this,arguments)}function Ne(){Ne.b2ContactResult.apply(this,arguments)}function je(){je.b2ContactSolver.apply(this,arguments),this.constructor===je&&this.b2ContactSolver.apply(this,arguments)}function Ue(){Ue.b2EdgeAndCircleContact.apply(this,arguments)}function qe(){qe.b2NullContact.apply(this,arguments),this.constructor===qe&&this.b2NullContact.apply(this,arguments)}function Ke(){Ke.b2PolyAndCircleContact.apply(this,arguments)}function We(){We.b2PolyAndEdgeContact.apply(this,arguments)}function Oe(){Oe.b2PolygonContact.apply(this,arguments)}function Xe(){Xe.b2PositionSolverManifold.apply(this,arguments),this.constructor===Xe&&this.b2PositionSolverManifold.apply(this,arguments)}function Ze(){Ze.b2BuoyancyController.apply(this,arguments)}function He(){He.b2ConstantAccelController.apply(this,arguments)}function Ye(){Ye.b2ConstantForceController.apply(this,arguments)}function Qe(){Qe.b2Controller.apply(this,arguments)}function $e(){$e.b2ControllerEdge.apply(this,arguments)}function eo(){eo.b2GravityController.apply(this,arguments)}function oo(){oo.b2TensorDampingController.apply(this,arguments)}function to(){to.b2DistanceJoint.apply(this,arguments),this.constructor===to&&this.b2DistanceJoint.apply(this,arguments)}function no(){no.b2DistanceJointDef.apply(this,arguments),this.constructor===no&&this.b2DistanceJointDef.apply(this,arguments)}function io(){io.b2FrictionJoint.apply(this,arguments),this.constructor===io&&this.b2FrictionJoint.apply(this,arguments)}function mo(){mo.b2FrictionJointDef.apply(this,arguments),this.constructor===mo&&this.b2FrictionJointDef.apply(this,arguments)}function ao(){ao.b2GearJoint.apply(this,arguments),this.constructor===ao&&this.b2GearJoint.apply(this,arguments)}function ro(){ro.b2GearJointDef.apply(this,arguments),this.constructor===ro&&this.b2GearJointDef.apply(this,arguments)}function so(){so.b2Jacobian.apply(this,arguments)}function _o(){_o.b2Joint.apply(this,arguments),this.constructor===_o&&this.b2Joint.apply(this,arguments)}function po(){po.b2JointDef.apply(this,arguments),this.constructor===po&&this.b2JointDef.apply(this,arguments)}function co(){co.b2JointEdge.apply(this,arguments)}function yo(){yo.b2LineJoint.apply(this,arguments),this.constructor===yo&&this.b2LineJoint.apply(this,arguments)}function xo(){xo.b2LineJointDef.apply(this,arguments),this.constructor===xo&&this.b2LineJointDef.apply(this,arguments)}function uo(){uo.b2MouseJoint.apply(this,arguments),this.constructor===uo&&this.b2MouseJoint.apply(this,arguments)}function bo(){bo.b2MouseJointDef.apply(this,arguments),this.constructor===bo&&this.b2MouseJointDef.apply(this,arguments)}function Co(){Co.b2PrismaticJoint.apply(this,arguments),this.constructor===Co&&this.b2PrismaticJoint.apply(this,arguments)}function fo(){fo.b2PrismaticJointDef.apply(this,arguments),this.constructor===fo&&this.b2PrismaticJointDef.apply(this,arguments)}function Ao(){Ao.b2PulleyJoint.apply(this,arguments),this.constructor===Ao&&this.b2PulleyJoint.apply(this,arguments)}function So(){So.b2PulleyJointDef.apply(this,arguments),this.constructor===So&&this.b2PulleyJointDef.apply(this,arguments)}function go(){go.b2RevoluteJoint.apply(this,arguments),this.constructor===go&&this.b2RevoluteJoint.apply(this,arguments)}function Do(){Do.b2RevoluteJointDef.apply(this,arguments),this.constructor===Do&&this.b2RevoluteJointDef.apply(this,arguments)}function vo(){vo.b2WeldJoint.apply(this,arguments),this.constructor===vo&&this.b2WeldJoint.apply(this,arguments)}function ho(){ho.b2WeldJointDef.apply(this,arguments),this.constructor===ho&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";Box2D.Collision.b2AABB=o;Box2D.Collision.b2Bound=n;Box2D.Collision.b2BoundValues=_;Box2D.Collision.b2Collision=S;Box2D.Collision.b2ContactID=g;Box2D.Collision.b2ContactPoint=V;Box2D.Collision.b2Distance=M;Box2D.Collision.b2DistanceInput=w;Box2D.Collision.b2DistanceOutput=G;Box2D.Collision.b2DistanceProxy=L;Box2D.Collision.b2DynamicTree=J;Box2D.Collision.b2DynamicTreeBroadPhase=F;Box2D.Collision.b2DynamicTreeNode=R;Box2D.Collision.b2DynamicTreePair=E;Box2D.Collision.b2Manifold=N;Box2D.Collision.b2ManifoldPoint=U;Box2D.Collision.b2Point=q;Box2D.Collision.b2RayCastInput=W;Box2D.Collision.b2RayCastOutput=O;Box2D.Collision.b2Segment=X;Box2D.Collision.b2SeparationFunction=Z;Box2D.Collision.b2Simplex=H;Box2D.Collision.b2SimplexCache=Y;Box2D.Collision.b2SimplexVertex=Q;Box2D.Collision.b2TimeOfImpact=$;Box2D.Collision.b2TOIInput=ee;Box2D.Collision.b2WorldManifold=oe;Box2D.Collision.ClipVertex=te;Box2D.Collision.Features=ne;Box2D.Collision.Shapes.b2CircleShape=ie;Box2D.Collision.Shapes.b2EdgeChainDef=me;Box2D.Collision.Shapes.b2EdgeShape=ae;Box2D.Collision.Shapes.b2MassData=le;Box2D.Collision.Shapes.b2PolygonShape=re;Box2D.Collision.Shapes.b2Shape=se,Box2D.Common.b2internal="Box2D.Common.b2internal";Box2D.Common.b2Color=_e;Box2D.Common.b2Settings=pe;Box2D.Common.Math.b2Mat22=ye;Box2D.Common.Math.b2Mat33=xe;Box2D.Common.Math.b2Math=ue;Box2D.Common.Math.b2Sweep=de;Box2D.Common.Math.b2Transform=be;Box2D.Common.Math.b2Vec2=Ce;Box2D.Common.Math.b2Vec3=fe;Box2D.Dynamics.b2Body=Ae;Box2D.Dynamics.b2BodyDef=Se;Box2D.Dynamics.b2ContactFilter=ge;Box2D.Dynamics.b2ContactImpulse=De;Box2D.Dynamics.b2ContactListener=ve;Box2D.Dynamics.b2ContactManager=he;Box2D.Dynamics.b2DebugDraw=Be;Box2D.Dynamics.b2DestructionListener=Ve;Box2D.Dynamics.b2FilterData=Me;Box2D.Dynamics.b2Fixture=we;Box2D.Dynamics.b2FixtureDef=Ie;Box2D.Dynamics.b2Island=Ge;Box2D.Dynamics.b2TimeStep=Le;Box2D.Dynamics.b2World=Je;Box2D.Dynamics.Contacts.b2CircleContact=Fe;Box2D.Dynamics.Contacts.b2Contact=Pe;Box2D.Dynamics.Contacts.b2ContactConstraint=Re;Box2D.Dynamics.Contacts.b2ContactConstraintPoint=Te;Box2D.Dynamics.Contacts.b2ContactEdge=ze;Box2D.Dynamics.Contacts.b2ContactFactory=Ee;Box2D.Dynamics.Contacts.b2ContactRegister=ke;Box2D.Dynamics.Contacts.b2ContactResult=Ne;Box2D.Dynamics.Contacts.b2ContactSolver=je;Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=Ue;Box2D.Dynamics.Contacts.b2NullContact=qe;Box2D.Dynamics.Contacts.b2PolyAndCircleContact=Ke;Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=We;Box2D.Dynamics.Contacts.b2PolygonContact=Oe;Box2D.Dynamics.Contacts.b2PositionSolverManifold=Xe;Box2D.Dynamics.Controllers.b2BuoyancyController=Ze;Box2D.Dynamics.Controllers.b2ConstantAccelController=He;Box2D.Dynamics.Controllers.b2ConstantForceController=Ye;Box2D.Dynamics.Controllers.b2Controller=Qe;Box2D.Dynamics.Controllers.b2ControllerEdge=$e;Box2D.Dynamics.Controllers.b2GravityController=eo;Box2D.Dynamics.Controllers.b2TensorDampingController=oo;Box2D.Dynamics.Joints.b2DistanceJoint=to;Box2D.Dynamics.Joints.b2DistanceJointDef=no;Box2D.Dynamics.Joints.b2FrictionJoint=io;Box2D.Dynamics.Joints.b2FrictionJointDef=mo;Box2D.Dynamics.Joints.b2GearJoint=ao;Box2D.Dynamics.Joints.b2GearJointDef=ro;Box2D.Dynamics.Joints.b2Jacobian=so;Box2D.Dynamics.Joints.b2Joint=_o;Box2D.Dynamics.Joints.b2JointDef=po;Box2D.Dynamics.Joints.b2JointEdge=co;Box2D.Dynamics.Joints.b2LineJoint=yo;Box2D.Dynamics.Joints.b2LineJointDef=xo;Box2D.Dynamics.Joints.b2MouseJoint=uo;Box2D.Dynamics.Joints.b2MouseJointDef=bo;Box2D.Dynamics.Joints.b2PrismaticJoint=Co;Box2D.Dynamics.Joints.b2PrismaticJointDef=fo;Box2D.Dynamics.Joints.b2PulleyJoint=Ao;Box2D.Dynamics.Joints.b2PulleyJointDef=So;Box2D.Dynamics.Joints.b2RevoluteJoint=go;Box2D.Dynamics.Joints.b2RevoluteJointDef=Do;Box2D.Dynamics.Joints.b2WeldJoint=vo;Box2D.Dynamics.Joints.b2WeldJointDef=ho}(),Box2D.postDefs=[],function(){var o=Box2D.Collision.Shapes.b2CircleShape,n=Box2D.Collision.Shapes.b2EdgeChainDef,_=Box2D.Collision.Shapes.b2EdgeShape,S=Box2D.Collision.Shapes.b2MassData,g=Box2D.Collision.Shapes.b2PolygonShape,V=Box2D.Collision.Shapes.b2Shape,M=Box2D.Common.b2Color,w=Box2D.Common.b2internal,G=Box2D.Common.b2Settings,L=Box2D.Common.Math.b2Mat22,J=Box2D.Common.Math.b2Mat33,F=Box2D.Common.Math.b2Math,R=Box2D.Common.Math.b2Sweep,E=Box2D.Common.Math.b2Transform,N=Box2D.Common.Math.b2Vec2,U=Box2D.Common.Math.b2Vec3,q=Box2D.Collision.b2AABB,W=Box2D.Collision.b2Bound,O=Box2D.Collision.b2BoundValues,X=Box2D.Collision.b2Collision,Z=Box2D.Collision.b2ContactID,H=Box2D.Collision.b2ContactPoint,Y=Box2D.Collision.b2Distance,Q=Box2D.Collision.b2DistanceInput,$=Box2D.Collision.b2DistanceOutput,ee=Box2D.Collision.b2DistanceProxy,oe=Box2D.Collision.b2DynamicTree,te=Box2D.Collision.b2DynamicTreeBroadPhase,ne=Box2D.Collision.b2DynamicTreeNode,ie=Box2D.Collision.b2DynamicTreePair,me=Box2D.Collision.b2Manifold,ae=Box2D.Collision.b2ManifoldPoint,le=Box2D.Collision.b2Point,re=Box2D.Collision.b2RayCastInput,se=Box2D.Collision.b2RayCastOutput,_e=Box2D.Collision.b2Segment,pe=Box2D.Collision.b2SeparationFunction,ye=Box2D.Collision.b2Simplex,xe=Box2D.Collision.b2SimplexCache,ue=Box2D.Collision.b2SimplexVertex,de=Box2D.Collision.b2TimeOfImpact,be=Box2D.Collision.b2TOIInput,Ce=Box2D.Collision.b2WorldManifold,fe=Box2D.Collision.ClipVertex,Ae=Box2D.Collision.Features,Se=Box2D.Collision.IBroadPhase;q.b2AABB=function(){this.lowerBound=new N,this.upperBound=new N},q.prototype.IsValid=function(){var ge=this.upperBound.x-this.lowerBound.x,De=this.upperBound.y-this.lowerBound.y,ve=0<=ge&&0<=De;return ve=ve&&this.lowerBound.IsValid()&&this.upperBound.IsValid(),ve},q.prototype.GetCenter=function(){return new N((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},q.prototype.GetExtents=function(){return new N((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},q.prototype.Contains=function(ge){var De=!0;return De=De&&this.lowerBound.x<=ge.lowerBound.x,De=De&&this.lowerBound.y<=ge.lowerBound.y,De=De&&ge.upperBound.x<=this.upperBound.x,De=De&&ge.upperBound.y<=this.upperBound.y,De},q.prototype.RayCast=function(ge,De){var ve=-Number.MAX_VALUE,he=Number.MAX_VALUE,Be=De.p1.x,Ve=De.p1.y,Me=De.p2.x-De.p1.x,we=De.p2.y-De.p1.y,Ie=Math.abs(Me),Ge=Math.abs(we),Le=ge.normal,Je=0,Fe=0,Pe=0,Re=0,Te=0;if(Ie<Number.MIN_VALUE){if(Be<this.lowerBound.x||this.upperBound.x<Be)return!1;}else if(Je=1/Me,Fe=(this.lowerBound.x-Be)*Je,Pe=(this.upperBound.x-Be)*Je,Te=-1,Fe>Pe&&(Re=Fe,Fe=Pe,Pe=Re,Te=1),Fe>ve&&(Le.x=Te,Le.y=0,ve=Fe),he=Math.min(he,Pe),ve>he)return!1;if(Ge<Number.MIN_VALUE){if(Ve<this.lowerBound.y||this.upperBound.y<Ve)return!1;}else if(Je=1/we,Fe=(this.lowerBound.y-Ve)*Je,Pe=(this.upperBound.y-Ve)*Je,Te=-1,Fe>Pe&&(Re=Fe,Fe=Pe,Pe=Re,Te=1),Fe>ve&&(Le.y=Te,Le.x=0,ve=Fe),he=Math.min(he,Pe),ve>he)return!1;return ge.fraction=ve,!0},q.prototype.TestOverlap=function(ge){var De=ge.lowerBound.x-this.upperBound.x,ve=ge.lowerBound.y-this.upperBound.y,he=this.lowerBound.x-ge.upperBound.x,Be=this.lowerBound.y-ge.upperBound.y;return 0<De||0<ve?!1:0<he||0<Be?!1:!0},q.Combine=function(ge,De){var ve=new q;return ve.Combine(ge,De),ve},q.prototype.Combine=function(ge,De){this.lowerBound.x=Math.min(ge.lowerBound.x,De.lowerBound.x),this.lowerBound.y=Math.min(ge.lowerBound.y,De.lowerBound.y),this.upperBound.x=Math.max(ge.upperBound.x,De.upperBound.x),this.upperBound.y=Math.max(ge.upperBound.y,De.upperBound.y)},W.b2Bound=function(){},W.prototype.IsLower=function(){return 0==(1&this.value)},W.prototype.IsUpper=function(){return 1==(1&this.value)},W.prototype.Swap=function(ge){var De=this.value,ve=this.proxy,he=this.stabbingCount;this.value=ge.value,this.proxy=ge.proxy,this.stabbingCount=ge.stabbingCount,ge.value=De,ge.proxy=ve,ge.stabbingCount=he},O.b2BoundValues=function(){},O.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number,this.lowerValues[0]=0,this.lowerValues[1]=0,this.upperValues=new Vector_a2j_Number,this.upperValues[0]=0,this.upperValues[1]=0},X.b2Collision=function(){},X.ClipSegmentToLine=function(ge,De,ve,he){void 0===he&&(he=0);var Ve=0,Be;Be=De[0];var Me=Be.v;Be=De[1];var we=Be.v,Ie=ve.x*Me.x+ve.y*Me.y-he,Ge=ve.x*we.x+ve.y*we.y-he;if(0>=Ie&&ge[Ve++].Set(De[0]),0>=Ge&&ge[Ve++].Set(De[1]),0>Ie*Ge){var Le=Ie/(Ie-Ge);Be=ge[Ve];var Je=Be.v;Je.x=Me.x+Le*(we.x-Me.x),Je.y=Me.y+Le*(we.y-Me.y),Be=ge[Ve];var Fe;0<Ie?(Fe=De[0],Be.id=Fe.id):(Fe=De[1],Be.id=Fe.id),++Ve}return Ve},X.EdgeSeparation=function(ge,De,ve,he,Be){ve===void 0&&(ve=0);var Ve=parseInt(ge.m_vertexCount),Me=ge.m_vertices,we=ge.m_normals,Ie=parseInt(he.m_vertexCount),Ge=he.m_vertices,Le,Je;Le=De.R,Je=we[ve];var Fe=Le.col1.x*Je.x+Le.col2.x*Je.y,Pe=Le.col1.y*Je.x+Le.col2.y*Je.y;Le=Be.R;for(var Re=Le.col1.x*Fe+Le.col1.y*Pe,Te=Le.col2.x*Fe+Le.col2.y*Pe,ze=0,Ee=Number.MAX_VALUE,ke=0;ke<Ie;++ke){Je=Ge[ke];var Ne=Je.x*Re+Je.y*Te;Ne<Ee&&(Ee=Ne,ze=ke)}Je=Me[ve],Le=De.R;var je=De.position.x+(Le.col1.x*Je.x+Le.col2.x*Je.y),Ue=De.position.y+(Le.col1.y*Je.x+Le.col2.y*Je.y);Je=Ge[ze],Le=Be.R;var qe=Be.position.x+(Le.col1.x*Je.x+Le.col2.x*Je.y),Ke=Be.position.y+(Le.col1.y*Je.x+Le.col2.y*Je.y);qe-=je,Ke-=Ue;var We=qe*Fe+Ke*Pe;return We},X.FindMaxSeparation=function(ge,De,ve,he,Be){var Ve=parseInt(De.m_vertexCount),Me=De.m_normals,we,Ie;Ie=Be.R,we=he.m_centroid;var Ge=Be.position.x+(Ie.col1.x*we.x+Ie.col2.x*we.y),Le=Be.position.y+(Ie.col1.y*we.x+Ie.col2.y*we.y);Ie=ve.R,we=De.m_centroid,Ge-=ve.position.x+(Ie.col1.x*we.x+Ie.col2.x*we.y),Le-=ve.position.y+(Ie.col1.y*we.x+Ie.col2.y*we.y);for(var Je=Ge*ve.R.col1.x+Le*ve.R.col1.y,Fe=Ge*ve.R.col2.x+Le*ve.R.col2.y,Pe=0,Re=-Number.MAX_VALUE,Te=0;Te<Ve;++Te){we=Me[Te];var ze=we.x*Je+we.y*Fe;ze>Re&&(Re=ze,Pe=Te)}var Ee=X.EdgeSeparation(De,ve,Pe,he,Be),ke=parseInt(0<=Pe-1?Pe-1:Ve-1),Ne=X.EdgeSeparation(De,ve,ke,he,Be),je=parseInt(Pe+1<Ve?Pe+1:0),Ue=X.EdgeSeparation(De,ve,je,he,Be),qe=0,Ke=0,We=0;if(Ne>Ee&&Ne>Ue)We=-1,qe=ke,Ke=Ne;else if(Ue>Ee)We=1,qe=je,Ke=Ue;else return ge[0]=Pe,Ee;for(;Pe=-1==We?0<=qe-1?qe-1:Ve-1:qe+1<Ve?qe+1:0,Ee=X.EdgeSeparation(De,ve,Pe,he,Be),Ee>Ke;)qe=Pe,Ke=Ee;return ge[0]=qe,Ke},X.FindIncidentEdge=function(ge,De,ve,he,Be,Ve){he===void 0&&(he=0);var Me=parseInt(De.m_vertexCount),we=De.m_normals,Ie=parseInt(Be.m_vertexCount),Ge=Be.m_vertices,Le=Be.m_normals,Je,Fe;Je=ve.R,Fe=we[he];var Pe=Je.col1.x*Fe.x+Je.col2.x*Fe.y,Re=Je.col1.y*Fe.x+Je.col2.y*Fe.y;Je=Ve.R;var Te=Je.col1.x*Pe+Je.col1.y*Re;Re=Je.col2.x*Pe+Je.col2.y*Re,Pe=Te;for(var ze=0,Ee=Number.MAX_VALUE,ke=0;ke<Ie;++ke){Fe=Le[ke];var Ne=Pe*Fe.x+Re*Fe.y;Ne<Ee&&(Ee=Ne,ze=ke)}var je,Ue=parseInt(ze),qe=parseInt(Ue+1<Ie?Ue+1:0);je=ge[0],Fe=Ge[Ue],Je=Ve.R,je.v.x=Ve.position.x+(Je.col1.x*Fe.x+Je.col2.x*Fe.y),je.v.y=Ve.position.y+(Je.col1.y*Fe.x+Je.col2.y*Fe.y),je.id.features.referenceEdge=he,je.id.features.incidentEdge=Ue,je.id.features.incidentVertex=0,je=ge[1],Fe=Ge[qe],Je=Ve.R,je.v.x=Ve.position.x+(Je.col1.x*Fe.x+Je.col2.x*Fe.y),je.v.y=Ve.position.y+(Je.col1.y*Fe.x+Je.col2.y*Fe.y),je.id.features.referenceEdge=he,je.id.features.incidentEdge=qe,je.id.features.incidentVertex=1},X.MakeClipPointVector=function(){var ge=new Vector(2);return ge[0]=new fe,ge[1]=new fe,ge},X.CollidePolygons=function(ge,De,ve,he,Be){var Ve;ge.m_pointCount=0;var Me=De.m_radius+he.m_radius,we=0;X.s_edgeAO[0]=we;var Ie=X.FindMaxSeparation(X.s_edgeAO,De,ve,he,Be);if(we=X.s_edgeAO[0],!(Ie>Me)){var Ge=0;X.s_edgeBO[0]=Ge;var Le=X.FindMaxSeparation(X.s_edgeBO,he,Be,De,ve);if(Ge=X.s_edgeBO[0],!(Le>Me)){var Te=0,ze=0,Je,Fe,Pe,Re,Ne;Le>0.98*Ie+1e-3?(Je=he,Fe=De,Pe=Be,Re=ve,Te=Ge,ge.m_type=me.e_faceB,ze=1):(Je=De,Fe=he,Pe=ve,Re=Be,Te=we,ge.m_type=me.e_faceA,ze=0);var je=X.s_incidentEdge;X.FindIncidentEdge(je,Je,Pe,Te,Fe,Re);var Ue=parseInt(Je.m_vertexCount),qe=Je.m_vertices,Ke=qe[Te],We;We=Te+1<Ue?qe[parseInt(Te+1)]:qe[0];var Oe=X.s_localTangent;Oe.Set(We.x-Ke.x,We.y-Ke.y),Oe.Normalize();var Xe=X.s_localNormal;Xe.x=Oe.y,Xe.y=-Oe.x;var Ze=X.s_planePoint;Ze.Set(0.5*(Ke.x+We.x),0.5*(Ke.y+We.y));var He=X.s_tangent;Ne=Pe.R,He.x=Ne.col1.x*Oe.x+Ne.col2.x*Oe.y,He.y=Ne.col1.y*Oe.x+Ne.col2.y*Oe.y;var Ye=X.s_tangent2;Ye.x=-He.x,Ye.y=-He.y;var Qe=X.s_normal;Qe.x=He.y,Qe.y=-He.x;var $e=X.s_v11,eo=X.s_v12;$e.x=Pe.position.x+(Ne.col1.x*Ke.x+Ne.col2.x*Ke.y),$e.y=Pe.position.y+(Ne.col1.y*Ke.x+Ne.col2.y*Ke.y),eo.x=Pe.position.x+(Ne.col1.x*We.x+Ne.col2.x*We.y),eo.y=Pe.position.y+(Ne.col1.y*We.x+Ne.col2.y*We.y);var oo=Qe.x*$e.x+Qe.y*$e.y,to=-He.x*$e.x-He.y*$e.y+Me,no=He.x*eo.x+He.y*eo.y+Me,io=X.s_clipPoints1,mo=X.s_clipPoints2,ao=0;if((ao=X.ClipSegmentToLine(io,je,Ye,to),!(2>ao))&&(ao=X.ClipSegmentToLine(mo,io,He,no),!(2>ao))){ge.m_localPlaneNormal.SetV(Xe),ge.m_localPoint.SetV(Ze);for(var ro=0,so=0;so<G.b2_maxManifoldPoints;++so){Ve=mo[so];var _o=Qe.x*Ve.v.x+Qe.y*Ve.v.y-oo;if(_o<=Me){var po=ge.m_points[ro];Ne=Re.R;var co=Ve.v.x-Re.position.x,yo=Ve.v.y-Re.position.y;po.m_localPoint.x=co*Ne.col1.x+yo*Ne.col1.y,po.m_localPoint.y=co*Ne.col2.x+yo*Ne.col2.y,po.m_id.Set(Ve.id),po.m_id.features.flip=ze,++ro}}ge.m_pointCount=ro}}}},X.CollideCircles=function(ge,De,ve,he,Be){ge.m_pointCount=0;var Ve,Me;Ve=ve.R,Me=De.m_p;var we=ve.position.x+(Ve.col1.x*Me.x+Ve.col2.x*Me.y),Ie=ve.position.y+(Ve.col1.y*Me.x+Ve.col2.y*Me.y);Ve=Be.R,Me=he.m_p;var Ge=Be.position.x+(Ve.col1.x*Me.x+Ve.col2.x*Me.y),Le=Be.position.y+(Ve.col1.y*Me.x+Ve.col2.y*Me.y),Je=Ge-we,Fe=Le-Ie,Re=De.m_radius+he.m_radius;Je*Je+Fe*Fe>Re*Re||(ge.m_type=me.e_circles,ge.m_localPoint.SetV(De.m_p),ge.m_localPlaneNormal.SetZero(),ge.m_pointCount=1,ge.m_points[0].m_localPoint.SetV(he.m_p),ge.m_points[0].m_id.key=0)},X.CollidePolygonAndCircle=function(ge,De,ve,he,Be){ge.m_pointCount=0;var Me=0,we=0,Le,Je;Je=Be.R,Le=he.m_p;var Fe=Be.position.x+(Je.col1.x*Le.x+Je.col2.x*Le.y),Pe=Be.position.y+(Je.col1.y*Le.x+Je.col2.y*Le.y);Me=Fe-ve.position.x,we=Pe-ve.position.y,Je=ve.R;for(var Re=Me*Je.col1.x+we*Je.col1.y,Te=Me*Je.col2.x+we*Je.col2.y,Ee=0,ke=-Number.MAX_VALUE,Ne=De.m_radius+he.m_radius,je=parseInt(De.m_vertexCount),Ue=De.m_vertices,qe=De.m_normals,Ke=0;Ke<je;++Ke){Le=Ue[Ke],Me=Re-Le.x,we=Te-Le.y,Le=qe[Ke];var We=Le.x*Me+Le.y*we;if(We>Ne)return;We>ke&&(ke=We,Ee=Ke)}var Oe=parseInt(Ee),Xe=parseInt(Oe+1<je?Oe+1:0),Ze=Ue[Oe],He=Ue[Xe];if(ke<Number.MIN_VALUE)return ge.m_pointCount=1,ge.m_type=me.e_faceA,ge.m_localPlaneNormal.SetV(qe[Ee]),ge.m_localPoint.x=0.5*(Ze.x+He.x),ge.m_localPoint.y=0.5*(Ze.y+He.y),ge.m_points[0].m_localPoint.SetV(he.m_p),void(ge.m_points[0].m_id.key=0);var Ye=(Re-Ze.x)*(He.x-Ze.x)+(Te-Ze.y)*(He.y-Ze.y),Qe=(Re-He.x)*(Ze.x-He.x)+(Te-He.y)*(Ze.y-He.y);if(0>=Ye){if((Re-Ze.x)*(Re-Ze.x)+(Te-Ze.y)*(Te-Ze.y)>Ne*Ne)return;ge.m_pointCount=1,ge.m_type=me.e_faceA,ge.m_localPlaneNormal.x=Re-Ze.x,ge.m_localPlaneNormal.y=Te-Ze.y,ge.m_localPlaneNormal.Normalize(),ge.m_localPoint.SetV(Ze),ge.m_points[0].m_localPoint.SetV(he.m_p),ge.m_points[0].m_id.key=0}else if(0>=Qe){if((Re-He.x)*(Re-He.x)+(Te-He.y)*(Te-He.y)>Ne*Ne)return;ge.m_pointCount=1,ge.m_type=me.e_faceA,ge.m_localPlaneNormal.x=Re-He.x,ge.m_localPlaneNormal.y=Te-He.y,ge.m_localPlaneNormal.Normalize(),ge.m_localPoint.SetV(He),ge.m_points[0].m_localPoint.SetV(he.m_p),ge.m_points[0].m_id.key=0}else{var $e=0.5*(Ze.x+He.x),eo=0.5*(Ze.y+He.y);if(ke=(Re-$e)*qe[Oe].x+(Te-eo)*qe[Oe].y,ke>Ne)return;ge.m_pointCount=1,ge.m_type=me.e_faceA,ge.m_localPlaneNormal.x=qe[Oe].x,ge.m_localPlaneNormal.y=qe[Oe].y,ge.m_localPlaneNormal.Normalize(),ge.m_localPoint.Set($e,eo),ge.m_points[0].m_localPoint.SetV(he.m_p),ge.m_points[0].m_id.key=0}},X.TestOverlap=function(ge,De){var ve=De.lowerBound,he=ge.upperBound,Be=ve.x-he.x,Ve=ve.y-he.y;ve=ge.lowerBound,he=De.upperBound;var Me=ve.x-he.x,we=ve.y-he.y;return 0<Be||0<Ve?!1:0<Me||0<we?!1:!0},Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=X.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints1=X.MakeClipPointVector(),Box2D.Collision.b2Collision.s_clipPoints2=X.MakeClipPointVector(),Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1),Box2D.Collision.b2Collision.s_localTangent=new N,Box2D.Collision.b2Collision.s_localNormal=new N,Box2D.Collision.b2Collision.s_planePoint=new N,Box2D.Collision.b2Collision.s_normal=new N,Box2D.Collision.b2Collision.s_tangent=new N,Box2D.Collision.b2Collision.s_tangent2=new N,Box2D.Collision.b2Collision.s_v11=new N,Box2D.Collision.b2Collision.s_v12=new N,Box2D.Collision.b2Collision.b2CollidePolyTempVec=new N,Box2D.Collision.b2Collision.b2_nullFeature=255}),Z.b2ContactID=function(){this.features=new Ae},Z.prototype.b2ContactID=function(){this.features._m_id=this},Z.prototype.Set=function(ge){this.key=ge._key},Z.prototype.Copy=function(){var ge=new Z;return ge.key=this.key,ge},Object.defineProperty(Z.prototype,"key",{enumerable:!1,configurable:!0,get:function get(){return this._key}}),Object.defineProperty(Z.prototype,"key",{enumerable:!1,configurable:!0,set:function set(ge){ge===void 0&&(ge=0),this._key=ge,this.features._referenceEdge=255&this._key,this.features._incidentEdge=255&(65280&this._key)>>8,this.features._incidentVertex=255&(16711680&this._key)>>16,this.features._flip=255&(4278190080&this._key)>>24}}),H.b2ContactPoint=function(){this.position=new N,this.velocity=new N,this.normal=new N,this.id=new Z},Y.b2Distance=function(){},Y.Distance=function(ge,De,ve){++Y.b2_gjkCalls;var he=ve.proxyA,Be=ve.proxyB,Ve=ve.transformA,Me=ve.transformB,we=Y.s_simplex;we.ReadCache(De,he,Ve,Be,Me);for(var Ie=we.m_vertices,Le=Y.s_saveA,Je=Y.s_saveB,Fe=0,Pe=we.GetClosestPoint(),Re=Pe.LengthSquared(),Te=Re,ze=0,ke=0,Ee;ke<20;){for(Fe=we.m_count,ze=0;ze<Fe;ze++)Le[ze]=Ie[ze].indexA,Je[ze]=Ie[ze].indexB;switch(we.m_count){case 1:break;case 2:we.Solve2();break;case 3:we.Solve3();break;default:G.b2Assert(!1);}if(3==we.m_count)break;Ee=we.GetClosestPoint(),Te=Ee.LengthSquared(),Te>Re,Re=Te;var Ne=we.GetSearchDirection();if(Ne.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var je=Ie[we.m_count];je.indexA=he.GetSupport(F.MulTMV(Ve.R,Ne.GetNegative())),je.wA=F.MulX(Ve,he.GetVertex(je.indexA)),je.indexB=Be.GetSupport(F.MulTMV(Me.R,Ne)),je.wB=F.MulX(Me,Be.GetVertex(je.indexB)),je.w=F.SubtractVV(je.wB,je.wA),++ke,++Y.b2_gjkIters;var Ue=!1;for(ze=0;ze<Fe;ze++)if(je.indexA==Le[ze]&&je.indexB==Je[ze]){Ue=!0;break}if(Ue)break;++we.m_count}if(Y.b2_gjkMaxIters=F.Max(Y.b2_gjkMaxIters,ke),we.GetWitnessPoints(ge.pointA,ge.pointB),ge.distance=F.SubtractVV(ge.pointA,ge.pointB).Length(),ge.iterations=ke,we.WriteCache(De),ve.useRadii){var qe=he.m_radius,Ke=Be.m_radius;if(ge.distance>qe+Ke&&ge.distance>Number.MIN_VALUE){ge.distance-=qe+Ke;var We=F.SubtractVV(ge.pointB,ge.pointA);We.Normalize(),ge.pointA.x+=qe*We.x,ge.pointA.y+=qe*We.y,ge.pointB.x-=Ke*We.x,ge.pointB.y-=Ke*We.y}else Ee=new N,Ee.x=.5*(ge.pointA.x+ge.pointB.x),Ee.y=.5*(ge.pointA.y+ge.pointB.y),ge.pointA.x=ge.pointB.x=Ee.x,ge.pointA.y=ge.pointB.y=Ee.y,ge.distance=0}},Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new ye,Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3),Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)}),Q.b2DistanceInput=function(){},$.b2DistanceOutput=function(){this.pointA=new N,this.pointB=new N},ee.b2DistanceProxy=function(){},ee.prototype.Set=function(ge){switch(ge.GetType()){case V.e_circleShape:{var De=ge instanceof o?ge:null;this.m_vertices=new Vector(1,!0),this.m_vertices[0]=De.m_p,this.m_count=1,this.m_radius=De.m_radius}break;case V.e_polygonShape:{var ve=ge instanceof g?ge:null;this.m_vertices=ve.m_vertices,this.m_count=ve.m_vertexCount,this.m_radius=ve.m_radius}break;default:G.b2Assert(!1);}},ee.prototype.GetSupport=function(ge){for(var De=0,ve=this.m_vertices[0].x*ge.x+this.m_vertices[0].y*ge.y,he=1,Be;he<this.m_count;++he)Be=this.m_vertices[he].x*ge.x+this.m_vertices[he].y*ge.y,Be>ve&&(De=he,ve=Be);return De},ee.prototype.GetSupportVertex=function(ge){for(var De=0,ve=this.m_vertices[0].x*ge.x+this.m_vertices[0].y*ge.y,he=1,Be;he<this.m_count;++he)Be=this.m_vertices[he].x*ge.x+this.m_vertices[he].y*ge.y,Be>ve&&(De=he,ve=Be);return this.m_vertices[De]},ee.prototype.GetVertexCount=function(){return this.m_count},ee.prototype.GetVertex=function(ge){return void 0===ge&&(ge=0),G.b2Assert(0<=ge&&ge<this.m_count),this.m_vertices[ge]},oe.b2DynamicTree=function(){},oe.prototype.b2DynamicTree=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},oe.prototype.CreateProxy=function(ge,De){var ve=this.AllocateNode(),he=G.b2_aabbExtension,Be=G.b2_aabbExtension;return ve.aabb.lowerBound.x=ge.lowerBound.x-he,ve.aabb.lowerBound.y=ge.lowerBound.y-Be,ve.aabb.upperBound.x=ge.upperBound.x+he,ve.aabb.upperBound.y=ge.upperBound.y+Be,ve.userData=De,this.InsertLeaf(ve),ve},oe.prototype.DestroyProxy=function(ge){this.RemoveLeaf(ge),this.FreeNode(ge)},oe.prototype.MoveProxy=function(ge,De,ve){if(G.b2Assert(ge.IsLeaf()),ge.aabb.Contains(De))return!1;this.RemoveLeaf(ge);var he=G.b2_aabbExtension+G.b2_aabbMultiplier*(0<ve.x?ve.x:-ve.x),Be=G.b2_aabbExtension+G.b2_aabbMultiplier*(0<ve.y?ve.y:-ve.y);return ge.aabb.lowerBound.x=De.lowerBound.x-he,ge.aabb.lowerBound.y=De.lowerBound.y-Be,ge.aabb.upperBound.x=De.upperBound.x+he,ge.aabb.upperBound.y=De.upperBound.y+Be,this.InsertLeaf(ge),!0},oe.prototype.Rebalance=function(ge){if(void 0===ge&&(ge=0),null!=this.m_root)for(var De=0;De<ge;De++){for(var ve=this.m_root,he=0;!1==ve.IsLeaf();)ve=1&this.m_path>>he?ve.child2:ve.child1,he=31&he+1;++this.m_path,this.RemoveLeaf(ve),this.InsertLeaf(ve)}},oe.prototype.GetFatAABB=function(ge){return ge.aabb},oe.prototype.GetUserData=function(ge){return ge.userData},oe.prototype.Query=function(ge,De){if(null!=this.m_root){var ve=new Vector,he=0;for(ve[he++]=this.m_root;0<he;){var Be=ve[--he];if(Be.aabb.TestOverlap(De))if(Be.IsLeaf()){var Ve=ge(Be);if(!Ve)return}else ve[he++]=Be.child1,ve[he++]=Be.child2}}},oe.prototype.RayCast=function(ge,De){if(null!=this.m_root){var ve=De.p1,he=De.p2,Be=F.SubtractVV(ve,he);Be.Normalize();var Ve=F.CrossFV(1,Be),Me=F.AbsV(Ve),we=De.maxFraction,Ie=new q,Ge=0,Le=0;Ge=ve.x+we*(he.x-ve.x),Le=ve.y+we*(he.y-ve.y),Ie.lowerBound.x=Math.min(ve.x,Ge),Ie.lowerBound.y=Math.min(ve.y,Le),Ie.upperBound.x=Math.max(ve.x,Ge),Ie.upperBound.y=Math.max(ve.y,Le);var Je=new Vector,Fe=0;for(Je[Fe++]=this.m_root;0<Fe;){var Pe=Je[--Fe];if(!1!=Pe.aabb.TestOverlap(Ie)){var Re=Pe.aabb.GetCenter(),Te=Pe.aabb.GetExtents(),ze=Math.abs(Ve.x*(ve.x-Re.x)+Ve.y*(ve.y-Re.y))-Me.x*Te.x-Me.y*Te.y;if(!(0<ze))if(Pe.IsLeaf()){var Ee=new re;if(Ee.p1=De.p1,Ee.p2=De.p2,Ee.maxFraction=De.maxFraction,we=ge(Ee,Pe),0==we)return;0<we&&(Ge=ve.x+we*(he.x-ve.x),Le=ve.y+we*(he.y-ve.y),Ie.lowerBound.x=Math.min(ve.x,Ge),Ie.lowerBound.y=Math.min(ve.y,Le),Ie.upperBound.x=Math.max(ve.x,Ge),Ie.upperBound.y=Math.max(ve.y,Le))}else Je[Fe++]=Pe.child1,Je[Fe++]=Pe.child2}}}},oe.prototype.AllocateNode=function(){if(this.m_freeList){var ge=this.m_freeList;return this.m_freeList=ge.parent,ge.parent=null,ge.child1=null,ge.child2=null,ge}return new ne},oe.prototype.FreeNode=function(ge){ge.parent=this.m_freeList,this.m_freeList=ge},oe.prototype.InsertLeaf=function(ge){if(++this.m_insertionCount,null==this.m_root)return this.m_root=ge,void(this.m_root.parent=null);var De=ge.aabb.GetCenter(),ve=this.m_root;if(!1==ve.IsLeaf())do{var he=ve.child1,Be=ve.child2,Ve=Math.abs((he.aabb.lowerBound.x+he.aabb.upperBound.x)/2-De.x)+Math.abs((he.aabb.lowerBound.y+he.aabb.upperBound.y)/2-De.y),Me=Math.abs((Be.aabb.lowerBound.x+Be.aabb.upperBound.x)/2-De.x)+Math.abs((Be.aabb.lowerBound.y+Be.aabb.upperBound.y)/2-De.y);ve=Ve<Me?he:Be}while(!1==ve.IsLeaf());var we=ve.parent,Ie=this.AllocateNode();if(Ie.parent=we,Ie.userData=null,Ie.aabb.Combine(ge.aabb,ve.aabb),we){ve.parent.child1==ve?we.child1=Ie:we.child2=Ie,Ie.child1=ve,Ie.child2=ge,ve.parent=Ie,ge.parent=Ie;do{if(we.aabb.Contains(Ie.aabb))break;we.aabb.Combine(we.child1.aabb,we.child2.aabb),Ie=we,we=we.parent}while(we)}else Ie.child1=ve,Ie.child2=ge,ve.parent=Ie,ge.parent=Ie,this.m_root=Ie},oe.prototype.RemoveLeaf=function(ge){if(ge==this.m_root)return void(this.m_root=null);var De=ge.parent,ve=De.parent,he;if(he=De.child1==ge?De.child2:De.child1,ve)for(ve.child1==De?ve.child1=he:ve.child2=he,he.parent=ve,this.FreeNode(De);ve;){var Be=ve.aabb;if(ve.aabb=q.Combine(ve.child1.aabb,ve.child2.aabb),Be.Contains(ve.aabb))break;ve=ve.parent}else this.m_root=he,he.parent=null,this.FreeNode(De)},te.b2DynamicTreeBroadPhase=function(){this.m_tree=new oe,this.m_moveBuffer=new Vector,this.m_pairBuffer=new Vector,this.m_pairCount=0},te.prototype.CreateProxy=function(ge,De){var ve=this.m_tree.CreateProxy(ge,De);return++this.m_proxyCount,this.BufferMove(ve),ve},te.prototype.DestroyProxy=function(ge){this.UnBufferMove(ge),--this.m_proxyCount,this.m_tree.DestroyProxy(ge)},te.prototype.MoveProxy=function(ge,De,ve){var he=this.m_tree.MoveProxy(ge,De,ve);he&&this.BufferMove(ge)},te.prototype.TestOverlap=function(ge,De){var ve=this.m_tree.GetFatAABB(ge),he=this.m_tree.GetFatAABB(De);return ve.TestOverlap(he)},te.prototype.GetUserData=function(ge){return this.m_tree.GetUserData(ge)},te.prototype.GetFatAABB=function(ge){return this.m_tree.GetFatAABB(ge)},te.prototype.GetProxyCount=function(){return this.m_proxyCount},te.prototype.UpdatePairs=function(ge){function De(Le){if(Le==Be)return!0;ve.m_pairCount==ve.m_pairBuffer.length&&(ve.m_pairBuffer[ve.m_pairCount]=new ie);var Je=ve.m_pairBuffer[ve.m_pairCount];return Je.proxyA=Le<Be?Le:Be,Je.proxyB=Le>=Be?Le:Be,++ve.m_pairCount,!0}var ve=this;ve.m_pairCount=0;var he=0,Be;for(he=0;he<ve.m_moveBuffer.length;++he){Be=ve.m_moveBuffer[he];var Ve=ve.m_tree.GetFatAABB(Be);ve.m_tree.Query(De,Ve)}ve.m_moveBuffer.length=0;for(var he=0;he<ve.m_pairCount;){var Me=ve.m_pairBuffer[he],we=ve.m_tree.GetUserData(Me.proxyA),Ie=ve.m_tree.GetUserData(Me.proxyB);for(ge(we,Ie),++he;he<ve.m_pairCount;){var Ge=ve.m_pairBuffer[he];if(Ge.proxyA!=Me.proxyA||Ge.proxyB!=Me.proxyB)break;++he}}},te.prototype.Query=function(ge,De){this.m_tree.Query(ge,De)},te.prototype.RayCast=function(ge,De){this.m_tree.RayCast(ge,De)},te.prototype.Validate=function(){},te.prototype.Rebalance=function(ge){ge===void 0&&(ge=0),this.m_tree.Rebalance(ge)},te.prototype.BufferMove=function(ge){this.m_moveBuffer[this.m_moveBuffer.length]=ge},te.prototype.UnBufferMove=function(ge){var De=parseInt(this.m_moveBuffer.indexOf(ge));this.m_moveBuffer.splice(De,1)},te.prototype.ComparePairs=function(){return 0},te.__implements={},te.__implements[Se]=!0,ne.b2DynamicTreeNode=function(){this.aabb=new q},ne.prototype.IsLeaf=function(){return null==this.child1},ie.b2DynamicTreePair=function(){},me.b2Manifold=function(){this.m_pointCount=0},me.prototype.b2Manifold=function(){this.m_points=new Vector(G.b2_maxManifoldPoints);for(var ge=0;ge<G.b2_maxManifoldPoints;ge++)this.m_points[ge]=new ae;this.m_localPlaneNormal=new N,this.m_localPoint=new N},me.prototype.Reset=function(){for(var ge=0;ge<G.b2_maxManifoldPoints;ge++)(this.m_points[ge]instanceof ae?this.m_points[ge]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0},me.prototype.Set=function(ge){this.m_pointCount=ge.m_pointCount;for(var De=0;De<G.b2_maxManifoldPoints;De++)(this.m_points[De]instanceof ae?this.m_points[De]:null).Set(ge.m_points[De]);this.m_localPlaneNormal.SetV(ge.m_localPlaneNormal),this.m_localPoint.SetV(ge.m_localPoint),this.m_type=ge.m_type},me.prototype.Copy=function(){var ge=new me;return ge.Set(this),ge},Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1,Box2D.Collision.b2Manifold.e_faceA=2,Box2D.Collision.b2Manifold.e_faceB=4}),ae.b2ManifoldPoint=function(){this.m_localPoint=new N,this.m_id=new Z},ae.prototype.b2ManifoldPoint=function(){this.Reset()},ae.prototype.Reset=function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0},ae.prototype.Set=function(ge){this.m_localPoint.SetV(ge.m_localPoint),this.m_normalImpulse=ge.m_normalImpulse,this.m_tangentImpulse=ge.m_tangentImpulse,this.m_id.Set(ge.m_id)},le.b2Point=function(){this.p=new N},le.prototype.Support=function(ge,De,ve){return void 0===De&&(De=0),void 0===ve&&(ve=0),this.p},le.prototype.GetFirstVertex=function(){return this.p},re.b2RayCastInput=function(){this.p1=new N,this.p2=new N},re.prototype.b2RayCastInput=function(ge,De,ve){ge===void 0&&(ge=null),De===void 0&&(De=null),ve===void 0&&(ve=1),ge&&this.p1.SetV(ge),De&&this.p2.SetV(De),this.maxFraction=ve},se.b2RayCastOutput=function(){this.normal=new N},_e.b2Segment=function(){this.p1=new N,this.p2=new N},_e.prototype.TestSegment=function(ge,De,ve,he){he===void 0&&(he=0);var Be=ve.p1,Ve=ve.p2.x-Be.x,Me=ve.p2.y-Be.y,we=this.p2.x-this.p1.x,Ie=this.p2.y-this.p1.y,Ge=Ie,Le=-we,Je=100*Number.MIN_VALUE,Fe=-(Ve*Ge+Me*Le);if(Fe>Je){var Pe=Be.x-this.p1.x,Re=Be.y-this.p1.y,Te=Pe*Ge+Re*Le;if(0<=Te&&Te<=he*Fe){var ze=-Ve*Re+Me*Pe;if(-Je*Fe<=ze&&ze<=Fe*(1+Je)){Te/=Fe;var Ee=Math.sqrt(Ge*Ge+Le*Le);return Ge/=Ee,Le/=Ee,ge[0]=Te,De.Set(Ge,Le),!0}}}return!1},_e.prototype.Extend=function(ge){this.ExtendForward(ge),this.ExtendBackward(ge)},_e.prototype.ExtendForward=function(ge){var De=this.p2.x-this.p1.x,ve=this.p2.y-this.p1.y,he=Math.min(0<De?(ge.upperBound.x-this.p1.x)/De:0>De?(ge.lowerBound.x-this.p1.x)/De:Number.POSITIVE_INFINITY,0<ve?(ge.upperBound.y-this.p1.y)/ve:0>ve?(ge.lowerBound.y-this.p1.y)/ve:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+De*he,this.p2.y=this.p1.y+ve*he},_e.prototype.ExtendBackward=function(ge){var De=-this.p2.x+this.p1.x,ve=-this.p2.y+this.p1.y,he=Math.min(0<De?(ge.upperBound.x-this.p2.x)/De:0>De?(ge.lowerBound.x-this.p2.x)/De:Number.POSITIVE_INFINITY,0<ve?(ge.upperBound.y-this.p2.y)/ve:0>ve?(ge.lowerBound.y-this.p2.y)/ve:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+De*he,this.p1.y=this.p2.y+ve*he},pe.b2SeparationFunction=function(){this.m_localPoint=new N,this.m_axis=new N},pe.prototype.Initialize=function(ge,De,ve,he,Be){this.m_proxyA=De,this.m_proxyB=he;var Ve=parseInt(ge.count);G.b2Assert(0<Ve&&3>Ve);var Me,we,Ie,Ge,Le,Je,Fe=0,Pe=0,Re=0,Te=0,ze=0,Ee=0,ke,Ne,je=0,Ue=0;if(1==Ve)this.m_type=pe.e_points,Me=this.m_proxyA.GetVertex(ge.indexA[0]),Ge=this.m_proxyB.GetVertex(ge.indexB[0]),Ne=Me,ke=ve.R,Fe=ve.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Pe=ve.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ne=Ge,ke=Be.R,Re=Be.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Te=Be.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),this.m_axis.x=Re-Fe,this.m_axis.y=Te-Pe,this.m_axis.Normalize();else if(ge.indexB[0]==ge.indexB[1])this.m_type=pe.e_faceA,we=this.m_proxyA.GetVertex(ge.indexA[0]),Ie=this.m_proxyA.GetVertex(ge.indexA[1]),Ge=this.m_proxyB.GetVertex(ge.indexB[0]),this.m_localPoint.x=0.5*(we.x+Ie.x),this.m_localPoint.y=0.5*(we.y+Ie.y),this.m_axis=F.CrossVF(F.SubtractVV(Ie,we),1),this.m_axis.Normalize(),Ne=this.m_axis,ke=ve.R,ze=ke.col1.x*Ne.x+ke.col2.x*Ne.y,Ee=ke.col1.y*Ne.x+ke.col2.y*Ne.y,Ne=this.m_localPoint,ke=ve.R,Fe=ve.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Pe=ve.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ne=Ge,ke=Be.R,Re=Be.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Te=Be.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),je=(Re-Fe)*ze+(Te-Pe)*Ee,0>je&&this.m_axis.NegativeSelf();else if(ge.indexA[0]==ge.indexA[0])this.m_type=pe.e_faceB,Le=this.m_proxyB.GetVertex(ge.indexB[0]),Je=this.m_proxyB.GetVertex(ge.indexB[1]),Me=this.m_proxyA.GetVertex(ge.indexA[0]),this.m_localPoint.x=0.5*(Le.x+Je.x),this.m_localPoint.y=0.5*(Le.y+Je.y),this.m_axis=F.CrossVF(F.SubtractVV(Je,Le),1),this.m_axis.Normalize(),Ne=this.m_axis,ke=Be.R,ze=ke.col1.x*Ne.x+ke.col2.x*Ne.y,Ee=ke.col1.y*Ne.x+ke.col2.y*Ne.y,Ne=this.m_localPoint,ke=Be.R,Re=Be.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Te=Be.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ne=Me,ke=ve.R,Fe=ve.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Pe=ve.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),je=(Fe-Re)*ze+(Pe-Te)*Ee,0>je&&this.m_axis.NegativeSelf();else{we=this.m_proxyA.GetVertex(ge.indexA[0]),Ie=this.m_proxyA.GetVertex(ge.indexA[1]),Le=this.m_proxyB.GetVertex(ge.indexB[0]),Je=this.m_proxyB.GetVertex(ge.indexB[1]);var qe=F.MulX(ve,Me),Ke=F.MulMV(ve.R,F.SubtractVV(Ie,we)),We=F.MulX(Be,Ge),Oe=F.MulMV(Be.R,F.SubtractVV(Je,Le)),Xe=Ke.x*Ke.x+Ke.y*Ke.y,Ze=Oe.x*Oe.x+Oe.y*Oe.y,He=F.SubtractVV(Oe,Ke),Ye=Ke.x*He.x+Ke.y*He.y,Qe=Oe.x*He.x+Oe.y*He.y,$e=Ke.x*Oe.x+Ke.y*Oe.y,eo=Xe*Ze-$e*$e;je=0,0!=eo&&(je=F.Clamp(($e*Qe-Ye*Ze)/eo,0,1));var oo=($e*je+Qe)/Ze;0>oo&&(oo=0,je=F.Clamp(($e-Ye)/Xe,0,1)),Me=new N,Me.x=we.x+je*(Ie.x-we.x),Me.y=we.y+je*(Ie.y-we.y),Ge=new N,Ge.x=Le.x+je*(Je.x-Le.x),Ge.y=Le.y+je*(Je.y-Le.y),0==je||1==je?(this.m_type=pe.e_faceB,this.m_axis=F.CrossVF(F.SubtractVV(Je,Le),1),this.m_axis.Normalize(),this.m_localPoint=Ge,Ne=this.m_axis,ke=Be.R,ze=ke.col1.x*Ne.x+ke.col2.x*Ne.y,Ee=ke.col1.y*Ne.x+ke.col2.y*Ne.y,Ne=this.m_localPoint,ke=Be.R,Re=Be.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Te=Be.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ne=Me,ke=ve.R,Fe=ve.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Pe=ve.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ue=(Fe-Re)*ze+(Pe-Te)*Ee,0>je&&this.m_axis.NegativeSelf()):(this.m_type=pe.e_faceA,this.m_axis=F.CrossVF(F.SubtractVV(Ie,we),1),this.m_localPoint=Me,Ne=this.m_axis,ke=ve.R,ze=ke.col1.x*Ne.x+ke.col2.x*Ne.y,Ee=ke.col1.y*Ne.x+ke.col2.y*Ne.y,Ne=this.m_localPoint,ke=ve.R,Fe=ve.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Pe=ve.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ne=Ge,ke=Be.R,Re=Be.position.x+(ke.col1.x*Ne.x+ke.col2.x*Ne.y),Te=Be.position.y+(ke.col1.y*Ne.x+ke.col2.y*Ne.y),Ue=(Re-Fe)*ze+(Te-Pe)*Ee,0>je&&this.m_axis.NegativeSelf())}},pe.prototype.Evaluate=function(ge,De){var ve,he,Be,Ve,Me,we,Ie=0,Ge;switch(this.m_type){case pe.e_points:return ve=F.MulTMV(ge.R,this.m_axis),he=F.MulTMV(De.R,this.m_axis.GetNegative()),Be=this.m_proxyA.GetSupportVertex(ve),Ve=this.m_proxyB.GetSupportVertex(he),Me=F.MulX(ge,Be),we=F.MulX(De,Ve),Ie=(we.x-Me.x)*this.m_axis.x+(we.y-Me.y)*this.m_axis.y,Ie;case pe.e_faceA:return Ge=F.MulMV(ge.R,this.m_axis),Me=F.MulX(ge,this.m_localPoint),he=F.MulTMV(De.R,Ge.GetNegative()),Ve=this.m_proxyB.GetSupportVertex(he),we=F.MulX(De,Ve),Ie=(we.x-Me.x)*Ge.x+(we.y-Me.y)*Ge.y,Ie;case pe.e_faceB:return Ge=F.MulMV(De.R,this.m_axis),we=F.MulX(De,this.m_localPoint),ve=F.MulTMV(ge.R,Ge.GetNegative()),Be=this.m_proxyA.GetSupportVertex(ve),Me=F.MulX(ge,Be),Ie=(Me.x-we.x)*Ge.x+(Me.y-we.y)*Ge.y,Ie;default:return G.b2Assert(!1),0;}},Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1,Box2D.Collision.b2SeparationFunction.e_faceA=2,Box2D.Collision.b2SeparationFunction.e_faceB=4}),ye.b2Simplex=function(){this.m_v1=new ue,this.m_v2=new ue,this.m_v3=new ue,this.m_vertices=new Vector(3)},ye.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},ye.prototype.ReadCache=function(ge,De,ve,he,Be){G.b2Assert(0<=ge.count&&3>=ge.count);var Ve,Me;this.m_count=ge.count;for(var we=this.m_vertices,Ie=0,Ge;Ie<this.m_count;Ie++)Ge=we[Ie],Ge.indexA=ge.indexA[Ie],Ge.indexB=ge.indexB[Ie],Ve=De.GetVertex(Ge.indexA),Me=he.GetVertex(Ge.indexB),Ge.wA=F.MulX(ve,Ve),Ge.wB=F.MulX(Be,Me),Ge.w=F.SubtractVV(Ge.wB,Ge.wA),Ge.a=0;if(1<this.m_count){var Le=ge.metric,Je=this.GetMetric();(Je<.5*Le||2*Le<Je||Je<Number.MIN_VALUE)&&(this.m_count=0)}0==this.m_count&&(Ge=we[0],Ge.indexA=0,Ge.indexB=0,Ve=De.GetVertex(0),Me=he.GetVertex(0),Ge.wA=F.MulX(ve,Ve),Ge.wB=F.MulX(Be,Me),Ge.w=F.SubtractVV(Ge.wB,Ge.wA),this.m_count=1)},ye.prototype.WriteCache=function(ge){ge.metric=this.GetMetric(),ge.count=Box2D.parseUInt(this.m_count);for(var De=this.m_vertices,ve=0;ve<this.m_count;ve++)ge.indexA[ve]=Box2D.parseUInt(De[ve].indexA),ge.indexB[ve]=Box2D.parseUInt(De[ve].indexB)},ye.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:{var ge=F.SubtractVV(this.m_v2.w,this.m_v1.w),De=F.CrossVV(ge,this.m_v1.w.GetNegative());return 0<De?F.CrossFV(1,ge):F.CrossVF(ge,1)}default:return G.b2Assert(!1),new N;}},ye.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return G.b2Assert(!1),new N;case 1:return this.m_v1.w;case 2:return new N(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return G.b2Assert(!1),new N;}},ye.prototype.GetWitnessPoints=function(ge,De){switch(this.m_count){case 0:G.b2Assert(!1);break;case 1:ge.SetV(this.m_v1.wA),De.SetV(this.m_v1.wB);break;case 2:ge.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,ge.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,De.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,De.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:De.x=ge.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,De.y=ge.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:G.b2Assert(!1);}},ye.prototype.GetMetric=function(){switch(this.m_count){case 0:return G.b2Assert(!1),0;case 1:return 0;case 2:return F.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return F.CrossVV(F.SubtractVV(this.m_v2.w,this.m_v1.w),F.SubtractVV(this.m_v3.w,this.m_v1.w));default:return G.b2Assert(!1),0;}},ye.prototype.Solve2=function(){var ge=this.m_v1.w,De=this.m_v2.w,ve=F.SubtractVV(De,ge),he=-(ge.x*ve.x+ge.y*ve.y);if(0>=he)return this.m_v1.a=1,void(this.m_count=1);var Be=De.x*ve.x+De.y*ve.y;if(0>=Be)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var Ve=1/(Be+he);this.m_v1.a=Be*Ve,this.m_v2.a=he*Ve,this.m_count=2},ye.prototype.Solve3=function(){var ge=this.m_v1.w,De=this.m_v2.w,ve=this.m_v3.w,he=F.SubtractVV(De,ge),Be=F.Dot(ge,he),Ve=F.Dot(De,he),Me=Ve,we=-Be,Ie=F.SubtractVV(ve,ge),Ge=F.Dot(ge,Ie),Le=F.Dot(ve,Ie),Je=Le,Fe=-Ge,Pe=F.SubtractVV(ve,De),Re=F.Dot(De,Pe),Te=F.Dot(ve,Pe),ze=Te,Ee=-Re,ke=F.CrossVV(he,Ie),Ne=ke*F.CrossVV(De,ve),je=ke*F.CrossVV(ve,ge),Ue=ke*F.CrossVV(ge,De);if(0>=we&&0>=Fe)return this.m_v1.a=1,void(this.m_count=1);if(0<Me&&0<we&&0>=Ue){var qe=1/(Me+we);return this.m_v1.a=Me*qe,this.m_v2.a=we*qe,void(this.m_count=2)}if(0<Je&&0<Fe&&0>=je){var Ke=1/(Je+Fe);return this.m_v1.a=Je*Ke,this.m_v3.a=Fe*Ke,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(0>=Me&&0>=Ee)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(0>=Je&&0>=ze)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(0<ze&&0<Ee&&0>=Ne){var We=1/(ze+Ee);return this.m_v2.a=ze*We,this.m_v3.a=Ee*We,this.m_count=2,void this.m_v1.Set(this.m_v3)}var Oe=1/(Ne+je+Ue);this.m_v1.a=Ne*Oe,this.m_v2.a=je*Oe,this.m_v3.a=Ue*Oe,this.m_count=3},xe.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3),this.indexB=new Vector_a2j_Number(3)},ue.b2SimplexVertex=function(){},ue.prototype.Set=function(ge){this.wA.SetV(ge.wA),this.wB.SetV(ge.wB),this.w.SetV(ge.w),this.a=ge.a,this.indexA=ge.indexA,this.indexB=ge.indexB},de.b2TimeOfImpact=function(){},de.TimeOfImpact=function(ge){++de.b2_toiCalls;var De=ge.proxyA,ve=ge.proxyB,he=ge.sweepA,Be=ge.sweepB;G.b2Assert(he.t0==Be.t0),G.b2Assert(1-he.t0>Number.MIN_VALUE);var Ve=De.m_radius+ve.m_radius,Me=ge.tolerance,we=0,Ge=0,Le=0;for(de.s_cache.count=0,de.s_distanceInput.useRadii=!1;;){if(he.GetTransform(de.s_xfA,we),Be.GetTransform(de.s_xfB,we),de.s_distanceInput.proxyA=De,de.s_distanceInput.proxyB=ve,de.s_distanceInput.transformA=de.s_xfA,de.s_distanceInput.transformB=de.s_xfB,Y.Distance(de.s_distanceOutput,de.s_cache,de.s_distanceInput),0>=de.s_distanceOutput.distance){we=1;break}de.s_fcn.Initialize(de.s_cache,De,de.s_xfA,ve,de.s_xfB);var Je=de.s_fcn.Evaluate(de.s_xfA,de.s_xfB);if(0>=Je){we=1;break}if(0==Ge&&(Je>Ve?Le=F.Max(Ve-Me,0.75*Ve):Le=F.Max(Je-Me,0.02*Ve)),Je-Le<0.5*Me){if(0==Ge){we=1;break}break}var Fe=we;{var Pe=we,Re=1,Te=Je;he.GetTransform(de.s_xfA,Re),Be.GetTransform(de.s_xfB,Re);var ze=de.s_fcn.Evaluate(de.s_xfA,de.s_xfB);if(ze>=Le){we=1;break}for(var Ee=0,ke;;){ke=0,ke=1&Ee?Pe+(Le-Te)*(Re-Pe)/(ze-Te):0.5*(Pe+Re),he.GetTransform(de.s_xfA,ke),Be.GetTransform(de.s_xfB,ke);var Ne=de.s_fcn.Evaluate(de.s_xfA,de.s_xfB);if(F.Abs(Ne-Le)<0.025*Me){Fe=ke;break}if(Ne>Le?(Pe=ke,Te=Ne):(Re=ke,ze=Ne),++Ee,++de.b2_toiRootIters,50==Ee)break}de.b2_toiMaxRootIters=F.Max(de.b2_toiMaxRootIters,Ee)}if(Fe<(1+100*Number.MIN_VALUE)*we)break;if(we=Fe,Ge++,++de.b2_toiIters,Ge==1e3)break}return de.b2_toiMaxIters=F.Max(de.b2_toiMaxIters,Ge),we},Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0,Box2D.Collision.b2TimeOfImpact.b2_toiIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0,Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0,Box2D.Collision.b2TimeOfImpact.s_cache=new xe,Box2D.Collision.b2TimeOfImpact.s_distanceInput=new Q,Box2D.Collision.b2TimeOfImpact.s_xfA=new E,Box2D.Collision.b2TimeOfImpact.s_xfB=new E,Box2D.Collision.b2TimeOfImpact.s_fcn=new pe,Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new $}),be.b2TOIInput=function(){this.proxyA=new ee,this.proxyB=new ee,this.sweepA=new R,this.sweepB=new R},Ce.b2WorldManifold=function(){this.m_normal=new N},Ce.prototype.b2WorldManifold=function(){this.m_points=new Vector(G.b2_maxManifoldPoints);for(var ge=0;ge<G.b2_maxManifoldPoints;ge++)this.m_points[ge]=new N},Ce.prototype.Initialize=function(ge,De,ve,he,Be){if(void 0===ve&&(ve=0),void 0===Be&&(Be=0),0!=ge.m_pointCount){var Ve=0,Ie=0,Ge=0,Le=0,Je=0,Fe=0,Pe=0,Me,we;switch(ge.m_type){case me.e_circles:{we=De.R,Me=ge.m_localPoint;var Re=De.position.x+we.col1.x*Me.x+we.col2.x*Me.y,Te=De.position.y+we.col1.y*Me.x+we.col2.y*Me.y;we=he.R,Me=ge.m_points[0].m_localPoint;var ze=he.position.x+we.col1.x*Me.x+we.col2.x*Me.y,Ee=he.position.y+we.col1.y*Me.x+we.col2.y*Me.y,ke=ze-Re,Ne=Ee-Te,je=ke*ke+Ne*Ne;if(je>Number.MIN_VALUE*Number.MIN_VALUE){var Ue=Math.sqrt(je);this.m_normal.x=ke/Ue,this.m_normal.y=Ne/Ue}else this.m_normal.x=1,this.m_normal.y=0;var qe=Re+ve*this.m_normal.x,Ke=Te+ve*this.m_normal.y,We=ze-Be*this.m_normal.x,Oe=Ee-Be*this.m_normal.y;this.m_points[0].x=0.5*(qe+We),this.m_points[0].y=0.5*(Ke+Oe)}break;case me.e_faceA:for(we=De.R,Me=ge.m_localPlaneNormal,Ie=we.col1.x*Me.x+we.col2.x*Me.y,Ge=we.col1.y*Me.x+we.col2.y*Me.y,we=De.R,Me=ge.m_localPoint,Le=De.position.x+we.col1.x*Me.x+we.col2.x*Me.y,Je=De.position.y+we.col1.y*Me.x+we.col2.y*Me.y,this.m_normal.x=Ie,this.m_normal.y=Ge,Ve=0;Ve<ge.m_pointCount;Ve++)we=he.R,Me=ge.m_points[Ve].m_localPoint,Fe=he.position.x+we.col1.x*Me.x+we.col2.x*Me.y,Pe=he.position.y+we.col1.y*Me.x+we.col2.y*Me.y,this.m_points[Ve].x=Fe+0.5*(ve-(Fe-Le)*Ie-(Pe-Je)*Ge-Be)*Ie,this.m_points[Ve].y=Pe+0.5*(ve-(Fe-Le)*Ie-(Pe-Je)*Ge-Be)*Ge;break;case me.e_faceB:for(we=he.R,Me=ge.m_localPlaneNormal,Ie=we.col1.x*Me.x+we.col2.x*Me.y,Ge=we.col1.y*Me.x+we.col2.y*Me.y,we=he.R,Me=ge.m_localPoint,Le=he.position.x+we.col1.x*Me.x+we.col2.x*Me.y,Je=he.position.y+we.col1.y*Me.x+we.col2.y*Me.y,this.m_normal.x=-Ie,this.m_normal.y=-Ge,Ve=0;Ve<ge.m_pointCount;Ve++)we=De.R,Me=ge.m_points[Ve].m_localPoint,Fe=De.position.x+we.col1.x*Me.x+we.col2.x*Me.y,Pe=De.position.y+we.col1.y*Me.x+we.col2.y*Me.y,this.m_points[Ve].x=Fe+0.5*(Be-(Fe-Le)*Ie-(Pe-Je)*Ge-ve)*Ie,this.m_points[Ve].y=Pe+0.5*(Be-(Fe-Le)*Ie-(Pe-Je)*Ge-ve)*Ge;}}},fe.ClipVertex=function(){this.v=new N,this.id=new Z},fe.prototype.Set=function(ge){this.v.SetV(ge.v),this.id.Set(ge.id)},Ae.Features=function(){},Object.defineProperty(Ae.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function get(){return this._referenceEdge}}),Object.defineProperty(Ae.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function set(ge){ge===void 0&&(ge=0),this._referenceEdge=ge,this._m_id._key=4294967040&this._m_id._key|255&this._referenceEdge}}),Object.defineProperty(Ae.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function get(){return this._incidentEdge}}),Object.defineProperty(Ae.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function set(ge){ge===void 0&&(ge=0),this._incidentEdge=ge,this._m_id._key=4294902015&this._m_id._key|65280&this._incidentEdge<<8}}),Object.defineProperty(Ae.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function get(){return this._incidentVertex}}),Object.defineProperty(Ae.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function set(ge){ge===void 0&&(ge=0),this._incidentVertex=ge,this._m_id._key=4278255615&this._m_id._key|16711680&this._incidentVertex<<16}}),Object.defineProperty(Ae.prototype,"flip",{enumerable:!1,configurable:!0,get:function get(){return this._flip}}),Object.defineProperty(Ae.prototype,"flip",{enumerable:!1,configurable:!0,set:function set(ge){ge===void 0&&(ge=0),this._flip=ge,this._m_id._key=16777215&this._m_id._key|4278190080&this._flip<<24}})}(),function(){var o=Box2D.Common.b2Color,n=Box2D.Common.b2internal,_=Box2D.Common.b2Settings,S=Box2D.Collision.Shapes.b2CircleShape,g=Box2D.Collision.Shapes.b2EdgeChainDef,V=Box2D.Collision.Shapes.b2EdgeShape,M=Box2D.Collision.Shapes.b2MassData,w=Box2D.Collision.Shapes.b2PolygonShape,G=Box2D.Collision.Shapes.b2Shape,L=Box2D.Common.Math.b2Mat22,J=Box2D.Common.Math.b2Mat33,F=Box2D.Common.Math.b2Math,R=Box2D.Common.Math.b2Sweep,E=Box2D.Common.Math.b2Transform,N=Box2D.Common.Math.b2Vec2,U=Box2D.Common.Math.b2Vec3,q=Box2D.Dynamics.b2Body,W=Box2D.Dynamics.b2BodyDef,O=Box2D.Dynamics.b2ContactFilter,X=Box2D.Dynamics.b2ContactImpulse,Z=Box2D.Dynamics.b2ContactListener,H=Box2D.Dynamics.b2ContactManager,Y=Box2D.Dynamics.b2DebugDraw,Q=Box2D.Dynamics.b2DestructionListener,$=Box2D.Dynamics.b2FilterData,ee=Box2D.Dynamics.b2Fixture,oe=Box2D.Dynamics.b2FixtureDef,te=Box2D.Dynamics.b2Island,ne=Box2D.Dynamics.b2TimeStep,ie=Box2D.Dynamics.b2World,me=Box2D.Collision.b2AABB,ae=Box2D.Collision.b2Bound,le=Box2D.Collision.b2BoundValues,re=Box2D.Collision.b2Collision,se=Box2D.Collision.b2ContactID,_e=Box2D.Collision.b2ContactPoint,pe=Box2D.Collision.b2Distance,ye=Box2D.Collision.b2DistanceInput,xe=Box2D.Collision.b2DistanceOutput,ue=Box2D.Collision.b2DistanceProxy,de=Box2D.Collision.b2DynamicTree,be=Box2D.Collision.b2DynamicTreeBroadPhase,Ce=Box2D.Collision.b2DynamicTreeNode,fe=Box2D.Collision.b2DynamicTreePair,Ae=Box2D.Collision.b2Manifold,Se=Box2D.Collision.b2ManifoldPoint,ge=Box2D.Collision.b2Point,De=Box2D.Collision.b2RayCastInput,ve=Box2D.Collision.b2RayCastOutput,he=Box2D.Collision.b2Segment,Be=Box2D.Collision.b2SeparationFunction,Ve=Box2D.Collision.b2Simplex,Me=Box2D.Collision.b2SimplexCache,we=Box2D.Collision.b2SimplexVertex,Ie=Box2D.Collision.b2TimeOfImpact,Ge=Box2D.Collision.b2TOIInput,Le=Box2D.Collision.b2WorldManifold,Je=Box2D.Collision.ClipVertex,Fe=Box2D.Collision.Features,Pe=Box2D.Collision.IBroadPhase;Box2D.inherit(S,Box2D.Collision.Shapes.b2Shape),S.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,S.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.m_p=new N},S.prototype.Copy=function(){var Re=new S;return Re.Set(this),Re},S.prototype.Set=function(Re){if(this.__super.Set.call(this,Re),Box2D.is(Re,S)){var Te=Re instanceof S?Re:null;this.m_p.SetV(Te.m_p)}},S.prototype.TestPoint=function(Re,Te){var ze=Re.R,Ee=Re.position.x+(ze.col1.x*this.m_p.x+ze.col2.x*this.m_p.y),ke=Re.position.y+(ze.col1.y*this.m_p.x+ze.col2.y*this.m_p.y);return Ee=Te.x-Ee,ke=Te.y-ke,Ee*Ee+ke*ke<=this.m_radius*this.m_radius},S.prototype.RayCast=function(Re,Te,ze){var Ee=ze.R,ke=ze.position.x+(Ee.col1.x*this.m_p.x+Ee.col2.x*this.m_p.y),Ne=ze.position.y+(Ee.col1.y*this.m_p.x+Ee.col2.y*this.m_p.y),je=Te.p1.x-ke,Ue=Te.p1.y-Ne,qe=je*je+Ue*Ue-this.m_radius*this.m_radius,Ke=Te.p2.x-Te.p1.x,We=Te.p2.y-Te.p1.y,Oe=je*Ke+Ue*We,Xe=Ke*Ke+We*We,Ze=Oe*Oe-Xe*qe;if(0>Ze||Xe<Number.MIN_VALUE)return!1;var He=-(Oe+Math.sqrt(Ze));return 0<=He&&He<=Te.maxFraction*Xe&&(He/=Xe,Re.fraction=He,Re.normal.x=je+He*Ke,Re.normal.y=Ue+He*We,Re.normal.Normalize(),!0)},S.prototype.ComputeAABB=function(Re,Te){var ze=Te.R,Ee=Te.position.x+(ze.col1.x*this.m_p.x+ze.col2.x*this.m_p.y),ke=Te.position.y+(ze.col1.y*this.m_p.x+ze.col2.y*this.m_p.y);Re.lowerBound.Set(Ee-this.m_radius,ke-this.m_radius),Re.upperBound.Set(Ee+this.m_radius,ke+this.m_radius)},S.prototype.ComputeMass=function(Re,Te){Te===void 0&&(Te=0),Re.mass=Te*_.b2_pi*this.m_radius*this.m_radius,Re.center.SetV(this.m_p),Re.I=Re.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},S.prototype.ComputeSubmergedArea=function(Re,Te,ze,Ee){void 0===Te&&(Te=0);var ke=F.MulX(ze,this.m_p),Ne=-(F.Dot(Re,ke)-Te);if(Ne<-this.m_radius+Number.MIN_VALUE)return 0;if(Ne>this.m_radius)return Ee.SetV(ke),Math.PI*this.m_radius*this.m_radius;var je=this.m_radius*this.m_radius,Ue=Ne*Ne,qe=je*(Math.asin(Ne/this.m_radius)+Math.PI/2)+Ne*Math.sqrt(je-Ue),Ke=-2/3*Math.pow(je-Ue,1.5)/qe;return Ee.x=ke.x+Re.x*Ke,Ee.y=ke.y+Re.y*Ke,qe},S.prototype.GetLocalPosition=function(){return this.m_p},S.prototype.SetLocalPosition=function(Re){this.m_p.SetV(Re)},S.prototype.GetRadius=function(){return this.m_radius},S.prototype.SetRadius=function(Re){Re===void 0&&(Re=0),this.m_radius=Re},S.prototype.b2CircleShape=function(Re){Re===void 0&&(Re=0),this.__super.b2Shape.call(this),this.m_type=G.e_circleShape,this.m_radius=Re},g.b2EdgeChainDef=function(){},g.prototype.b2EdgeChainDef=function(){this.vertexCount=0,this.isALoop=!0,this.vertices=[]},Box2D.inherit(V,Box2D.Collision.Shapes.b2Shape),V.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,V.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments),this.s_supportVec=new N,this.m_v1=new N,this.m_v2=new N,this.m_coreV1=new N,this.m_coreV2=new N,this.m_normal=new N,this.m_direction=new N,this.m_cornerDir1=new N,this.m_cornerDir2=new N},V.prototype.TestPoint=function(){return!1},V.prototype.RayCast=function(Re,Te,ze){var Ee,ke=Te.p2.x-Te.p1.x,Ne=Te.p2.y-Te.p1.y;Ee=ze.R;var je=ze.position.x+(Ee.col1.x*this.m_v1.x+Ee.col2.x*this.m_v1.y),Ue=ze.position.y+(Ee.col1.y*this.m_v1.x+Ee.col2.y*this.m_v1.y),qe=ze.position.y+(Ee.col1.y*this.m_v2.x+Ee.col2.y*this.m_v2.y)-Ue,Ke=-(ze.position.x+(Ee.col1.x*this.m_v2.x+Ee.col2.x*this.m_v2.y)-je),We=100*Number.MIN_VALUE,Oe=-(ke*qe+Ne*Ke);if(Oe>We){var Xe=Te.p1.x-je,Ze=Te.p1.y-Ue,He=Xe*qe+Ze*Ke;if(0<=He&&He<=Te.maxFraction*Oe){var Ye=-ke*Ze+Ne*Xe;if(-We*Oe<=Ye&&Ye<=Oe*(1+We)){He/=Oe,Re.fraction=He;var Qe=Math.sqrt(qe*qe+Ke*Ke);return Re.normal.x=qe/Qe,Re.normal.y=Ke/Qe,!0}}}return!1},V.prototype.ComputeAABB=function(Re,Te){var ze=Te.R,Ee=Te.position.x+(ze.col1.x*this.m_v1.x+ze.col2.x*this.m_v1.y),ke=Te.position.y+(ze.col1.y*this.m_v1.x+ze.col2.y*this.m_v1.y),Ne=Te.position.x+(ze.col1.x*this.m_v2.x+ze.col2.x*this.m_v2.y),je=Te.position.y+(ze.col1.y*this.m_v2.x+ze.col2.y*this.m_v2.y);Ee<Ne?(Re.lowerBound.x=Ee,Re.upperBound.x=Ne):(Re.lowerBound.x=Ne,Re.upperBound.x=Ee),ke<je?(Re.lowerBound.y=ke,Re.upperBound.y=je):(Re.lowerBound.y=je,Re.upperBound.y=ke)},V.prototype.ComputeMass=function(Re,Te){Te===void 0&&(Te=0),Re.mass=0,Re.center.SetV(this.m_v1),Re.I=0},V.prototype.ComputeSubmergedArea=function(Re,Te,ze,Ee){void 0===Te&&(Te=0);var ke=new N(Re.x*Te,Re.y*Te),Ne=F.MulX(ze,this.m_v1),je=F.MulX(ze,this.m_v2),Ue=F.Dot(Re,Ne)-Te,qe=F.Dot(Re,je)-Te;if(0<Ue){if(0<qe)return 0;Ne.x=-qe/(Ue-qe)*Ne.x+Ue/(Ue-qe)*je.x,Ne.y=-qe/(Ue-qe)*Ne.y+Ue/(Ue-qe)*je.y}else 0<qe&&(je.x=-qe/(Ue-qe)*Ne.x+Ue/(Ue-qe)*je.x,je.y=-qe/(Ue-qe)*Ne.y+Ue/(Ue-qe)*je.y);return Ee.x=(ke.x+Ne.x+je.x)/3,Ee.y=(ke.y+Ne.y+je.y)/3,0.5*((Ne.x-ke.x)*(je.y-ke.y)-(Ne.y-ke.y)*(je.x-ke.x))},V.prototype.GetLength=function(){return this.m_length},V.prototype.GetVertex1=function(){return this.m_v1},V.prototype.GetVertex2=function(){return this.m_v2},V.prototype.GetCoreVertex1=function(){return this.m_coreV1},V.prototype.GetCoreVertex2=function(){return this.m_coreV2},V.prototype.GetNormalVector=function(){return this.m_normal},V.prototype.GetDirectionVector=function(){return this.m_direction},V.prototype.GetCorner1Vector=function(){return this.m_cornerDir1},V.prototype.GetCorner2Vector=function(){return this.m_cornerDir2},V.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1},V.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2},V.prototype.GetFirstVertex=function(Re){var Te=Re.R;return new N(Re.position.x+(Te.col1.x*this.m_coreV1.x+Te.col2.x*this.m_coreV1.y),Re.position.y+(Te.col1.y*this.m_coreV1.x+Te.col2.y*this.m_coreV1.y))},V.prototype.GetNextEdge=function(){return this.m_nextEdge},V.prototype.GetPrevEdge=function(){return this.m_prevEdge},V.prototype.Support=function(Re,Te,ze){void 0===Te&&(Te=0),void 0===ze&&(ze=0);var Ee=Re.R,ke=Re.position.x+(Ee.col1.x*this.m_coreV1.x+Ee.col2.x*this.m_coreV1.y),Ne=Re.position.y+(Ee.col1.y*this.m_coreV1.x+Ee.col2.y*this.m_coreV1.y),je=Re.position.x+(Ee.col1.x*this.m_coreV2.x+Ee.col2.x*this.m_coreV2.y),Ue=Re.position.y+(Ee.col1.y*this.m_coreV2.x+Ee.col2.y*this.m_coreV2.y);return ke*Te+Ne*ze>je*Te+Ue*ze?(this.s_supportVec.x=ke,this.s_supportVec.y=Ne):(this.s_supportVec.x=je,this.s_supportVec.y=Ue),this.s_supportVec},V.prototype.b2EdgeShape=function(Re,Te){this.__super.b2Shape.call(this),this.m_type=G.e_edgeShape,this.m_prevEdge=null,this.m_nextEdge=null,this.m_v1=Re,this.m_v2=Te,this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y),this.m_length=this.m_direction.Normalize(),this.m_normal.Set(this.m_direction.y,-this.m_direction.x),this.m_coreV1.Set(-_.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-_.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y),this.m_coreV2.Set(-_.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-_.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y),this.m_cornerDir1=this.m_normal,this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)},V.prototype.SetPrevEdge=function(Re,Te,ze,Ee){this.m_prevEdge=Re,this.m_coreV1=Te,this.m_cornerDir1=ze,this.m_cornerConvex1=Ee},V.prototype.SetNextEdge=function(Re,Te,ze,Ee){this.m_nextEdge=Re,this.m_coreV2=Te,this.m_cornerDir2=ze,this.m_cornerConvex2=Ee},M.b2MassData=function(){this.mass=0,this.center=new N(0,0),this.I=0},Box2D.inherit(w,Box2D.Collision.Shapes.b2Shape),w.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype,w.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)},w.prototype.Copy=function(){var Re=new w;return Re.Set(this),Re},w.prototype.Set=function(Re){if(this.__super.Set.call(this,Re),Box2D.is(Re,w)){var Te=Re instanceof w?Re:null;this.m_centroid.SetV(Te.m_centroid),this.m_vertexCount=Te.m_vertexCount,this.Reserve(this.m_vertexCount);for(var ze=0;ze<this.m_vertexCount;ze++)this.m_vertices[ze].SetV(Te.m_vertices[ze]),this.m_normals[ze].SetV(Te.m_normals[ze])}},w.prototype.SetAsArray=function(Re,Te){Te===void 0&&(Te=0);var ze=new Vector,Ee=0,ke;for(Ee=0;Ee<Re.length;++Ee)ke=Re[Ee],ze.push(ke);this.SetAsVector(ze,Te)},w.AsArray=function(Re,Te){void 0===Te&&(Te=0);var ze=new w;return ze.SetAsArray(Re,Te),ze},w.prototype.SetAsVector=function(Re,Te){Te===void 0&&(Te=0),0==Te&&(Te=Re.length),_.b2Assert(2<=Te),this.m_vertexCount=Te,this.Reserve(Te);var ze=0;for(ze=0;ze<this.m_vertexCount;ze++)this.m_vertices[ze].SetV(Re[ze]);for(ze=0;ze<this.m_vertexCount;++ze){var Ee=parseInt(ze),ke=parseInt(ze+1<this.m_vertexCount?ze+1:0),Ne=F.SubtractVV(this.m_vertices[ke],this.m_vertices[Ee]);_.b2Assert(Ne.LengthSquared()>Number.MIN_VALUE),this.m_normals[ze].SetV(F.CrossVF(Ne,1)),this.m_normals[ze].Normalize()}this.m_centroid=w.ComputeCentroid(this.m_vertices,this.m_vertexCount)},w.AsVector=function(Re,Te){void 0===Te&&(Te=0);var ze=new w;return ze.SetAsVector(Re,Te),ze},w.prototype.SetAsBox=function(Re,Te){Re===void 0&&(Re=0),Te===void 0&&(Te=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-Re,-Te),this.m_vertices[1].Set(Re,-Te),this.m_vertices[2].Set(Re,Te),this.m_vertices[3].Set(-Re,Te),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},w.AsBox=function(Re,Te){void 0===Re&&(Re=0),void 0===Te&&(Te=0);var ze=new w;return ze.SetAsBox(Re,Te),ze},w.prototype.SetAsOrientedBox=function(Re,Te,ze,Ee){Re===void 0&&(Re=0),Te===void 0&&(Te=0),ze===void 0&&(ze=null),Ee===void 0&&(Ee=0),this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-Re,-Te),this.m_vertices[1].Set(Re,-Te),this.m_vertices[2].Set(Re,Te),this.m_vertices[3].Set(-Re,Te),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=ze;var ke=new E;ke.position=ze,ke.R.Set(Ee);for(var Ne=0;Ne<this.m_vertexCount;++Ne)this.m_vertices[Ne]=F.MulX(ke,this.m_vertices[Ne]),this.m_normals[Ne]=F.MulMV(ke.R,this.m_normals[Ne])},w.AsOrientedBox=function(Re,Te,ze,Ee){void 0===Re&&(Re=0),void 0===Te&&(Te=0),void 0===ze&&(ze=null),void 0===Ee&&(Ee=0);var ke=new w;return ke.SetAsOrientedBox(Re,Te,ze,Ee),ke},w.prototype.SetAsEdge=function(Re,Te){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(Re),this.m_vertices[1].SetV(Te),this.m_centroid.x=0.5*(Re.x+Te.x),this.m_centroid.y=0.5*(Re.y+Te.y),this.m_normals[0]=F.CrossVF(F.SubtractVV(Te,Re),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},w.AsEdge=function(Re,Te){var ze=new w;return ze.SetAsEdge(Re,Te),ze},w.prototype.TestPoint=function(Re,Te){for(var Ee=Re.R,ke=Te.x-Re.position.x,Ne=Te.y-Re.position.y,je=ke*Ee.col1.x+Ne*Ee.col1.y,Ue=ke*Ee.col2.x+Ne*Ee.col2.y,qe=0,ze;qe<this.m_vertexCount;++qe){ze=this.m_vertices[qe],ke=je-ze.x,Ne=Ue-ze.y,ze=this.m_normals[qe];var Ke=ze.x*ke+ze.y*Ne;if(0<Ke)return!1}return!0},w.prototype.RayCast=function(Re,Te,ze){var Ee=0,ke=Te.maxFraction,Ne=0,je=0,Ue,qe;Ne=Te.p1.x-ze.position.x,je=Te.p1.y-ze.position.y,Ue=ze.R;var Ke=Ne*Ue.col1.x+je*Ue.col1.y,We=Ne*Ue.col2.x+je*Ue.col2.y;Ne=Te.p2.x-ze.position.x,je=Te.p2.y-ze.position.y,Ue=ze.R;for(var Oe=Ne*Ue.col1.x+je*Ue.col1.y,Xe=Ne*Ue.col2.x+je*Ue.col2.y,Ye=parseInt(-1),Qe=0;Qe<this.m_vertexCount;++Qe){qe=this.m_vertices[Qe],Ne=qe.x-Ke,je=qe.y-We,qe=this.m_normals[Qe];var $e=qe.x*Ne+qe.y*je,eo=qe.x*(Oe-Ke)+qe.y*(Xe-We);if(!(0==eo))0>eo&&$e<Ee*eo?(Ee=$e/eo,Ye=Qe):0<eo&&$e<ke*eo&&(ke=$e/eo);else if(0>$e)return!1;if(ke<Ee-Number.MIN_VALUE)return!1}return!!(0<=Ye)&&(Re.fraction=Ee,Ue=ze.R,qe=this.m_normals[Ye],Re.normal.x=Ue.col1.x*qe.x+Ue.col2.x*qe.y,Re.normal.y=Ue.col1.y*qe.x+Ue.col2.y*qe.y,!0)},w.prototype.ComputeAABB=function(Re,Te){for(var ze=Te.R,Ee=this.m_vertices[0],ke=Te.position.x+(ze.col1.x*Ee.x+ze.col2.x*Ee.y),Ne=Te.position.y+(ze.col1.y*Ee.x+ze.col2.y*Ee.y),je=ke,Ue=Ne,qe=1;qe<this.m_vertexCount;++qe){Ee=this.m_vertices[qe];var Ke=Te.position.x+(ze.col1.x*Ee.x+ze.col2.x*Ee.y),We=Te.position.y+(ze.col1.y*Ee.x+ze.col2.y*Ee.y);ke=ke<Ke?ke:Ke,Ne=Ne<We?Ne:We,je=je>Ke?je:Ke,Ue=Ue>We?Ue:We}Re.lowerBound.x=ke-this.m_radius,Re.lowerBound.y=Ne-this.m_radius,Re.upperBound.x=je+this.m_radius,Re.upperBound.y=Ue+this.m_radius},w.prototype.ComputeMass=function(Re,Te){if(void 0===Te&&(Te=0),2==this.m_vertexCount)return Re.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),Re.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y),Re.mass=0,void(Re.I=0);for(var ze=0,Ee=0,ke=0,Ne=0,je=0,Ue=0,qe=1/3,Ke=0;Ke<this.m_vertexCount;++Ke){var We=this.m_vertices[Ke],Oe=Ke+1<this.m_vertexCount?this.m_vertices[parseInt(Ke+1)]:this.m_vertices[0],Xe=We.x-je,Ze=We.y-Ue,He=Oe.x-je,Ye=Oe.y-Ue,Qe=Xe*Ye-Ze*He,$e=0.5*Qe;ke+=$e,ze+=$e*qe*(je+We.x+Oe.x),Ee+=$e*qe*(Ue+We.y+Oe.y);var eo=je,oo=Ue,to=Xe,no=Ze,io=He,mo=Ye;Ne+=Qe*(qe*(0.25*(to*to+io*to+io*io)+(eo*to+eo*io))+0.5*eo*eo+(qe*(0.25*(no*no+mo*no+mo*mo)+(oo*no+oo*mo))+0.5*oo*oo))}Re.mass=Te*ke,ze*=1/ke,Ee*=1/ke,Re.center.Set(ze,Ee),Re.I=Te*Ne},w.prototype.ComputeSubmergedArea=function(Re,Te,ze,Ee){void 0===Te&&(Te=0);var ke=F.MulTMV(ze.R,Re),Ne=Te-F.Dot(Re,ze.position),je=new Vector_a2j_Number,Ue=0,qe=parseInt(-1),Ke=parseInt(-1),We=!1,Oe=0;for(Oe=0;Oe<this.m_vertexCount;++Oe){je[Oe]=F.Dot(ke,this.m_vertices[Oe])-Ne;var Xe=je[Oe]<-Number.MIN_VALUE;0<Oe&&(Xe?!We&&(qe=Oe-1,Ue++):We&&(Ke=Oe-1,Ue++)),We=Xe}switch(Ue){case 0:if(We){var Ze=new M;return this.ComputeMass(Ze,1),Ee.SetV(F.MulX(ze,Ze.center)),Ze.mass}return 0;break;case 1:-1==qe?qe=this.m_vertexCount-1:Ke=this.m_vertexCount-1;}var He=parseInt((qe+1)%this.m_vertexCount),Ye=parseInt((Ke+1)%this.m_vertexCount),Qe=(0-je[qe])/(je[He]-je[qe]),$e=(0-je[Ke])/(je[Ye]-je[Ke]),eo=new N(this.m_vertices[qe].x*(1-Qe)+this.m_vertices[He].x*Qe,this.m_vertices[qe].y*(1-Qe)+this.m_vertices[He].y*Qe),oo=new N(this.m_vertices[Ke].x*(1-$e)+this.m_vertices[Ye].x*$e,this.m_vertices[Ke].y*(1-$e)+this.m_vertices[Ye].y*$e),to=0,no=new N,io=this.m_vertices[He],mo;for(Oe=He;Oe!=Ye;){Oe=(Oe+1)%this.m_vertexCount,mo=Oe==Ye?oo:this.m_vertices[Oe];var ao=0.5*((io.x-eo.x)*(mo.y-eo.y)-(io.y-eo.y)*(mo.x-eo.x));to+=ao,no.x+=ao*(eo.x+io.x+mo.x)/3,no.y+=ao*(eo.y+io.y+mo.y)/3,io=mo}return no.Multiply(1/to),Ee.SetV(F.MulX(ze,no)),to},w.prototype.GetVertexCount=function(){return this.m_vertexCount},w.prototype.GetVertices=function(){return this.m_vertices},w.prototype.GetNormals=function(){return this.m_normals},w.prototype.GetSupport=function(Re){for(var Te=0,ze=this.m_vertices[0].x*Re.x+this.m_vertices[0].y*Re.y,Ee=1,ke;Ee<this.m_vertexCount;++Ee)ke=this.m_vertices[Ee].x*Re.x+this.m_vertices[Ee].y*Re.y,ke>ze&&(Te=Ee,ze=ke);return Te},w.prototype.GetSupportVertex=function(Re){for(var Te=0,ze=this.m_vertices[0].x*Re.x+this.m_vertices[0].y*Re.y,Ee=1,ke;Ee<this.m_vertexCount;++Ee)ke=this.m_vertices[Ee].x*Re.x+this.m_vertices[Ee].y*Re.y,ke>ze&&(Te=Ee,ze=ke);return this.m_vertices[Te]},w.prototype.Validate=function(){return!1},w.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this),this.m_type=G.e_polygonShape,this.m_centroid=new N,this.m_vertices=new Vector,this.m_normals=new Vector},w.prototype.Reserve=function(Re){Re===void 0&&(Re=0);for(var Te=parseInt(this.m_vertices.length);Te<Re;Te++)this.m_vertices[Te]=new N,this.m_normals[Te]=new N},w.ComputeCentroid=function(Re,Te){void 0===Te&&(Te=0);for(var ze=new N,Ee=0,ke=0,Ne=0,je=1/3,Ue=0;Ue<Te;++Ue){var qe=Re[Ue],Ke=Ue+1<Te?Re[parseInt(Ue+1)]:Re[0],We=qe.x-ke,Oe=qe.y-Ne,Xe=Ke.x-ke,Ze=Ke.y-Ne,Ye=0.5*(We*Ze-Oe*Xe);Ee+=Ye,ze.x+=Ye*je*(ke+qe.x+Ke.x),ze.y+=Ye*je*(Ne+qe.y+Ke.y)}return ze.x*=1/Ee,ze.y*=1/Ee,ze},w.ComputeOBB=function(Re,Te,ze){ze===void 0&&(ze=0);var Ee=0,ke=new Vector(ze+1);for(Ee=0;Ee<ze;++Ee)ke[Ee]=Te[Ee];ke[ze]=ke[0];var Ne=Number.MAX_VALUE;for(Ee=1;Ee<=ze;++Ee){var je=ke[parseInt(Ee-1)],Ue=ke[Ee].x-je.x,qe=ke[Ee].y-je.y,Ke=Math.sqrt(Ue*Ue+qe*qe);Ue/=Ke,qe/=Ke;for(var We=-qe,Oe=Ue,Xe=Number.MAX_VALUE,Ze=Number.MAX_VALUE,He=-Number.MAX_VALUE,Ye=-Number.MAX_VALUE,Qe=0;Qe<ze;++Qe){var $e=ke[Qe].x-je.x,eo=ke[Qe].y-je.y,oo=Ue*$e+qe*eo,to=We*$e+Oe*eo;oo<Xe&&(Xe=oo),to<Ze&&(Ze=to),oo>He&&(He=oo),to>Ye&&(Ye=to)}var no=(He-Xe)*(Ye-Ze);if(no<0.95*Ne){Ne=no,Re.R.col1.x=Ue,Re.R.col1.y=qe,Re.R.col2.x=We,Re.R.col2.y=Oe;var io=0.5*(Xe+He),mo=0.5*(Ze+Ye),ao=Re.R;Re.center.x=je.x+(ao.col1.x*io+ao.col2.x*mo),Re.center.y=je.y+(ao.col1.y*io+ao.col2.y*mo),Re.extents.x=0.5*(He-Xe),Re.extents.y=0.5*(Ye-Ze)}}},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new L}),G.b2Shape=function(){},G.prototype.Copy=function(){return null},G.prototype.Set=function(Re){this.m_radius=Re.m_radius},G.prototype.GetType=function(){return this.m_type},G.prototype.TestPoint=function(){return!1},G.prototype.RayCast=function(){return!1},G.prototype.ComputeAABB=function(){},G.prototype.ComputeMass=function(Re,Te){Te===void 0&&(Te=0)},G.prototype.ComputeSubmergedArea=function(Re,Te){return void 0===Te&&(Te=0),0},G.TestOverlap=function(Re,Te,ze,Ee){var ke=new ye;ke.proxyA=new ue,ke.proxyA.Set(Re),ke.proxyB=new ue,ke.proxyB.Set(ze),ke.transformA=Te,ke.transformB=Ee,ke.useRadii=!0;var Ne=new Me;Ne.count=0;var je=new xe;return pe.Distance(je,Ne,ke),je.distance<10*Number.MIN_VALUE},G.prototype.b2Shape=function(){this.m_type=G.e_unknownShape,this.m_radius=_.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1),Box2D.Collision.Shapes.b2Shape.e_circleShape=0,Box2D.Collision.Shapes.b2Shape.e_polygonShape=1,Box2D.Collision.Shapes.b2Shape.e_edgeShape=2,Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3,Box2D.Collision.Shapes.b2Shape.e_hitCollide=1,Box2D.Collision.Shapes.b2Shape.e_missCollide=0,Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})}(),function(){var o=Box2D.Common.b2Color,n=Box2D.Common.b2internal,_=Box2D.Common.b2Settings,S=Box2D.Common.Math.b2Mat22,g=Box2D.Common.Math.b2Mat33,V=Box2D.Common.Math.b2Math,M=Box2D.Common.Math.b2Sweep,w=Box2D.Common.Math.b2Transform,G=Box2D.Common.Math.b2Vec2,L=Box2D.Common.Math.b2Vec3;o.b2Color=function(){this._r=0,this._g=0,this._b=0},o.prototype.b2Color=function(J,F,R){J===void 0&&(J=0),F===void 0&&(F=0),R===void 0&&(R=0),this._r=Box2D.parseUInt(255*V.Clamp(J,0,1)),this._g=Box2D.parseUInt(255*V.Clamp(F,0,1)),this._b=Box2D.parseUInt(255*V.Clamp(R,0,1))},o.prototype.Set=function(J,F,R){J===void 0&&(J=0),F===void 0&&(F=0),R===void 0&&(R=0),this._r=Box2D.parseUInt(255*V.Clamp(J,0,1)),this._g=Box2D.parseUInt(255*V.Clamp(F,0,1)),this._b=Box2D.parseUInt(255*V.Clamp(R,0,1))},Object.defineProperty(o.prototype,"r",{enumerable:!1,configurable:!0,set:function set(J){J===void 0&&(J=0),this._r=Box2D.parseUInt(255*V.Clamp(J,0,1))}}),Object.defineProperty(o.prototype,"g",{enumerable:!1,configurable:!0,set:function set(J){J===void 0&&(J=0),this._g=Box2D.parseUInt(255*V.Clamp(J,0,1))}}),Object.defineProperty(o.prototype,"b",{enumerable:!1,configurable:!0,set:function set(J){J===void 0&&(J=0),this._b=Box2D.parseUInt(255*V.Clamp(J,0,1))}}),Object.defineProperty(o.prototype,"color",{enumerable:!1,configurable:!0,get:function get(){return this._r<<16|this._g<<8|this._b}}),_.b2Settings=function(){},_.b2MixFriction=function(J,F){return void 0===J&&(J=0),void 0===F&&(F=0),Math.sqrt(J*F)},_.b2MixRestitution=function(J,F){return void 0===J&&(J=0),void 0===F&&(F=0),J>F?J:F},_.b2Assert=function(J){if(!J)throw"Assertion Failed"},Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha",Box2D.Common.b2Settings.USHRT_MAX=65535,Box2D.Common.b2Settings.b2_pi=Math.PI,Box2D.Common.b2Settings.b2_maxManifoldPoints=2,Box2D.Common.b2Settings.b2_aabbExtension=0.1,Box2D.Common.b2Settings.b2_aabbMultiplier=2,Box2D.Common.b2Settings.b2_polygonRadius=2*_.b2_linearSlop,Box2D.Common.b2Settings.b2_linearSlop=5e-3,Box2D.Common.b2Settings.b2_angularSlop=2/180*_.b2_pi,Box2D.Common.b2Settings.b2_toiSlop=8*_.b2_linearSlop,Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32,Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32,Box2D.Common.b2Settings.b2_velocityThreshold=1,Box2D.Common.b2Settings.b2_maxLinearCorrection=0.2,Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*_.b2_pi,Box2D.Common.b2Settings.b2_maxTranslation=2,Box2D.Common.b2Settings.b2_maxTranslationSquared=_.b2_maxTranslation*_.b2_maxTranslation,Box2D.Common.b2Settings.b2_maxRotation=0.5*_.b2_pi,Box2D.Common.b2Settings.b2_maxRotationSquared=_.b2_maxRotation*_.b2_maxRotation,Box2D.Common.b2Settings.b2_contactBaumgarte=0.2,Box2D.Common.b2Settings.b2_timeToSleep=0.5,Box2D.Common.b2Settings.b2_linearSleepTolerance=0.01,Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*_.b2_pi})}(),function(){var o=Box2D.Collision.b2AABB,n=Box2D.Common.b2Color,_=Box2D.Common.b2internal,S=Box2D.Common.b2Settings,g=Box2D.Common.Math.b2Mat22,V=Box2D.Common.Math.b2Mat33,M=Box2D.Common.Math.b2Math,w=Box2D.Common.Math.b2Sweep,G=Box2D.Common.Math.b2Transform,L=Box2D.Common.Math.b2Vec2,J=Box2D.Common.Math.b2Vec3;g.b2Mat22=function(){this.col1=new L,this.col2=new L},g.prototype.b2Mat22=function(){this.SetIdentity()},g.FromAngle=function(F){void 0===F&&(F=0);var R=new g;return R.Set(F),R},g.FromVV=function(F,R){var E=new g;return E.SetVV(F,R),E},g.prototype.Set=function(F){F===void 0&&(F=0);var R=Math.cos(F),E=Math.sin(F);this.col1.x=R,this.col2.x=-E,this.col1.y=E,this.col2.y=R},g.prototype.SetVV=function(F,R){this.col1.SetV(F),this.col2.SetV(R)},g.prototype.Copy=function(){var F=new g;return F.SetM(this),F},g.prototype.SetM=function(F){this.col1.SetV(F.col1),this.col2.SetV(F.col2)},g.prototype.AddM=function(F){this.col1.x+=F.col1.x,this.col1.y+=F.col1.y,this.col2.x+=F.col2.x,this.col2.y+=F.col2.y},g.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},g.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},g.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},g.prototype.GetInverse=function(F){var R=this.col1.x,E=this.col2.x,N=this.col1.y,U=this.col2.y,q=R*U-E*N;return 0!=q&&(q=1/q),F.col1.x=q*U,F.col2.x=-q*E,F.col1.y=-q*N,F.col2.y=q*R,F},g.prototype.Solve=function(F,R,E){void 0===R&&(R=0),void 0===E&&(E=0);var N=this.col1.x,U=this.col2.x,q=this.col1.y,W=this.col2.y,O=N*W-U*q;return 0!=O&&(O=1/O),F.x=O*(W*R-U*E),F.y=O*(N*E-q*R),F},g.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},V.b2Mat33=function(){this.col1=new J,this.col2=new J,this.col3=new J},V.prototype.b2Mat33=function(F,R,E){F===void 0&&(F=null),R===void 0&&(R=null),E===void 0&&(E=null),F||R||E?(this.col1.SetV(F),this.col2.SetV(R),this.col3.SetV(E)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())},V.prototype.SetVVV=function(F,R,E){this.col1.SetV(F),this.col2.SetV(R),this.col3.SetV(E)},V.prototype.Copy=function(){return new V(this.col1,this.col2,this.col3)},V.prototype.SetM=function(F){this.col1.SetV(F.col1),this.col2.SetV(F.col2),this.col3.SetV(F.col3)},V.prototype.AddM=function(F){this.col1.x+=F.col1.x,this.col1.y+=F.col1.y,this.col1.z+=F.col1.z,this.col2.x+=F.col2.x,this.col2.y+=F.col2.y,this.col2.z+=F.col2.z,this.col3.x+=F.col3.x,this.col3.y+=F.col3.y,this.col3.z+=F.col3.z},V.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=1,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=1},V.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col3.x=0,this.col1.y=0,this.col2.y=0,this.col3.y=0,this.col1.z=0,this.col2.z=0,this.col3.z=0},V.prototype.Solve22=function(F,R,E){void 0===R&&(R=0),void 0===E&&(E=0);var N=this.col1.x,U=this.col2.x,q=this.col1.y,W=this.col2.y,O=N*W-U*q;return 0!=O&&(O=1/O),F.x=O*(W*R-U*E),F.y=O*(N*E-q*R),F},V.prototype.Solve33=function(F,R,E,N){void 0===R&&(R=0),void 0===E&&(E=0),void 0===N&&(N=0);var U=this.col1.x,q=this.col1.y,W=this.col1.z,O=this.col2.x,X=this.col2.y,Z=this.col2.z,H=this.col3.x,Y=this.col3.y,Q=this.col3.z,$=U*(X*Q-Z*Y)+q*(Z*H-O*Q)+W*(O*Y-X*H);return 0!=$&&($=1/$),F.x=$*(R*(X*Q-Z*Y)+E*(Z*H-O*Q)+N*(O*Y-X*H)),F.y=$*(U*(E*Q-N*Y)+q*(N*H-R*Q)+W*(R*Y-E*H)),F.z=$*(U*(X*N-Z*E)+q*(Z*R-O*N)+W*(O*E-X*R)),F},M.b2Math=function(){},M.IsValid=function(F){return void 0===F&&(F=0),isFinite(F)},M.Dot=function(F,R){return F.x*R.x+F.y*R.y},M.CrossVV=function(F,R){return F.x*R.y-F.y*R.x},M.CrossVF=function(F,R){R===void 0&&(R=0);var E=new L(R*F.y,-R*F.x);return E},M.CrossFV=function(F,R){F===void 0&&(F=0);var E=new L(-F*R.y,F*R.x);return E},M.MulMV=function(F,R){var E=new L(F.col1.x*R.x+F.col2.x*R.y,F.col1.y*R.x+F.col2.y*R.y);return E},M.MulTMV=function(F,R){var E=new L(M.Dot(R,F.col1),M.Dot(R,F.col2));return E},M.MulX=function(F,R){var E=M.MulMV(F.R,R);return E.x+=F.position.x,E.y+=F.position.y,E},M.MulXT=function(F,R){var E=M.SubtractVV(R,F.position),N=E.x*F.R.col1.x+E.y*F.R.col1.y;return E.y=E.x*F.R.col2.x+E.y*F.R.col2.y,E.x=N,E},M.AddVV=function(F,R){var E=new L(F.x+R.x,F.y+R.y);return E},M.SubtractVV=function(F,R){var E=new L(F.x-R.x,F.y-R.y);return E},M.Distance=function(F,R){var E=F.x-R.x,N=F.y-R.y;return Math.sqrt(E*E+N*N)},M.DistanceSquared=function(F,R){var E=F.x-R.x,N=F.y-R.y;return E*E+N*N},M.MulFV=function(F,R){F===void 0&&(F=0);var E=new L(F*R.x,F*R.y);return E},M.AddMM=function(F,R){var E=g.FromVV(M.AddVV(F.col1,R.col1),M.AddVV(F.col2,R.col2));return E},M.MulMM=function(F,R){var E=g.FromVV(M.MulMV(F,R.col1),M.MulMV(F,R.col2));return E},M.MulTMM=function(F,R){var E=new L(M.Dot(F.col1,R.col1),M.Dot(F.col2,R.col1)),N=new L(M.Dot(F.col1,R.col2),M.Dot(F.col2,R.col2)),U=g.FromVV(E,N);return U},M.Abs=function(F){return void 0===F&&(F=0),0<F?F:-F},M.AbsV=function(F){var R=new L(M.Abs(F.x),M.Abs(F.y));return R},M.AbsM=function(F){var R=g.FromVV(M.AbsV(F.col1),M.AbsV(F.col2));return R},M.Min=function(F,R){return void 0===F&&(F=0),void 0===R&&(R=0),F<R?F:R},M.MinV=function(F,R){var E=new L(M.Min(F.x,R.x),M.Min(F.y,R.y));return E},M.Max=function(F,R){return void 0===F&&(F=0),void 0===R&&(R=0),F>R?F:R},M.MaxV=function(F,R){var E=new L(M.Max(F.x,R.x),M.Max(F.y,R.y));return E},M.Clamp=function(F,R,E){return void 0===F&&(F=0),void 0===R&&(R=0),void 0===E&&(E=0),F<R?R:F>E?E:F},M.ClampV=function(F,R,E){return M.MaxV(R,M.MinV(F,E))},M.Swap=function(F,R){var E=F[0];F[0]=R[0],R[0]=E},M.Random=function(){return 2*Math.random()-1},M.RandomRange=function(F,R){void 0===F&&(F=0),void 0===R&&(R=0);var E=Math.random();return E=(R-F)*E+F,E},M.NextPowerOfTwo=function(F){return void 0===F&&(F=0),F|=2147483647&F>>1,F|=1073741823&F>>2,F|=268435455&F>>4,F|=16777215&F>>8,F|=65535&F>>16,F+1},M.IsPowerOfTwo=function(F){F===void 0&&(F=0);var R=0<F&&0==(F&F-1);return R},Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new L(0,0),Box2D.Common.Math.b2Math.b2Mat22_identity=g.FromVV(new L(1,0),new L(0,1)),Box2D.Common.Math.b2Math.b2Transform_identity=new G(M.b2Vec2_zero,M.b2Mat22_identity)}),w.b2Sweep=function(){this.localCenter=new L,this.c0=new L,this.c=new L},w.prototype.Set=function(F){this.localCenter.SetV(F.localCenter),this.c0.SetV(F.c0),this.c.SetV(F.c),this.a0=F.a0,this.a=F.a,this.t0=F.t0},w.prototype.Copy=function(){var F=new w;return F.localCenter.SetV(this.localCenter),F.c0.SetV(this.c0),F.c.SetV(this.c),F.a0=this.a0,F.a=this.a,F.t0=this.t0,F},w.prototype.GetTransform=function(F,R){R===void 0&&(R=0),F.position.x=(1-R)*this.c0.x+R*this.c.x,F.position.y=(1-R)*this.c0.y+R*this.c.y;var E=(1-R)*this.a0+R*this.a;F.R.Set(E);var N=F.R;F.position.x-=N.col1.x*this.localCenter.x+N.col2.x*this.localCenter.y,F.position.y-=N.col1.y*this.localCenter.x+N.col2.y*this.localCenter.y},w.prototype.Advance=function(F){if(void 0===F&&(F=0),this.t0<F&&1-this.t0>Number.MIN_VALUE){var R=(F-this.t0)/(1-this.t0);this.c0.x=(1-R)*this.c0.x+R*this.c.x,this.c0.y=(1-R)*this.c0.y+R*this.c.y,this.a0=(1-R)*this.a0+R*this.a,this.t0=F}},G.b2Transform=function(){this.position=new L,this.R=new g},G.prototype.b2Transform=function(F,R){F===void 0&&(F=null),R===void 0&&(R=null),F&&(this.position.SetV(F),this.R.SetM(R))},G.prototype.Initialize=function(F,R){this.position.SetV(F),this.R.SetM(R)},G.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},G.prototype.Set=function(F){this.position.SetV(F.position),this.R.SetM(F.R)},G.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},L.b2Vec2=function(){},L.prototype.b2Vec2=function(F,R){F===void 0&&(F=0),R===void 0&&(R=0),this.x=F,this.y=R},L.prototype.SetZero=function(){this.x=0,this.y=0},L.prototype.Set=function(F,R){F===void 0&&(F=0),R===void 0&&(R=0),this.x=F,this.y=R},L.prototype.SetV=function(F){this.x=F.x,this.y=F.y},L.prototype.GetNegative=function(){return new L(-this.x,-this.y)},L.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},L.Make=function(F,R){return void 0===F&&(F=0),void 0===R&&(R=0),new L(F,R)},L.prototype.Copy=function(){return new L(this.x,this.y)},L.prototype.Add=function(F){this.x+=F.x,this.y+=F.y},L.prototype.Subtract=function(F){this.x-=F.x,this.y-=F.y},L.prototype.Multiply=function(F){F===void 0&&(F=0),this.x*=F,this.y*=F},L.prototype.MulM=function(F){var R=this.x;this.x=F.col1.x*R+F.col2.x*this.y,this.y=F.col1.y*R+F.col2.y*this.y},L.prototype.MulTM=function(F){var R=M.Dot(this,F.col1);this.y=M.Dot(this,F.col2),this.x=R},L.prototype.CrossVF=function(F){F===void 0&&(F=0);var R=this.x;this.x=F*this.y,this.y=-F*R},L.prototype.CrossFV=function(F){F===void 0&&(F=0);var R=this.x;this.x=-F*this.y,this.y=F*R},L.prototype.MinV=function(F){this.x=this.x<F.x?this.x:F.x,this.y=this.y<F.y?this.y:F.y},L.prototype.MaxV=function(F){this.x=this.x>F.x?this.x:F.x,this.y=this.y>F.y?this.y:F.y},L.prototype.Abs=function(){0>this.x&&(this.x=-this.x),0>this.y&&(this.y=-this.y)},L.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},L.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},L.prototype.Normalize=function(){var F=Math.sqrt(this.x*this.x+this.y*this.y);if(F<Number.MIN_VALUE)return 0;var R=1/F;return this.x*=R,this.y*=R,F},L.prototype.IsValid=function(){return M.IsValid(this.x)&&M.IsValid(this.y)},J.b2Vec3=function(){},J.prototype.b2Vec3=function(F,R,E){F===void 0&&(F=0),R===void 0&&(R=0),E===void 0&&(E=0),this.x=F,this.y=R,this.z=E},J.prototype.SetZero=function(){this.x=this.y=this.z=0},J.prototype.Set=function(F,R,E){F===void 0&&(F=0),R===void 0&&(R=0),E===void 0&&(E=0),this.x=F,this.y=R,this.z=E},J.prototype.SetV=function(F){this.x=F.x,this.y=F.y,this.z=F.z},J.prototype.GetNegative=function(){return new J(-this.x,-this.y,-this.z)},J.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},J.prototype.Copy=function(){return new J(this.x,this.y,this.z)},J.prototype.Add=function(F){this.x+=F.x,this.y+=F.y,this.z+=F.z},J.prototype.Subtract=function(F){this.x-=F.x,this.y-=F.y,this.z-=F.z},J.prototype.Multiply=function(F){F===void 0&&(F=0),this.x*=F,this.y*=F,this.z*=F}}(),function(){var o=Box2D.Dynamics.Controllers.b2ControllerEdge,n=Box2D.Common.Math.b2Mat22,_=Box2D.Common.Math.b2Mat33,S=Box2D.Common.Math.b2Math,g=Box2D.Common.Math.b2Sweep,V=Box2D.Common.Math.b2Transform,M=Box2D.Common.Math.b2Vec2,w=Box2D.Common.Math.b2Vec3,G=Box2D.Common.b2Color,L=Box2D.Common.b2internal,J=Box2D.Common.b2Settings,F=Box2D.Collision.b2AABB,R=Box2D.Collision.b2Bound,E=Box2D.Collision.b2BoundValues,N=Box2D.Collision.b2Collision,U=Box2D.Collision.b2ContactID,q=Box2D.Collision.b2ContactPoint,W=Box2D.Collision.b2Distance,O=Box2D.Collision.b2DistanceInput,X=Box2D.Collision.b2DistanceOutput,Z=Box2D.Collision.b2DistanceProxy,H=Box2D.Collision.b2DynamicTree,Y=Box2D.Collision.b2DynamicTreeBroadPhase,Q=Box2D.Collision.b2DynamicTreeNode,$=Box2D.Collision.b2DynamicTreePair,ee=Box2D.Collision.b2Manifold,oe=Box2D.Collision.b2ManifoldPoint,te=Box2D.Collision.b2Point,ne=Box2D.Collision.b2RayCastInput,ie=Box2D.Collision.b2RayCastOutput,me=Box2D.Collision.b2Segment,ae=Box2D.Collision.b2SeparationFunction,le=Box2D.Collision.b2Simplex,re=Box2D.Collision.b2SimplexCache,se=Box2D.Collision.b2SimplexVertex,_e=Box2D.Collision.b2TimeOfImpact,pe=Box2D.Collision.b2TOIInput,ye=Box2D.Collision.b2WorldManifold,xe=Box2D.Collision.ClipVertex,ue=Box2D.Collision.Features,de=Box2D.Collision.IBroadPhase,be=Box2D.Collision.Shapes.b2CircleShape,Ce=Box2D.Collision.Shapes.b2EdgeChainDef,fe=Box2D.Collision.Shapes.b2EdgeShape,Ae=Box2D.Collision.Shapes.b2MassData,Se=Box2D.Collision.Shapes.b2PolygonShape,ge=Box2D.Collision.Shapes.b2Shape,De=Box2D.Dynamics.b2Body,ve=Box2D.Dynamics.b2BodyDef,he=Box2D.Dynamics.b2ContactFilter,Be=Box2D.Dynamics.b2ContactImpulse,Ve=Box2D.Dynamics.b2ContactListener,Me=Box2D.Dynamics.b2ContactManager,we=Box2D.Dynamics.b2DebugDraw,Ie=Box2D.Dynamics.b2DestructionListener,Ge=Box2D.Dynamics.b2FilterData,Le=Box2D.Dynamics.b2Fixture,Je=Box2D.Dynamics.b2FixtureDef,Fe=Box2D.Dynamics.b2Island,Pe=Box2D.Dynamics.b2TimeStep,Re=Box2D.Dynamics.b2World,Te=Box2D.Dynamics.Contacts.b2CircleContact,ze=Box2D.Dynamics.Contacts.b2Contact,Ee=Box2D.Dynamics.Contacts.b2ContactConstraint,ke=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,Ne=Box2D.Dynamics.Contacts.b2ContactEdge,je=Box2D.Dynamics.Contacts.b2ContactFactory,Ue=Box2D.Dynamics.Contacts.b2ContactRegister,qe=Box2D.Dynamics.Contacts.b2ContactResult,Ke=Box2D.Dynamics.Contacts.b2ContactSolver,We=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,Oe=Box2D.Dynamics.Contacts.b2NullContact,Xe=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,Ze=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,He=Box2D.Dynamics.Contacts.b2PolygonContact,Ye=Box2D.Dynamics.Contacts.b2PositionSolverManifold,Qe=Box2D.Dynamics.Controllers.b2Controller,$e=Box2D.Dynamics.Joints.b2DistanceJoint,eo=Box2D.Dynamics.Joints.b2DistanceJointDef,oo=Box2D.Dynamics.Joints.b2FrictionJoint,to=Box2D.Dynamics.Joints.b2FrictionJointDef,no=Box2D.Dynamics.Joints.b2GearJoint,io=Box2D.Dynamics.Joints.b2GearJointDef,mo=Box2D.Dynamics.Joints.b2Jacobian,ao=Box2D.Dynamics.Joints.b2Joint,ro=Box2D.Dynamics.Joints.b2JointDef,so=Box2D.Dynamics.Joints.b2JointEdge,_o=Box2D.Dynamics.Joints.b2LineJoint,po=Box2D.Dynamics.Joints.b2LineJointDef,co=Box2D.Dynamics.Joints.b2MouseJoint,yo=Box2D.Dynamics.Joints.b2MouseJointDef,xo=Box2D.Dynamics.Joints.b2PrismaticJoint,uo=Box2D.Dynamics.Joints.b2PrismaticJointDef,bo=Box2D.Dynamics.Joints.b2PulleyJoint,Co=Box2D.Dynamics.Joints.b2PulleyJointDef,fo=Box2D.Dynamics.Joints.b2RevoluteJoint,Ao=Box2D.Dynamics.Joints.b2RevoluteJointDef,So=Box2D.Dynamics.Joints.b2WeldJoint,go=Box2D.Dynamics.Joints.b2WeldJointDef;De.b2Body=function(){this.m_xf=new V,this.m_sweep=new g,this.m_linearVelocity=new M,this.m_force=new M},De.prototype.connectEdges=function(Do,vo,ho){void 0===ho&&(ho=0);var Bo=Math.atan2(vo.GetDirectionVector().y,vo.GetDirectionVector().x),Vo=Math.tan(0.5*(Bo-ho)),Mo=S.MulFV(Vo,vo.GetDirectionVector());Mo=S.SubtractVV(Mo,vo.GetNormalVector()),Mo=S.MulFV(J.b2_toiSlop,Mo),Mo=S.AddVV(Mo,vo.GetVertex1());var wo=S.AddVV(Do.GetDirectionVector(),vo.GetDirectionVector());wo.Normalize();var Io=0<S.Dot(Do.GetDirectionVector(),vo.GetNormalVector());return Do.SetNextEdge(vo,Mo,wo,Io),vo.SetPrevEdge(Do,Mo,wo,Io),Bo},De.prototype.CreateFixture=function(Do){if(!0==this.m_world.IsLocked())return null;var vo=new Le;if(vo.Create(this,this.m_xf,Do),this.m_flags&De.e_activeFlag){var ho=this.m_world.m_contactManager.m_broadPhase;vo.CreateProxy(ho,this.m_xf)}return vo.m_next=this.m_fixtureList,this.m_fixtureList=vo,++this.m_fixtureCount,vo.m_body=this,0<vo.m_density&&this.ResetMassData(),this.m_world.m_flags|=Re.e_newFixture,vo},De.prototype.CreateFixture2=function(Do,vo){void 0===vo&&(vo=0);var ho=new Je;return ho.shape=Do,ho.density=vo,this.CreateFixture(ho)},De.prototype.DestroyFixture=function(Do){if(!0!=this.m_world.IsLocked()){for(var vo=this.m_fixtureList,ho=null,Bo=!1;null!=vo;){if(vo==Do){ho?ho.m_next=Do.m_next:this.m_fixtureList=Do.m_next,Bo=!0;break}ho=vo,vo=vo.m_next}for(var Vo=this.m_contactList,Mo;Vo;){Mo=Vo.contact,Vo=Vo.next;var wo=Mo.GetFixtureA(),Io=Mo.GetFixtureB();(Do==wo||Do==Io)&&this.m_world.m_contactManager.Destroy(Mo)}if(this.m_flags&De.e_activeFlag){var Go=this.m_world.m_contactManager.m_broadPhase;Do.DestroyProxy(Go)}else;Do.Destroy(),Do.m_body=null,Do.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},De.prototype.SetPositionAndAngle=function(Do,vo){vo===void 0&&(vo=0);var ho;if(!0!=this.m_world.IsLocked()){this.m_xf.R.Set(vo),this.m_xf.position.SetV(Do);var Bo=this.m_xf.R,Vo=this.m_sweep.localCenter;this.m_sweep.c.x=Bo.col1.x*Vo.x+Bo.col2.x*Vo.y,this.m_sweep.c.y=Bo.col1.y*Vo.x+Bo.col2.y*Vo.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=vo;var Mo=this.m_world.m_contactManager.m_broadPhase;for(ho=this.m_fixtureList;ho;ho=ho.m_next)ho.Synchronize(Mo,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}},De.prototype.SetTransform=function(Do){this.SetPositionAndAngle(Do.position,Do.GetAngle())},De.prototype.GetTransform=function(){return this.m_xf},De.prototype.GetPosition=function(){return this.m_xf.position},De.prototype.SetPosition=function(Do){this.SetPositionAndAngle(Do,this.GetAngle())},De.prototype.GetAngle=function(){return this.m_sweep.a},De.prototype.SetAngle=function(Do){Do===void 0&&(Do=0),this.SetPositionAndAngle(this.GetPosition(),Do)},De.prototype.GetWorldCenter=function(){return this.m_sweep.c},De.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},De.prototype.SetLinearVelocity=function(Do){this.m_type==De.b2_staticBody||this.m_linearVelocity.SetV(Do)},De.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},De.prototype.SetAngularVelocity=function(Do){Do===void 0&&(Do=0);this.m_type==De.b2_staticBody||(this.m_angularVelocity=Do)},De.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},De.prototype.GetDefinition=function(){var Do=new ve;return Do.type=this.GetType(),Do.allowSleep=(this.m_flags&De.e_allowSleepFlag)==De.e_allowSleepFlag,Do.angle=this.GetAngle(),Do.angularDamping=this.m_angularDamping,Do.angularVelocity=this.m_angularVelocity,Do.fixedRotation=(this.m_flags&De.e_fixedRotationFlag)==De.e_fixedRotationFlag,Do.bullet=(this.m_flags&De.e_bulletFlag)==De.e_bulletFlag,Do.awake=(this.m_flags&De.e_awakeFlag)==De.e_awakeFlag,Do.linearDamping=this.m_linearDamping,Do.linearVelocity.SetV(this.GetLinearVelocity()),Do.position=this.GetPosition(),Do.userData=this.GetUserData(),Do},De.prototype.ApplyForce=function(Do,vo){this.m_type!=De.b2_dynamicBody||(!1==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=Do.x,this.m_force.y+=Do.y,this.m_torque+=(vo.x-this.m_sweep.c.x)*Do.y-(vo.y-this.m_sweep.c.y)*Do.x)},De.prototype.ApplyTorque=function(Do){Do===void 0&&(Do=0);this.m_type!=De.b2_dynamicBody||(!1==this.IsAwake()&&this.SetAwake(!0),this.m_torque+=Do)},De.prototype.ApplyImpulse=function(Do,vo){this.m_type!=De.b2_dynamicBody||(!1==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*Do.x,this.m_linearVelocity.y+=this.m_invMass*Do.y,this.m_angularVelocity+=this.m_invI*((vo.x-this.m_sweep.c.x)*Do.y-(vo.y-this.m_sweep.c.y)*Do.x))},De.prototype.Split=function(Do){for(var vo=this.GetLinearVelocity().Copy(),ho=this.GetAngularVelocity(),Bo=this.GetWorldCenter(),Vo=this,Mo=this.m_world.CreateBody(this.GetDefinition()),Io=Vo.m_fixtureList,wo;Io;)if(Do(Io)){var Go=Io.m_next;wo?wo.m_next=Go:Vo.m_fixtureList=Go,Vo.m_fixtureCount--,Io.m_next=Mo.m_fixtureList,Mo.m_fixtureList=Io,Mo.m_fixtureCount++,Io.m_body=Mo,Io=Go}else wo=Io,Io=Io.m_next;Vo.ResetMassData(),Mo.ResetMassData();var Lo=Vo.GetWorldCenter(),Jo=Mo.GetWorldCenter(),Fo=S.AddVV(vo,S.CrossFV(ho,S.SubtractVV(Lo,Bo))),Po=S.AddVV(vo,S.CrossFV(ho,S.SubtractVV(Jo,Bo)));return Vo.SetLinearVelocity(Fo),Mo.SetLinearVelocity(Po),Vo.SetAngularVelocity(ho),Mo.SetAngularVelocity(ho),Vo.SynchronizeFixtures(),Mo.SynchronizeFixtures(),Mo},De.prototype.Merge=function(Do){var vo;for(vo=Do.m_fixtureList;vo;){var ho=vo.m_next;Do.m_fixtureCount--,vo.m_next=this.m_fixtureList,this.m_fixtureList=vo,this.m_fixtureCount++,vo.m_body=Vo,vo=ho}Bo.m_fixtureCount=0;var Bo=this,Vo=Do,Mo=Bo.GetWorldCenter(),wo=Vo.GetWorldCenter(),Io=Bo.GetLinearVelocity().Copy(),Go=Vo.GetLinearVelocity().Copy(),Lo=Bo.GetAngularVelocity(),Jo=Vo.GetAngularVelocity();Bo.ResetMassData(),this.SynchronizeFixtures()},De.prototype.GetMass=function(){return this.m_mass},De.prototype.GetInertia=function(){return this.m_I},De.prototype.GetMassData=function(Do){Do.mass=this.m_mass,Do.I=this.m_I,Do.center.SetV(this.m_sweep.localCenter)},De.prototype.SetMassData=function(Do){if((J.b2Assert(!1==this.m_world.IsLocked()),!0!=this.m_world.IsLocked())&&this.m_type==De.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=Do.mass,0>=this.m_mass&&(this.m_mass=1),this.m_invMass=1/this.m_mass,0<Do.I&&0==(this.m_flags&De.e_fixedRotationFlag)&&(this.m_I=Do.I-this.m_mass*(Do.center.x*Do.center.x+Do.center.y*Do.center.y),this.m_invI=1/this.m_I);var vo=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(Do.center),this.m_sweep.c0.SetV(S.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-vo.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-vo.x)}},De.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!=De.b2_staticBody&&this.m_type!=De.b2_kinematicBody){for(var Do=M.Make(0,0),vo=this.m_fixtureList;vo;vo=vo.m_next)if(0!=vo.m_density){var ho=vo.GetMassData();this.m_mass+=ho.mass,Do.x+=ho.center.x*ho.mass,Do.y+=ho.center.y*ho.mass,this.m_I+=ho.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,Do.x*=this.m_invMass,Do.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),0<this.m_I&&0==(this.m_flags&De.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(Do.x*Do.x+Do.y*Do.y),this.m_I*=this.m_inertiaScale,J.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var Bo=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(Do),this.m_sweep.c0.SetV(S.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-Bo.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-Bo.x)}},De.prototype.GetWorldPoint=function(Do){var vo=this.m_xf.R,ho=new M(vo.col1.x*Do.x+vo.col2.x*Do.y,vo.col1.y*Do.x+vo.col2.y*Do.y);return ho.x+=this.m_xf.position.x,ho.y+=this.m_xf.position.y,ho},De.prototype.GetWorldVector=function(Do){return S.MulMV(this.m_xf.R,Do)},De.prototype.GetLocalPoint=function(Do){return S.MulXT(this.m_xf,Do)},De.prototype.GetLocalVector=function(Do){return S.MulTMV(this.m_xf.R,Do)},De.prototype.GetLinearVelocityFromWorldPoint=function(Do){return new M(this.m_linearVelocity.x-this.m_angularVelocity*(Do.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(Do.x-this.m_sweep.c.x))},De.prototype.GetLinearVelocityFromLocalPoint=function(Do){var vo=this.m_xf.R,ho=new M(vo.col1.x*Do.x+vo.col2.x*Do.y,vo.col1.y*Do.x+vo.col2.y*Do.y);return ho.x+=this.m_xf.position.x,ho.y+=this.m_xf.position.y,new M(this.m_linearVelocity.x-this.m_angularVelocity*(ho.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(ho.x-this.m_sweep.c.x))},De.prototype.GetLinearDamping=function(){return this.m_linearDamping},De.prototype.SetLinearDamping=function(Do){Do===void 0&&(Do=0),this.m_linearDamping=Do},De.prototype.GetAngularDamping=function(){return this.m_angularDamping},De.prototype.SetAngularDamping=function(Do){Do===void 0&&(Do=0),this.m_angularDamping=Do},De.prototype.SetType=function(Do){if(void 0===Do&&(Do=0),this.m_type!=Do){this.m_type=Do,this.ResetMassData(),this.m_type==De.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var vo=this.m_contactList;vo;vo=vo.next)vo.contact.FlagForFiltering()}},De.prototype.GetType=function(){return this.m_type},De.prototype.SetBullet=function(Do){Do?this.m_flags|=De.e_bulletFlag:this.m_flags&=~De.e_bulletFlag},De.prototype.IsBullet=function(){return(this.m_flags&De.e_bulletFlag)==De.e_bulletFlag},De.prototype.SetSleepingAllowed=function(Do){Do?this.m_flags|=De.e_allowSleepFlag:(this.m_flags&=~De.e_allowSleepFlag,this.SetAwake(!0))},De.prototype.SetAwake=function(Do){Do?(this.m_flags|=De.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~De.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},De.prototype.IsAwake=function(){return(this.m_flags&De.e_awakeFlag)==De.e_awakeFlag},De.prototype.SetFixedRotation=function(Do){Do?this.m_flags|=De.e_fixedRotationFlag:this.m_flags&=~De.e_fixedRotationFlag,this.ResetMassData()},De.prototype.IsFixedRotation=function(){return(this.m_flags&De.e_fixedRotationFlag)==De.e_fixedRotationFlag},De.prototype.SetActive=function(Do){if(Do!=this.IsActive()){var vo,ho;if(Do)for(this.m_flags|=De.e_activeFlag,vo=this.m_world.m_contactManager.m_broadPhase,ho=this.m_fixtureList;ho;ho=ho.m_next)ho.CreateProxy(vo,this.m_xf);else{for(this.m_flags&=~De.e_activeFlag,vo=this.m_world.m_contactManager.m_broadPhase,ho=this.m_fixtureList;ho;ho=ho.m_next)ho.DestroyProxy(vo);for(var Bo=this.m_contactList,Vo;Bo;)Vo=Bo,Bo=Bo.next,this.m_world.m_contactManager.Destroy(Vo.contact);this.m_contactList=null}}},De.prototype.IsActive=function(){return(this.m_flags&De.e_activeFlag)==De.e_activeFlag},De.prototype.IsSleepingAllowed=function(){return(this.m_flags&De.e_allowSleepFlag)==De.e_allowSleepFlag},De.prototype.GetFixtureList=function(){return this.m_fixtureList},De.prototype.GetJointList=function(){return this.m_jointList},De.prototype.GetControllerList=function(){return this.m_controllerList},De.prototype.GetContactList=function(){return this.m_contactList},De.prototype.GetNext=function(){return this.m_next},De.prototype.GetUserData=function(){return this.m_userData},De.prototype.SetUserData=function(Do){this.m_userData=Do},De.prototype.GetWorld=function(){return this.m_world},De.prototype.b2Body=function(Do,vo){this.m_flags=0,Do.bullet&&(this.m_flags|=De.e_bulletFlag),Do.fixedRotation&&(this.m_flags|=De.e_fixedRotationFlag),Do.allowSleep&&(this.m_flags|=De.e_allowSleepFlag),Do.awake&&(this.m_flags|=De.e_awakeFlag),Do.active&&(this.m_flags|=De.e_activeFlag),this.m_world=vo,this.m_xf.position.SetV(Do.position),this.m_xf.R.Set(Do.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=Do.angle;var ho=this.m_xf.R,Bo=this.m_sweep.localCenter;this.m_sweep.c.x=ho.col1.x*Bo.x+ho.col2.x*Bo.y,this.m_sweep.c.y=ho.col1.y*Bo.x+ho.col2.y*Bo.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(Do.linearVelocity),this.m_angularVelocity=Do.angularVelocity,this.m_linearDamping=Do.linearDamping,this.m_angularDamping=Do.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=Do.type,this.m_type==De.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=Do.inertiaScale,this.m_userData=Do.userData,this.m_fixtureList=null,this.m_fixtureCount=0},De.prototype.SynchronizeFixtures=function(){var Do=De.s_xf1;Do.R.Set(this.m_sweep.a0);var vo=Do.R,ho=this.m_sweep.localCenter;Do.position.x=this.m_sweep.c0.x-(vo.col1.x*ho.x+vo.col2.x*ho.y),Do.position.y=this.m_sweep.c0.y-(vo.col1.y*ho.x+vo.col2.y*ho.y);var Bo,Vo=this.m_world.m_contactManager.m_broadPhase;for(Bo=this.m_fixtureList;Bo;Bo=Bo.m_next)Bo.Synchronize(Vo,Do,this.m_xf)},De.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var Do=this.m_xf.R,vo=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(Do.col1.x*vo.x+Do.col2.x*vo.y),this.m_xf.position.y=this.m_sweep.c.y-(Do.col1.y*vo.x+Do.col2.y*vo.y)},De.prototype.ShouldCollide=function(Do){if(this.m_type!=De.b2_dynamicBody&&Do.m_type!=De.b2_dynamicBody)return!1;for(var vo=this.m_jointList;vo;vo=vo.next)if(vo.other==Do&&!1==vo.joint.m_collideConnected)return!1;return!0},De.prototype.Advance=function(Do){Do===void 0&&(Do=0),this.m_sweep.Advance(Do),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new V,Box2D.Dynamics.b2Body.e_islandFlag=1,Box2D.Dynamics.b2Body.e_awakeFlag=2,Box2D.Dynamics.b2Body.e_allowSleepFlag=4,Box2D.Dynamics.b2Body.e_bulletFlag=8,Box2D.Dynamics.b2Body.e_fixedRotationFlag=16,Box2D.Dynamics.b2Body.e_activeFlag=32,Box2D.Dynamics.b2Body.b2_staticBody=0,Box2D.Dynamics.b2Body.b2_kinematicBody=1,Box2D.Dynamics.b2Body.b2_dynamicBody=2}),ve.b2BodyDef=function(){this.position=new M,this.linearVelocity=new M},ve.prototype.b2BodyDef=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=De.b2_staticBody,this.active=!0,this.inertiaScale=1},he.b2ContactFilter=function(){},he.prototype.ShouldCollide=function(Do,vo){var ho=Do.GetFilterData(),Bo=vo.GetFilterData();if(ho.groupIndex==Bo.groupIndex&&0!=ho.groupIndex)return 0<ho.groupIndex;var Vo=0!=(ho.maskBits&Bo.categoryBits)&&0!=(ho.categoryBits&Bo.maskBits);return Vo},he.prototype.RayCollide=function(Do,vo){return!Do||this.ShouldCollide(Do instanceof Le?Do:null,vo)},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new he}),Be.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(J.b2_maxManifoldPoints),this.tangentImpulses=new Vector_a2j_Number(J.b2_maxManifoldPoints)},Ve.b2ContactListener=function(){},Ve.prototype.BeginContact=function(){},Ve.prototype.EndContact=function(){},Ve.prototype.PreSolve=function(){},Ve.prototype.PostSolve=function(){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new Ve}),Me.b2ContactManager=function(){},Me.prototype.b2ContactManager=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=he.b2_defaultFilter,this.m_contactListener=Ve.b2_defaultListener,this.m_contactFactory=new je(this.m_allocator),this.m_broadPhase=new Y},Me.prototype.AddPair=function(Do,vo){var ho=Do instanceof Le?Do:null,Bo=vo instanceof Le?vo:null,Vo=ho.GetBody(),Mo=Bo.GetBody();if(Vo!=Mo){for(var wo=Mo.GetContactList();wo;){if(wo.other==Vo){var Io=wo.contact.GetFixtureA(),Go=wo.contact.GetFixtureB();if(Io==ho&&Go==Bo)return;if(Io==Bo&&Go==ho)return}wo=wo.next}if(!1!=Mo.ShouldCollide(Vo)&&!1!=this.m_contactFilter.ShouldCollide(ho,Bo)){var Lo=this.m_contactFactory.Create(ho,Bo);return ho=Lo.GetFixtureA(),Bo=Lo.GetFixtureB(),Vo=ho.m_body,Mo=Bo.m_body,Lo.m_prev=null,Lo.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=Lo),this.m_world.m_contactList=Lo,Lo.m_nodeA.contact=Lo,Lo.m_nodeA.other=Mo,Lo.m_nodeA.prev=null,Lo.m_nodeA.next=Vo.m_contactList,null!=Vo.m_contactList&&(Vo.m_contactList.prev=Lo.m_nodeA),Vo.m_contactList=Lo.m_nodeA,Lo.m_nodeB.contact=Lo,Lo.m_nodeB.other=Vo,Lo.m_nodeB.prev=null,Lo.m_nodeB.next=Mo.m_contactList,null!=Mo.m_contactList&&(Mo.m_contactList.prev=Lo.m_nodeB),Mo.m_contactList=Lo.m_nodeB,void++this.m_world.m_contactCount}}},Me.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))},Me.prototype.Destroy=function(Do){var vo=Do.GetFixtureA(),ho=Do.GetFixtureB(),Bo=vo.GetBody(),Vo=ho.GetBody();Do.IsTouching()&&this.m_contactListener.EndContact(Do),Do.m_prev&&(Do.m_prev.m_next=Do.m_next),Do.m_next&&(Do.m_next.m_prev=Do.m_prev),Do==this.m_world.m_contactList&&(this.m_world.m_contactList=Do.m_next),Do.m_nodeA.prev&&(Do.m_nodeA.prev.next=Do.m_nodeA.next),Do.m_nodeA.next&&(Do.m_nodeA.next.prev=Do.m_nodeA.prev),Do.m_nodeA==Bo.m_contactList&&(Bo.m_contactList=Do.m_nodeA.next),Do.m_nodeB.prev&&(Do.m_nodeB.prev.next=Do.m_nodeB.next),Do.m_nodeB.next&&(Do.m_nodeB.next.prev=Do.m_nodeB.prev),Do.m_nodeB==Vo.m_contactList&&(Vo.m_contactList=Do.m_nodeB.next),this.m_contactFactory.Destroy(Do),--this.m_contactCount},Me.prototype.Collide=function(){for(var Do=this.m_world.m_contactList;Do;){var vo=Do.GetFixtureA(),ho=Do.GetFixtureB(),Bo=vo.GetBody(),Vo=ho.GetBody();if(!1==Bo.IsAwake()&&!1==Vo.IsAwake()){Do=Do.GetNext();continue}if(Do.m_flags&ze.e_filterFlag){if(!1==Vo.ShouldCollide(Bo)){var Mo=Do;Do=Mo.GetNext(),this.Destroy(Mo);continue}if(!1==this.m_contactFilter.ShouldCollide(vo,ho)){Mo=Do,Do=Mo.GetNext(),this.Destroy(Mo);continue}Do.m_flags&=~ze.e_filterFlag}var wo=vo.m_proxy,Io=ho.m_proxy,Go=this.m_broadPhase.TestOverlap(wo,Io);if(!1==Go){Mo=Do,Do=Mo.GetNext(),this.Destroy(Mo);continue}Do.Update(this.m_contactListener),Do=Do.GetNext()}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new q}),we.b2DebugDraw=function(){},we.prototype.b2DebugDraw=function(){},we.prototype.SetFlags=function(Do){Do===void 0&&(Do=0)},we.prototype.GetFlags=function(){},we.prototype.AppendFlags=function(Do){Do===void 0&&(Do=0)},we.prototype.ClearFlags=function(Do){Do===void 0&&(Do=0)},we.prototype.SetSprite=function(){},we.prototype.GetSprite=function(){},we.prototype.SetDrawScale=function(Do){Do===void 0&&(Do=0)},we.prototype.GetDrawScale=function(){},we.prototype.SetLineThickness=function(Do){Do===void 0&&(Do=0)},we.prototype.GetLineThickness=function(){},we.prototype.SetAlpha=function(Do){Do===void 0&&(Do=0)},we.prototype.GetAlpha=function(){},we.prototype.SetFillAlpha=function(Do){Do===void 0&&(Do=0)},we.prototype.GetFillAlpha=function(){},we.prototype.SetXFormScale=function(Do){Do===void 0&&(Do=0)},we.prototype.GetXFormScale=function(){},we.prototype.DrawPolygon=function(Do,vo){vo===void 0&&(vo=0)},we.prototype.DrawSolidPolygon=function(Do,vo){vo===void 0&&(vo=0)},we.prototype.DrawCircle=function(Do,vo){vo===void 0&&(vo=0)},we.prototype.DrawSolidCircle=function(Do,vo){vo===void 0&&(vo=0)},we.prototype.DrawSegment=function(){},we.prototype.DrawTransform=function(){},Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1,Box2D.Dynamics.b2DebugDraw.e_jointBit=2,Box2D.Dynamics.b2DebugDraw.e_aabbBit=4,Box2D.Dynamics.b2DebugDraw.e_pairBit=8,Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16,Box2D.Dynamics.b2DebugDraw.e_controllerBit=32}),Ie.b2DestructionListener=function(){},Ie.prototype.SayGoodbyeJoint=function(){},Ie.prototype.SayGoodbyeFixture=function(){},Ge.b2FilterData=function(){this.categoryBits=1,this.maskBits=65535,this.groupIndex=0},Ge.prototype.Copy=function(){var Do=new Ge;return Do.categoryBits=this.categoryBits,Do.maskBits=this.maskBits,Do.groupIndex=this.groupIndex,Do},Le.b2Fixture=function(){this.m_filter=new Ge},Le.prototype.GetType=function(){return this.m_shape.GetType()},Le.prototype.GetShape=function(){return this.m_shape},Le.prototype.SetSensor=function(Do){if(this.m_isSensor!=Do&&(this.m_isSensor=Do,null!=this.m_body))for(var vo=this.m_body.GetContactList();vo;){var ho=vo.contact,Bo=ho.GetFixtureA(),Vo=ho.GetFixtureB();(Bo==this||Vo==this)&&ho.SetSensor(Bo.IsSensor()||Vo.IsSensor()),vo=vo.next}},Le.prototype.IsSensor=function(){return this.m_isSensor},Le.prototype.SetFilterData=function(Do){if(this.m_filter=Do.Copy(),!this.m_body)for(var vo=this.m_body.GetContactList();vo;){var ho=vo.contact,Bo=ho.GetFixtureA(),Vo=ho.GetFixtureB();(Bo==this||Vo==this)&&ho.FlagForFiltering(),vo=vo.next}},Le.prototype.GetFilterData=function(){return this.m_filter.Copy()},Le.prototype.GetBody=function(){return this.m_body},Le.prototype.GetNext=function(){return this.m_next},Le.prototype.GetUserData=function(){return this.m_userData},Le.prototype.SetUserData=function(Do){this.m_userData=Do},Le.prototype.TestPoint=function(Do){return this.m_shape.TestPoint(this.m_body.GetTransform(),Do)},Le.prototype.RayCast=function(Do,vo){return this.m_shape.RayCast(Do,vo,this.m_body.GetTransform())},Le.prototype.GetMassData=function(Do){return void 0===Do&&(Do=null),null==Do&&(Do=new Ae),this.m_shape.ComputeMass(Do,this.m_density),Do},Le.prototype.SetDensity=function(Do){Do===void 0&&(Do=0),this.m_density=Do},Le.prototype.GetDensity=function(){return this.m_density},Le.prototype.GetFriction=function(){return this.m_friction},Le.prototype.SetFriction=function(Do){Do===void 0&&(Do=0),this.m_friction=Do},Le.prototype.GetRestitution=function(){return this.m_restitution},Le.prototype.SetRestitution=function(Do){Do===void 0&&(Do=0),this.m_restitution=Do},Le.prototype.GetAABB=function(){return this.m_aabb},Le.prototype.b2Fixture=function(){this.m_aabb=new F,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},Le.prototype.Create=function(Do,vo,ho){this.m_userData=ho.userData,this.m_friction=ho.friction,this.m_restitution=ho.restitution,this.m_body=Do,this.m_next=null,this.m_filter=ho.filter.Copy(),this.m_isSensor=ho.isSensor,this.m_shape=ho.shape.Copy(),this.m_density=ho.density},Le.prototype.Destroy=function(){this.m_shape=null},Le.prototype.CreateProxy=function(Do,vo){this.m_shape.ComputeAABB(this.m_aabb,vo),this.m_proxy=Do.CreateProxy(this.m_aabb,this)},Le.prototype.DestroyProxy=function(Do){null==this.m_proxy||(Do.DestroyProxy(this.m_proxy),this.m_proxy=null)},Le.prototype.Synchronize=function(Do,vo,ho){if(this.m_proxy){var Bo=new F,Vo=new F;this.m_shape.ComputeAABB(Bo,vo),this.m_shape.ComputeAABB(Vo,ho),this.m_aabb.Combine(Bo,Vo);var Mo=S.SubtractVV(ho.position,vo.position);Do.MoveProxy(this.m_proxy,this.m_aabb,Mo)}},Je.b2FixtureDef=function(){this.filter=new Ge},Je.prototype.b2FixtureDef=function(){this.shape=null,this.userData=null,this.friction=0.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},Fe.b2Island=function(){},Fe.prototype.b2Island=function(){this.m_bodies=new Vector,this.m_contacts=new Vector,this.m_joints=new Vector},Fe.prototype.Initialize=function(Do,vo,ho,Bo,Vo,Mo){Do===void 0&&(Do=0),vo===void 0&&(vo=0),ho===void 0&&(ho=0);var wo=0;for(this.m_bodyCapacity=Do,this.m_contactCapacity=vo,this.m_jointCapacity=ho,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=Bo,this.m_listener=Vo,this.m_contactSolver=Mo,wo=this.m_bodies.length;wo<Do;wo++)this.m_bodies[wo]=null;for(wo=this.m_contacts.length;wo<vo;wo++)this.m_contacts[wo]=null;for(wo=this.m_joints.length;wo<ho;wo++)this.m_joints[wo]=null},Fe.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},Fe.prototype.Solve=function(Do,vo,ho){var Bo=0,Vo=0,Mo,wo;for(Bo=0;Bo<this.m_bodyCount;++Bo)Mo=this.m_bodies[Bo],Mo.GetType()==De.b2_dynamicBody&&(Mo.m_linearVelocity.x+=Do.dt*(vo.x+Mo.m_invMass*Mo.m_force.x),Mo.m_linearVelocity.y+=Do.dt*(vo.y+Mo.m_invMass*Mo.m_force.y),Mo.m_angularVelocity+=Do.dt*Mo.m_invI*Mo.m_torque,Mo.m_linearVelocity.Multiply(S.Clamp(1-Do.dt*Mo.m_linearDamping,0,1)),Mo.m_angularVelocity*=S.Clamp(1-Do.dt*Mo.m_angularDamping,0,1));this.m_contactSolver.Initialize(Do,this.m_contacts,this.m_contactCount,this.m_allocator);var Io=this.m_contactSolver;for(Io.InitVelocityConstraints(Do),Bo=0;Bo<this.m_jointCount;++Bo)wo=this.m_joints[Bo],wo.InitVelocityConstraints(Do);for(Bo=0;Bo<Do.velocityIterations;++Bo){for(Vo=0;Vo<this.m_jointCount;++Vo)wo=this.m_joints[Vo],wo.SolveVelocityConstraints(Do);Io.SolveVelocityConstraints()}for(Bo=0;Bo<this.m_jointCount;++Bo)wo=this.m_joints[Bo],wo.FinalizeVelocityConstraints();for(Io.FinalizeVelocityConstraints(),Bo=0;Bo<this.m_bodyCount;++Bo)if(Mo=this.m_bodies[Bo],Mo.GetType()!=De.b2_staticBody){var Go=Do.dt*Mo.m_linearVelocity.x,Lo=Do.dt*Mo.m_linearVelocity.y;Go*Go+Lo*Lo>J.b2_maxTranslationSquared&&(Mo.m_linearVelocity.Normalize(),Mo.m_linearVelocity.x*=J.b2_maxTranslation*Do.inv_dt,Mo.m_linearVelocity.y*=J.b2_maxTranslation*Do.inv_dt);var Jo=Do.dt*Mo.m_angularVelocity;Jo*Jo>J.b2_maxRotationSquared&&(0>Mo.m_angularVelocity?Mo.m_angularVelocity=-J.b2_maxRotation*Do.inv_dt:Mo.m_angularVelocity=J.b2_maxRotation*Do.inv_dt),Mo.m_sweep.c0.SetV(Mo.m_sweep.c),Mo.m_sweep.a0=Mo.m_sweep.a,Mo.m_sweep.c.x+=Do.dt*Mo.m_linearVelocity.x,Mo.m_sweep.c.y+=Do.dt*Mo.m_linearVelocity.y,Mo.m_sweep.a+=Do.dt*Mo.m_angularVelocity,Mo.SynchronizeTransform()}for(Bo=0;Bo<Do.positionIterations;++Bo){var Fo=Io.SolvePositionConstraints(J.b2_contactBaumgarte),Po=!0;for(Vo=0;Vo<this.m_jointCount;++Vo){wo=this.m_joints[Vo];var Ro=wo.SolvePositionConstraints(J.b2_contactBaumgarte);Po=Po&&Ro}if(Fo&&Po)break}if(this.Report(Io.m_constraints),ho){var To=Number.MAX_VALUE,zo=J.b2_linearSleepTolerance*J.b2_linearSleepTolerance,Eo=J.b2_angularSleepTolerance*J.b2_angularSleepTolerance;for(Bo=0;Bo<this.m_bodyCount;++Bo)(Mo=this.m_bodies[Bo],Mo.GetType()!=De.b2_staticBody)&&(0==(Mo.m_flags&De.e_allowSleepFlag)&&(Mo.m_sleepTime=0,To=0),0==(Mo.m_flags&De.e_allowSleepFlag)||Mo.m_angularVelocity*Mo.m_angularVelocity>Eo||S.Dot(Mo.m_linearVelocity,Mo.m_linearVelocity)>zo?(Mo.m_sleepTime=0,To=0):(Mo.m_sleepTime+=Do.dt,To=S.Min(To,Mo.m_sleepTime)));if(To>=J.b2_timeToSleep)for(Bo=0;Bo<this.m_bodyCount;++Bo)Mo=this.m_bodies[Bo],Mo.SetAwake(!1)}},Fe.prototype.SolveTOI=function(Do){var vo=0,ho=0;this.m_contactSolver.Initialize(Do,this.m_contacts,this.m_contactCount,this.m_allocator);var Bo=this.m_contactSolver;for(vo=0;vo<this.m_jointCount;++vo)this.m_joints[vo].InitVelocityConstraints(Do);for(vo=0;vo<Do.velocityIterations;++vo)for(Bo.SolveVelocityConstraints(),ho=0;ho<this.m_jointCount;++ho)this.m_joints[ho].SolveVelocityConstraints(Do);for(vo=0;vo<this.m_bodyCount;++vo){var Vo=this.m_bodies[vo];if(Vo.GetType()!=De.b2_staticBody){var Mo=Do.dt*Vo.m_linearVelocity.x,wo=Do.dt*Vo.m_linearVelocity.y;Mo*Mo+wo*wo>J.b2_maxTranslationSquared&&(Vo.m_linearVelocity.Normalize(),Vo.m_linearVelocity.x*=J.b2_maxTranslation*Do.inv_dt,Vo.m_linearVelocity.y*=J.b2_maxTranslation*Do.inv_dt);var Io=Do.dt*Vo.m_angularVelocity;Io*Io>J.b2_maxRotationSquared&&(0>Vo.m_angularVelocity?Vo.m_angularVelocity=-J.b2_maxRotation*Do.inv_dt:Vo.m_angularVelocity=J.b2_maxRotation*Do.inv_dt),Vo.m_sweep.c0.SetV(Vo.m_sweep.c),Vo.m_sweep.a0=Vo.m_sweep.a,Vo.m_sweep.c.x+=Do.dt*Vo.m_linearVelocity.x,Vo.m_sweep.c.y+=Do.dt*Vo.m_linearVelocity.y,Vo.m_sweep.a+=Do.dt*Vo.m_angularVelocity,Vo.SynchronizeTransform()}}for(vo=0;vo<Do.positionIterations;++vo){var Lo=Bo.SolvePositionConstraints(0.75),Jo=!0;for(ho=0;ho<this.m_jointCount;++ho){var Fo=this.m_joints[ho].SolvePositionConstraints(J.b2_contactBaumgarte);Jo=Jo&&Fo}if(Lo&&Jo)break}this.Report(Bo.m_constraints)},Fe.prototype.Report=function(Do){if(null!=this.m_listener)for(var vo=0;vo<this.m_contactCount;++vo){for(var ho=this.m_contacts[vo],Bo=Do[vo],Vo=0;Vo<Bo.pointCount;++Vo)Fe.s_impulse.normalImpulses[Vo]=Bo.points[Vo].normalImpulse,Fe.s_impulse.tangentImpulses[Vo]=Bo.points[Vo].tangentImpulse;this.m_listener.PostSolve(ho,Fe.s_impulse)}},Fe.prototype.AddBody=function(Do){Do.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=Do},Fe.prototype.AddContact=function(Do){this.m_contacts[this.m_contactCount++]=Do},Fe.prototype.AddJoint=function(Do){this.m_joints[this.m_jointCount++]=Do},Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new Be}),Pe.b2TimeStep=function(){},Pe.prototype.Set=function(Do){this.dt=Do.dt,this.inv_dt=Do.inv_dt,this.positionIterations=Do.positionIterations,this.velocityIterations=Do.velocityIterations,this.warmStarting=Do.warmStarting},Re.b2World=function(){this.s_stack=new Vector,this.m_contactManager=new Me,this.m_contactSolver=new Ke,this.m_island=new Fe},Re.prototype.b2World=function(Do,vo){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,Re.m_warmStarting=!0,Re.m_continuousPhysics=!0,this.m_allowSleep=vo,this.m_gravity=Do,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var ho=new ve;this.m_groundBody=this.CreateBody(ho)},Re.prototype.SetDestructionListener=function(Do){this.m_destructionListener=Do},Re.prototype.SetContactFilter=function(Do){this.m_contactManager.m_contactFilter=Do},Re.prototype.SetContactListener=function(Do){this.m_contactManager.m_contactListener=Do},Re.prototype.SetDebugDraw=function(Do){this.m_debugDraw=Do},Re.prototype.SetBroadPhase=function(Do){var vo=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=Do;for(var ho=this.m_bodyList;ho;ho=ho.m_next)for(var Bo=ho.m_fixtureList;Bo;Bo=Bo.m_next)Bo.m_proxy=Do.CreateProxy(vo.GetFatAABB(Bo.m_proxy),Bo)},Re.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},Re.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},Re.prototype.CreateBody=function(Do){if(!0==this.IsLocked())return null;var vo=new De(Do,this);return vo.m_prev=null,vo.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=vo),this.m_bodyList=vo,++this.m_bodyCount,vo},Re.prototype.DestroyBody=function(Do){if(!0!=this.IsLocked()){for(var vo=Do.m_jointList,ho;vo;)ho=vo,vo=vo.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(ho.joint),this.DestroyJoint(ho.joint);for(var Bo=Do.m_controllerList,Vo;Bo;)Vo=Bo,Bo=Bo.nextController,Vo.controller.RemoveBody(Do);for(var Mo=Do.m_contactList,wo;Mo;)wo=Mo,Mo=Mo.next,this.m_contactManager.Destroy(wo.contact);Do.m_contactList=null;for(var Io=Do.m_fixtureList,Go;Io;)Go=Io,Io=Io.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(Go),Go.DestroyProxy(this.m_contactManager.m_broadPhase),Go.Destroy();Do.m_fixtureList=null,Do.m_fixtureCount=0,Do.m_prev&&(Do.m_prev.m_next=Do.m_next),Do.m_next&&(Do.m_next.m_prev=Do.m_prev),Do==this.m_bodyList&&(this.m_bodyList=Do.m_next),--this.m_bodyCount}},Re.prototype.CreateJoint=function(Do){var vo=ao.Create(Do,null);vo.m_prev=null,vo.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=vo),this.m_jointList=vo,++this.m_jointCount,vo.m_edgeA.joint=vo,vo.m_edgeA.other=vo.m_bodyB,vo.m_edgeA.prev=null,vo.m_edgeA.next=vo.m_bodyA.m_jointList,vo.m_bodyA.m_jointList&&(vo.m_bodyA.m_jointList.prev=vo.m_edgeA),vo.m_bodyA.m_jointList=vo.m_edgeA,vo.m_edgeB.joint=vo,vo.m_edgeB.other=vo.m_bodyA,vo.m_edgeB.prev=null,vo.m_edgeB.next=vo.m_bodyB.m_jointList,vo.m_bodyB.m_jointList&&(vo.m_bodyB.m_jointList.prev=vo.m_edgeB),vo.m_bodyB.m_jointList=vo.m_edgeB;var ho=Do.bodyA,Bo=Do.bodyB;if(!1==Do.collideConnected)for(var Vo=Bo.GetContactList();Vo;)Vo.other==ho&&Vo.contact.FlagForFiltering(),Vo=Vo.next;return vo},Re.prototype.DestroyJoint=function(Do){var vo=Do.m_collideConnected;Do.m_prev&&(Do.m_prev.m_next=Do.m_next),Do.m_next&&(Do.m_next.m_prev=Do.m_prev),Do==this.m_jointList&&(this.m_jointList=Do.m_next);var ho=Do.m_bodyA,Bo=Do.m_bodyB;if(ho.SetAwake(!0),Bo.SetAwake(!0),Do.m_edgeA.prev&&(Do.m_edgeA.prev.next=Do.m_edgeA.next),Do.m_edgeA.next&&(Do.m_edgeA.next.prev=Do.m_edgeA.prev),Do.m_edgeA==ho.m_jointList&&(ho.m_jointList=Do.m_edgeA.next),Do.m_edgeA.prev=null,Do.m_edgeA.next=null,Do.m_edgeB.prev&&(Do.m_edgeB.prev.next=Do.m_edgeB.next),Do.m_edgeB.next&&(Do.m_edgeB.next.prev=Do.m_edgeB.prev),Do.m_edgeB==Bo.m_jointList&&(Bo.m_jointList=Do.m_edgeB.next),Do.m_edgeB.prev=null,Do.m_edgeB.next=null,ao.Destroy(Do,null),--this.m_jointCount,!1==vo)for(var Vo=Bo.GetContactList();Vo;)Vo.other==ho&&Vo.contact.FlagForFiltering(),Vo=Vo.next},Re.prototype.AddController=function(Do){return Do.m_next=this.m_controllerList,Do.m_prev=null,this.m_controllerList=Do,Do.m_world=this,this.m_controllerCount++,Do},Re.prototype.RemoveController=function(Do){Do.m_prev&&(Do.m_prev.m_next=Do.m_next),Do.m_next&&(Do.m_next.m_prev=Do.m_prev),this.m_controllerList==Do&&(this.m_controllerList=Do.m_next),this.m_controllerCount--},Re.prototype.CreateController=function(Do){if(Do.m_world!=this)throw new Error("Controller can only be a member of one world");return Do.m_next=this.m_controllerList,Do.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=Do),this.m_controllerList=Do,++this.m_controllerCount,Do.m_world=this,Do},Re.prototype.DestroyController=function(Do){Do.Clear(),Do.m_next&&(Do.m_next.m_prev=Do.m_prev),Do.m_prev&&(Do.m_prev.m_next=Do.m_next),Do==this.m_controllerList&&(this.m_controllerList=Do.m_next),--this.m_controllerCount},Re.prototype.SetWarmStarting=function(Do){Re.m_warmStarting=Do},Re.prototype.SetContinuousPhysics=function(Do){Re.m_continuousPhysics=Do},Re.prototype.GetBodyCount=function(){return this.m_bodyCount},Re.prototype.GetJointCount=function(){return this.m_jointCount},Re.prototype.GetContactCount=function(){return this.m_contactCount},Re.prototype.SetGravity=function(Do){this.m_gravity=Do},Re.prototype.GetGravity=function(){return this.m_gravity},Re.prototype.GetGroundBody=function(){return this.m_groundBody},Re.prototype.Step=function(Do,vo,ho){Do===void 0&&(Do=0),vo===void 0&&(vo=0),ho===void 0&&(ho=0),this.m_flags&Re.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~Re.e_newFixture),this.m_flags|=Re.e_locked;var Bo=Re.s_timestep2;Bo.dt=Do,Bo.velocityIterations=vo,Bo.positionIterations=ho,Bo.inv_dt=0<Do?1/Do:0,Bo.dtRatio=this.m_inv_dt0*Do,Bo.warmStarting=Re.m_warmStarting,this.m_contactManager.Collide(),0<Bo.dt&&this.Solve(Bo),Re.m_continuousPhysics&&0<Bo.dt&&this.SolveTOI(Bo),0<Bo.dt&&(this.m_inv_dt0=Bo.inv_dt),this.m_flags&=~Re.e_locked},Re.prototype.ClearForces=function(){for(var Do=this.m_bodyList;Do;Do=Do.m_next)Do.m_force.SetZero(),Do.m_torque=0},Re.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var Do=this.m_debugDraw.GetFlags(),Io=new M,Go=new M,Lo=new M,Fo=new F,Po=new F,Ro=[new M,new M,new M,new M],To=new G(0,0,0),ho,Bo,Vo,Mo,wo,Jo;if(Do&we.e_shapeBit)for(ho=this.m_bodyList;ho;ho=ho.m_next)for(Jo=ho.m_xf,Bo=ho.GetFixtureList();Bo;Bo=Bo.m_next)Vo=Bo.GetShape(),!1==ho.IsActive()?(To.Set(0.5,0.5,0.3),this.DrawShape(Vo,Jo,To)):ho.GetType()==De.b2_staticBody?(To.Set(0.5,0.9,0.5),this.DrawShape(Vo,Jo,To)):ho.GetType()==De.b2_kinematicBody?(To.Set(0.5,0.5,0.9),this.DrawShape(Vo,Jo,To)):!1==ho.IsAwake()?(To.Set(0.6,0.6,0.6),this.DrawShape(Vo,Jo,To)):(To.Set(0.9,0.7,0.7),this.DrawShape(Vo,Jo,To));if(Do&we.e_jointBit)for(Mo=this.m_jointList;Mo;Mo=Mo.m_next)this.DrawJoint(Mo);if(Do&we.e_controllerBit)for(var zo=this.m_controllerList;zo;zo=zo.m_next)zo.Draw(this.m_debugDraw);if(Do&we.e_pairBit){To.Set(0.3,0.9,0.9);for(var Eo=this.m_contactManager.m_contactList;Eo;Eo=Eo.GetNext()){var ko=Eo.GetFixtureA(),No=Eo.GetFixtureB(),jo=ko.GetAABB().GetCenter(),Uo=No.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(jo,Uo,To)}}if(Do&we.e_aabbBit)for(wo=this.m_contactManager.m_broadPhase,Ro=[new M,new M,new M,new M],ho=this.m_bodyList;ho;ho=ho.GetNext())if(!1!=ho.IsActive())for(Bo=ho.GetFixtureList();Bo;Bo=Bo.GetNext()){var qo=wo.GetFatAABB(Bo.m_proxy);Ro[0].Set(qo.lowerBound.x,qo.lowerBound.y),Ro[1].Set(qo.upperBound.x,qo.lowerBound.y),Ro[2].Set(qo.upperBound.x,qo.upperBound.y),Ro[3].Set(qo.lowerBound.x,qo.upperBound.y),this.m_debugDraw.DrawPolygon(Ro,4,To)}if(Do&we.e_centerOfMassBit)for(ho=this.m_bodyList;ho;ho=ho.m_next)Jo=Re.s_xf,Jo.R=ho.m_xf.R,Jo.position=ho.GetWorldCenter(),this.m_debugDraw.DrawTransform(Jo)}},Re.prototype.QueryAABB=function(Do,vo){var Bo=this,Vo=Bo.m_contactManager.m_broadPhase;Vo.Query(function(Mo){return Do(Vo.GetUserData(Mo))},vo)},Re.prototype.QueryShape=function(Do,vo,ho){var Vo=this;ho===void 0&&(ho=null),null==ho&&(ho=new V,ho.SetIdentity());var Mo=Vo.m_contactManager.m_broadPhase;var wo=new F;vo.ComputeAABB(wo,ho),Mo.Query(function(Io){var Go=Mo.GetUserData(Io)instanceof Le?Mo.GetUserData(Io):null;return!ge.TestOverlap(vo,ho,Go.GetShape(),Go.GetBody().GetTransform())||Do(Go)},wo)},Re.prototype.QueryPoint=function(Do,vo){var Bo=this,Vo=Bo.m_contactManager.m_broadPhase;var Mo=new F;Mo.lowerBound.Set(vo.x-J.b2_linearSlop,vo.y-J.b2_linearSlop),Mo.upperBound.Set(vo.x+J.b2_linearSlop,vo.y+J.b2_linearSlop),Vo.Query(function(wo){var Io=Vo.GetUserData(wo)instanceof Le?Vo.GetUserData(wo):null;return!Io.TestPoint(vo)||Do(Io)},Mo)},Re.prototype.RayCast=function(Do,vo,ho){var Vo=this,Mo=Vo.m_contactManager.m_broadPhase,wo=new ie;var Io=new ne(vo,ho);Mo.RayCast(function(Go,Lo){var Jo=Mo.GetUserData(Lo),Fo=Jo instanceof Le?Jo:null,Po=Fo.RayCast(wo,Go);if(Po){var Ro=wo.fraction,To=new M((1-Ro)*vo.x+Ro*ho.x,(1-Ro)*vo.y+Ro*ho.y);return Do(Fo,To,wo.normal,Ro)}return Go.maxFraction},Io)},Re.prototype.RayCastOne=function(Do,vo){var Bo=this,Vo;return Bo.RayCast(function(Mo,wo,Io,Go){return void 0===Go&&(Go=0),Vo=Mo,Go},Do,vo),Vo},Re.prototype.RayCastAll=function(Do,vo){var Bo=this,Vo=new Vector;return Bo.RayCast(function(Mo,wo,Io,Go){return void 0===Go&&(Go=0),Vo[Vo.length]=Mo,1},Do,vo),Vo},Re.prototype.GetBodyList=function(){return this.m_bodyList},Re.prototype.GetJointList=function(){return this.m_jointList},Re.prototype.GetContactList=function(){return this.m_contactList},Re.prototype.IsLocked=function(){return 0<(this.m_flags&Re.e_locked)},Re.prototype.Solve=function(Do){for(var ho=this.m_controllerList,vo;ho;ho=ho.m_next)ho.Step(Do);var Bo=this.m_island;for(Bo.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),vo=this.m_bodyList;vo;vo=vo.m_next)vo.m_flags&=~De.e_islandFlag;for(var Vo=this.m_contactList;Vo;Vo=Vo.m_next)Vo.m_flags&=~ze.e_islandFlag;for(var Mo=this.m_jointList;Mo;Mo=Mo.m_next)Mo.m_islandFlag=!1;for(var wo=parseInt(this.m_bodyCount),Io=this.s_stack,Go=this.m_bodyList;Go;Go=Go.m_next)if(!(Go.m_flags&De.e_islandFlag)&&!1!=Go.IsAwake()&&!1!=Go.IsActive()&&Go.GetType()!=De.b2_staticBody){Bo.Clear();var Lo=0;for(Io[Lo++]=Go,Go.m_flags|=De.e_islandFlag;0<Lo;)if(vo=Io[--Lo],Bo.AddBody(vo),!1==vo.IsAwake()&&vo.SetAwake(!0),vo.GetType()!=De.b2_staticBody){for(var Fo=vo.m_contactList,Jo;Fo;Fo=Fo.next)Fo.contact.m_flags&ze.e_islandFlag||!0!=Fo.contact.IsSensor()&&!1!=Fo.contact.IsEnabled()&&!1!=Fo.contact.IsTouching()&&(Bo.AddContact(Fo.contact),Fo.contact.m_flags|=ze.e_islandFlag,Jo=Fo.other,!(Jo.m_flags&De.e_islandFlag))&&(Io[Lo++]=Jo,Jo.m_flags|=De.e_islandFlag);for(var Po=vo.m_jointList;Po;Po=Po.next)!0!=Po.joint.m_islandFlag&&(Jo=Po.other,!1!=Jo.IsActive())&&(Bo.AddJoint(Po.joint),Po.joint.m_islandFlag=!0,!(Jo.m_flags&De.e_islandFlag))&&(Io[Lo++]=Jo,Jo.m_flags|=De.e_islandFlag)}Bo.Solve(Do,this.m_gravity,this.m_allowSleep);for(var Ro=0;Ro<Bo.m_bodyCount;++Ro)vo=Bo.m_bodies[Ro],vo.GetType()==De.b2_staticBody&&(vo.m_flags&=~De.e_islandFlag)}for(Ro=0;Ro<Io.length&&!!Io[Ro];++Ro)Io[Ro]=null;for(vo=this.m_bodyList;vo;vo=vo.m_next)!1!=vo.IsAwake()&&!1!=vo.IsActive()&&vo.GetType()!=De.b2_staticBody&&vo.SynchronizeFixtures();this.m_contactManager.FindNewContacts()},Re.prototype.SolveTOI=function(Do){var vo,ho,Bo,Vo,Mo,wo,Io,Go=this.m_island;Go.Initialize(this.m_bodyCount,J.b2_maxTOIContactsPerIsland,J.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var Lo=Re.s_queue;for(vo=this.m_bodyList;vo;vo=vo.m_next)vo.m_flags&=~De.e_islandFlag,vo.m_sweep.t0=0;var Jo;for(Jo=this.m_contactList;Jo;Jo=Jo.m_next)Jo.m_flags&=~(ze.e_toiFlag|ze.e_islandFlag);for(Io=this.m_jointList;Io;Io=Io.m_next)Io.m_islandFlag=!1;for(;;){var Fo=null,Po=1;for(Jo=this.m_contactList;Jo;Jo=Jo.m_next)if(!0!=Jo.IsSensor()&&!1!=Jo.IsEnabled()&&!1!=Jo.IsContinuous()){var Ro=1;if(Jo.m_flags&ze.e_toiFlag)Ro=Jo.m_toi;else{if(ho=Jo.m_fixtureA,Bo=Jo.m_fixtureB,Vo=ho.m_body,Mo=Bo.m_body,(Vo.GetType()!=De.b2_dynamicBody||!1==Vo.IsAwake())&&(Mo.GetType()!=De.b2_dynamicBody||!1==Mo.IsAwake()))continue;var To=Vo.m_sweep.t0;Vo.m_sweep.t0<Mo.m_sweep.t0?(To=Mo.m_sweep.t0,Vo.m_sweep.Advance(To)):Mo.m_sweep.t0<Vo.m_sweep.t0&&(To=Vo.m_sweep.t0,Mo.m_sweep.Advance(To)),Ro=Jo.ComputeTOI(Vo.m_sweep,Mo.m_sweep),J.b2Assert(0<=Ro&&1>=Ro),0<Ro&&1>Ro&&(Ro=(1-Ro)*To+Ro,1<Ro&&(Ro=1)),Jo.m_toi=Ro,Jo.m_flags|=ze.e_toiFlag}Number.MIN_VALUE<Ro&&Ro<Po&&(Fo=Jo,Po=Ro)}if(null==Fo||1-100*Number.MIN_VALUE<Po)break;if(ho=Fo.m_fixtureA,Bo=Fo.m_fixtureB,Vo=ho.m_body,Mo=Bo.m_body,Re.s_backupA.Set(Vo.m_sweep),Re.s_backupB.Set(Mo.m_sweep),Vo.Advance(Po),Mo.Advance(Po),Fo.Update(this.m_contactManager.m_contactListener),Fo.m_flags&=~ze.e_toiFlag,!0==Fo.IsSensor()||!1==Fo.IsEnabled()){Vo.m_sweep.Set(Re.s_backupA),Mo.m_sweep.Set(Re.s_backupB),Vo.SynchronizeTransform(),Mo.SynchronizeTransform();continue}if(!1!=Fo.IsTouching()){var zo=Vo;zo.GetType()!=De.b2_dynamicBody&&(zo=Mo),Go.Clear();var Eo=0,ko=0;for(Lo[Eo+ko++]=zo,zo.m_flags|=De.e_islandFlag;0<ko;)if(vo=Lo[Eo++],--ko,Go.AddBody(vo),!1==vo.IsAwake()&&vo.SetAwake(!0),vo.GetType()==De.b2_dynamicBody){for(wo=vo.m_contactList;wo&&Go.m_contactCount!=Go.m_contactCapacity;wo=wo.next)if(!(wo.contact.m_flags&ze.e_islandFlag)&&!0!=wo.contact.IsSensor()&&!1!=wo.contact.IsEnabled()&&!1!=wo.contact.IsTouching()){Go.AddContact(wo.contact),wo.contact.m_flags|=ze.e_islandFlag;var No=wo.other;No.m_flags&De.e_islandFlag||(No.GetType()!=De.b2_staticBody&&(No.Advance(Po),No.SetAwake(!0)),Lo[Eo+ko]=No,++ko,No.m_flags|=De.e_islandFlag)}for(var jo=vo.m_jointList;jo;jo=jo.next)if(Go.m_jointCount!=Go.m_jointCapacity&&!0!=jo.joint.m_islandFlag){if(No=jo.other,!1==No.IsActive())continue;Go.AddJoint(jo.joint),jo.joint.m_islandFlag=!0,No.m_flags&De.e_islandFlag||(No.GetType()!=De.b2_staticBody&&(No.Advance(Po),No.SetAwake(!0)),Lo[Eo+ko]=No,++ko,No.m_flags|=De.e_islandFlag)}}var Uo=Re.s_timestep;Uo.warmStarting=!1,Uo.dt=(1-Po)*Do.dt,Uo.inv_dt=1/Uo.dt,Uo.dtRatio=0,Uo.velocityIterations=Do.velocityIterations,Uo.positionIterations=Do.positionIterations,Go.SolveTOI(Uo);var qo=0;for(qo=0;qo<Go.m_bodyCount;++qo)if((vo=Go.m_bodies[qo],vo.m_flags&=~De.e_islandFlag,!1!=vo.IsAwake())&&vo.GetType()==De.b2_dynamicBody)for(vo.SynchronizeFixtures(),wo=vo.m_contactList;wo;wo=wo.next)wo.contact.m_flags&=~ze.e_toiFlag;for(qo=0;qo<Go.m_contactCount;++qo)Jo=Go.m_contacts[qo],Jo.m_flags&=~(ze.e_toiFlag|ze.e_islandFlag);for(qo=0;qo<Go.m_jointCount;++qo)Io=Go.m_joints[qo],Io.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}},Re.prototype.DrawJoint=function(Do){var vo=Do.GetBodyA(),ho=Do.GetBodyB(),Bo=vo.m_xf,Vo=ho.m_xf,Mo=Bo.position,wo=Vo.position,Io=Do.GetAnchorA(),Go=Do.GetAnchorB(),Lo=Re.s_jointColor;switch(Do.m_type){case ao.e_distanceJoint:this.m_debugDraw.DrawSegment(Io,Go,Lo);break;case ao.e_pulleyJoint:{var Jo=Do instanceof bo?Do:null,Fo=Jo.GetGroundAnchorA(),Po=Jo.GetGroundAnchorB();this.m_debugDraw.DrawSegment(Fo,Io,Lo),this.m_debugDraw.DrawSegment(Po,Go,Lo),this.m_debugDraw.DrawSegment(Fo,Po,Lo)}break;case ao.e_mouseJoint:this.m_debugDraw.DrawSegment(Io,Go,Lo);break;default:vo!=this.m_groundBody&&this.m_debugDraw.DrawSegment(Mo,Io,Lo),this.m_debugDraw.DrawSegment(Io,Go,Lo),ho!=this.m_groundBody&&this.m_debugDraw.DrawSegment(wo,Go,Lo);}},Re.prototype.DrawShape=function(Do,vo,ho){switch(Do.m_type){case ge.e_circleShape:{var Bo=Do instanceof be?Do:null,Vo=S.MulX(vo,Bo.m_p),Mo=Bo.m_radius,wo=vo.R.col1;this.m_debugDraw.DrawSolidCircle(Vo,Mo,wo,ho)}break;case ge.e_polygonShape:{var Io=0,Go=Do instanceof Se?Do:null,Lo=parseInt(Go.GetVertexCount()),Jo=Go.GetVertices(),Fo=new Vector(Lo);for(Io=0;Io<Lo;++Io)Fo[Io]=S.MulX(vo,Jo[Io]);this.m_debugDraw.DrawSolidPolygon(Fo,Lo,ho)}break;case ge.e_edgeShape:{var Po=Do instanceof fe?Do:null;this.m_debugDraw.DrawSegment(S.MulX(vo,Po.GetVertex1()),S.MulX(vo,Po.GetVertex2()),ho)}}},Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new Pe,Box2D.Dynamics.b2World.s_xf=new V,Box2D.Dynamics.b2World.s_backupA=new g,Box2D.Dynamics.b2World.s_backupB=new g,Box2D.Dynamics.b2World.s_timestep=new Pe,Box2D.Dynamics.b2World.s_queue=new Vector,Box2D.Dynamics.b2World.s_jointColor=new G(0.5,0.8,0.8),Box2D.Dynamics.b2World.e_newFixture=1,Box2D.Dynamics.b2World.e_locked=2})}(),function(){var o=Box2D.Collision.Shapes.b2CircleShape,n=Box2D.Collision.Shapes.b2EdgeChainDef,_=Box2D.Collision.Shapes.b2EdgeShape,S=Box2D.Collision.Shapes.b2MassData,g=Box2D.Collision.Shapes.b2PolygonShape,V=Box2D.Collision.Shapes.b2Shape,M=Box2D.Dynamics.Contacts.b2CircleContact,w=Box2D.Dynamics.Contacts.b2Contact,G=Box2D.Dynamics.Contacts.b2ContactConstraint,L=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,J=Box2D.Dynamics.Contacts.b2ContactEdge,F=Box2D.Dynamics.Contacts.b2ContactFactory,R=Box2D.Dynamics.Contacts.b2ContactRegister,E=Box2D.Dynamics.Contacts.b2ContactResult,N=Box2D.Dynamics.Contacts.b2ContactSolver,U=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,q=Box2D.Dynamics.Contacts.b2NullContact,W=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,O=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,X=Box2D.Dynamics.Contacts.b2PolygonContact,Z=Box2D.Dynamics.Contacts.b2PositionSolverManifold,H=Box2D.Dynamics.b2Body,Y=Box2D.Dynamics.b2BodyDef,Q=Box2D.Dynamics.b2ContactFilter,$=Box2D.Dynamics.b2ContactImpulse,ee=Box2D.Dynamics.b2ContactListener,oe=Box2D.Dynamics.b2ContactManager,te=Box2D.Dynamics.b2DebugDraw,ne=Box2D.Dynamics.b2DestructionListener,ie=Box2D.Dynamics.b2FilterData,me=Box2D.Dynamics.b2Fixture,ae=Box2D.Dynamics.b2FixtureDef,le=Box2D.Dynamics.b2Island,re=Box2D.Dynamics.b2TimeStep,se=Box2D.Dynamics.b2World,_e=Box2D.Common.b2Color,pe=Box2D.Common.b2internal,ye=Box2D.Common.b2Settings,xe=Box2D.Common.Math.b2Mat22,ue=Box2D.Common.Math.b2Mat33,de=Box2D.Common.Math.b2Math,be=Box2D.Common.Math.b2Sweep,Ce=Box2D.Common.Math.b2Transform,fe=Box2D.Common.Math.b2Vec2,Ae=Box2D.Common.Math.b2Vec3,Se=Box2D.Collision.b2AABB,ge=Box2D.Collision.b2Bound,De=Box2D.Collision.b2BoundValues,ve=Box2D.Collision.b2Collision,he=Box2D.Collision.b2ContactID,Be=Box2D.Collision.b2ContactPoint,Ve=Box2D.Collision.b2Distance,Me=Box2D.Collision.b2DistanceInput,we=Box2D.Collision.b2DistanceOutput,Ie=Box2D.Collision.b2DistanceProxy,Ge=Box2D.Collision.b2DynamicTree,Le=Box2D.Collision.b2DynamicTreeBroadPhase,Je=Box2D.Collision.b2DynamicTreeNode,Fe=Box2D.Collision.b2DynamicTreePair,Pe=Box2D.Collision.b2Manifold,Re=Box2D.Collision.b2ManifoldPoint,Te=Box2D.Collision.b2Point,ze=Box2D.Collision.b2RayCastInput,Ee=Box2D.Collision.b2RayCastOutput,ke=Box2D.Collision.b2Segment,Ne=Box2D.Collision.b2SeparationFunction,je=Box2D.Collision.b2Simplex,Ue=Box2D.Collision.b2SimplexCache,qe=Box2D.Collision.b2SimplexVertex,Ke=Box2D.Collision.b2TimeOfImpact,We=Box2D.Collision.b2TOIInput,Oe=Box2D.Collision.b2WorldManifold,Xe=Box2D.Collision.ClipVertex,Ze=Box2D.Collision.Features,He=Box2D.Collision.IBroadPhase;Box2D.inherit(M,Box2D.Dynamics.Contacts.b2Contact),M.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,M.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},M.Create=function(){return new M},M.Destroy=function(){},M.prototype.Reset=function(Ye,Qe){this.__super.Reset.call(this,Ye,Qe)},M.prototype.Evaluate=function(){var Ye=this.m_fixtureA.GetBody(),Qe=this.m_fixtureB.GetBody();ve.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof o?this.m_fixtureA.GetShape():null,Ye.m_xf,this.m_fixtureB.GetShape()instanceof o?this.m_fixtureB.GetShape():null,Qe.m_xf)},w.b2Contact=function(){this.m_nodeA=new J,this.m_nodeB=new J,this.m_manifold=new Pe,this.m_oldManifold=new Pe},w.prototype.GetManifold=function(){return this.m_manifold},w.prototype.GetWorldManifold=function(Ye){var Qe=this.m_fixtureA.GetBody(),$e=this.m_fixtureB.GetBody(),eo=this.m_fixtureA.GetShape(),oo=this.m_fixtureB.GetShape();Ye.Initialize(this.m_manifold,Qe.GetTransform(),eo.m_radius,$e.GetTransform(),oo.m_radius)},w.prototype.IsTouching=function(){return(this.m_flags&w.e_touchingFlag)==w.e_touchingFlag},w.prototype.IsContinuous=function(){return(this.m_flags&w.e_continuousFlag)==w.e_continuousFlag},w.prototype.SetSensor=function(Ye){Ye?this.m_flags|=w.e_sensorFlag:this.m_flags&=~w.e_sensorFlag},w.prototype.IsSensor=function(){return(this.m_flags&w.e_sensorFlag)==w.e_sensorFlag},w.prototype.SetEnabled=function(Ye){Ye?this.m_flags|=w.e_enabledFlag:this.m_flags&=~w.e_enabledFlag},w.prototype.IsEnabled=function(){return(this.m_flags&w.e_enabledFlag)==w.e_enabledFlag},w.prototype.GetNext=function(){return this.m_next},w.prototype.GetFixtureA=function(){return this.m_fixtureA},w.prototype.GetFixtureB=function(){return this.m_fixtureB},w.prototype.FlagForFiltering=function(){this.m_flags|=w.e_filterFlag},w.prototype.b2Contact=function(){},w.prototype.Reset=function(Ye,Qe){if(void 0===Ye&&(Ye=null),void 0===Qe&&(Qe=null),this.m_flags=w.e_enabledFlag,!Ye||!Qe)return this.m_fixtureA=null,void(this.m_fixtureB=null);(Ye.IsSensor()||Qe.IsSensor())&&(this.m_flags|=w.e_sensorFlag);var $e=Ye.GetBody(),eo=Qe.GetBody();($e.GetType()!=H.b2_dynamicBody||$e.IsBullet()||eo.GetType()!=H.b2_dynamicBody||eo.IsBullet())&&(this.m_flags|=w.e_continuousFlag),this.m_fixtureA=Ye,this.m_fixtureB=Qe,this.m_manifold.m_pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null},w.prototype.Update=function(Ye){var Qe=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=Qe,this.m_flags|=w.e_enabledFlag;var $e=!1,eo=(this.m_flags&w.e_touchingFlag)==w.e_touchingFlag,oo=this.m_fixtureA.m_body,to=this.m_fixtureB.m_body,no=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&w.e_sensorFlag){if(no){var io=this.m_fixtureA.GetShape(),mo=this.m_fixtureB.GetShape(),ao=oo.GetTransform(),ro=to.GetTransform();$e=V.TestOverlap(io,ao,mo,ro)}this.m_manifold.m_pointCount=0}else{if(oo.GetType()!=H.b2_dynamicBody||oo.IsBullet()||to.GetType()!=H.b2_dynamicBody||to.IsBullet()?this.m_flags|=w.e_continuousFlag:this.m_flags&=~w.e_continuousFlag,no){this.Evaluate(),$e=0<this.m_manifold.m_pointCount;for(var so=0,_o;so<this.m_manifold.m_pointCount;++so){_o=this.m_manifold.m_points[so],_o.m_normalImpulse=0,_o.m_tangentImpulse=0;for(var po=_o.m_id,co=0,yo;co<this.m_oldManifold.m_pointCount;++co)if(yo=this.m_oldManifold.m_points[co],yo.m_id.key==po.key){_o.m_normalImpulse=yo.m_normalImpulse,_o.m_tangentImpulse=yo.m_tangentImpulse;break}}}else this.m_manifold.m_pointCount=0;$e!=eo&&(oo.SetAwake(!0),to.SetAwake(!0))}$e?this.m_flags|=w.e_touchingFlag:this.m_flags&=~w.e_touchingFlag,!1==eo&&!0==$e&&Ye.BeginContact(this),!0==eo&&!1==$e&&Ye.EndContact(this),0==(this.m_flags&w.e_sensorFlag)&&Ye.PreSolve(this,this.m_oldManifold)},w.prototype.Evaluate=function(){},w.prototype.ComputeTOI=function(Ye,Qe){return w.s_input.proxyA.Set(this.m_fixtureA.GetShape()),w.s_input.proxyB.Set(this.m_fixtureB.GetShape()),w.s_input.sweepA=Ye,w.s_input.sweepB=Qe,w.s_input.tolerance=ye.b2_linearSlop,Ke.TimeOfImpact(w.s_input)},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1,Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2,Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4,Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8,Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16,Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32,Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64,Box2D.Dynamics.Contacts.b2Contact.s_input=new We}),G.b2ContactConstraint=function(){this.localPlaneNormal=new fe,this.localPoint=new fe,this.normal=new fe,this.normalMass=new xe,this.K=new xe},G.prototype.b2ContactConstraint=function(){this.points=new Vector(ye.b2_maxManifoldPoints);for(var Ye=0;Ye<ye.b2_maxManifoldPoints;Ye++)this.points[Ye]=new L},L.b2ContactConstraintPoint=function(){this.localPoint=new fe,this.rA=new fe,this.rB=new fe},J.b2ContactEdge=function(){},F.b2ContactFactory=function(){},F.prototype.b2ContactFactory=function(Ye){this.m_allocator=Ye,this.InitializeRegisters()},F.prototype.AddType=function(Ye,Qe,$e,eo){$e===void 0&&($e=0),eo===void 0&&(eo=0),this.m_registers[$e][eo].createFcn=Ye,this.m_registers[$e][eo].destroyFcn=Qe,this.m_registers[$e][eo].primary=!0,$e!=eo&&(this.m_registers[eo][$e].createFcn=Ye,this.m_registers[eo][$e].destroyFcn=Qe,this.m_registers[eo][$e].primary=!1)},F.prototype.InitializeRegisters=function(){this.m_registers=new Vector(V.e_shapeTypeCount);for(var Ye=0;Ye<V.e_shapeTypeCount;Ye++){this.m_registers[Ye]=new Vector(V.e_shapeTypeCount);for(var Qe=0;Qe<V.e_shapeTypeCount;Qe++)this.m_registers[Ye][Qe]=new R}this.AddType(M.Create,M.Destroy,V.e_circleShape,V.e_circleShape),this.AddType(W.Create,W.Destroy,V.e_polygonShape,V.e_circleShape),this.AddType(X.Create,X.Destroy,V.e_polygonShape,V.e_polygonShape),this.AddType(U.Create,U.Destroy,V.e_edgeShape,V.e_circleShape),this.AddType(O.Create,O.Destroy,V.e_polygonShape,V.e_edgeShape)},F.prototype.Create=function(Ye,Qe){var $e=parseInt(Ye.GetType()),eo=parseInt(Qe.GetType()),oo=this.m_registers[$e][eo],to;if(oo.pool)return to=oo.pool,oo.pool=to.m_next,oo.poolCount--,to.Reset(Ye,Qe),to;var no=oo.createFcn;return null==no?null:oo.primary?(to=no(this.m_allocator),to.Reset(Ye,Qe),to):(to=no(this.m_allocator),to.Reset(Qe,Ye),to)},F.prototype.Destroy=function(Ye){0<Ye.m_manifold.m_pointCount&&(Ye.m_fixtureA.m_body.SetAwake(!0),Ye.m_fixtureB.m_body.SetAwake(!0));var Qe=parseInt(Ye.m_fixtureA.GetType()),$e=parseInt(Ye.m_fixtureB.GetType()),eo=this.m_registers[Qe][$e];eo.poolCount++,Ye.m_next=eo.pool,eo.pool=Ye;var oo=eo.destroyFcn;oo(Ye,this.m_allocator)},R.b2ContactRegister=function(){},E.b2ContactResult=function(){this.position=new fe,this.normal=new fe,this.id=new he},N.b2ContactSolver=function(){this.m_step=new re,this.m_constraints=new Vector},N.prototype.b2ContactSolver=function(){},N.prototype.Initialize=function(Ye,Qe,$e,eo){$e===void 0&&($e=0);var oo;this.m_step.Set(Ye),this.m_allocator=eo;var to=0;for(this.m_constraintCount=$e;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new G;for(to=0;to<$e;++to){oo=Qe[to];var mo=oo.m_fixtureA,ao=oo.m_fixtureB,ro=mo.m_shape,so=ao.m_shape,_o=ro.m_radius,po=so.m_radius,co=mo.m_body,yo=ao.m_body,xo=oo.GetManifold(),uo=ye.b2MixFriction(mo.GetFriction(),ao.GetFriction()),bo=ye.b2MixRestitution(mo.GetRestitution(),ao.GetRestitution()),Co=co.m_linearVelocity.x,fo=co.m_linearVelocity.y,Ao=yo.m_linearVelocity.x,So=yo.m_linearVelocity.y,go=co.m_angularVelocity,Do=yo.m_angularVelocity;ye.b2Assert(0<xo.m_pointCount),N.s_worldManifold.Initialize(xo,co.m_xf,_o,yo.m_xf,po);var vo=N.s_worldManifold.m_normal.x,ho=N.s_worldManifold.m_normal.y,Bo=this.m_constraints[to];Bo.bodyA=co,Bo.bodyB=yo,Bo.manifold=xo,Bo.normal.x=vo,Bo.normal.y=ho,Bo.pointCount=xo.m_pointCount,Bo.friction=uo,Bo.restitution=bo,Bo.localPlaneNormal.x=xo.m_localPlaneNormal.x,Bo.localPlaneNormal.y=xo.m_localPlaneNormal.y,Bo.localPoint.x=xo.m_localPoint.x,Bo.localPoint.y=xo.m_localPoint.y,Bo.radius=_o+po,Bo.type=xo.m_type;for(var Vo=0;Vo<Bo.pointCount;++Vo){var Mo=xo.m_points[Vo],wo=Bo.points[Vo];wo.normalImpulse=Mo.m_normalImpulse,wo.tangentImpulse=Mo.m_tangentImpulse,wo.localPoint.SetV(Mo.m_localPoint);var Io=wo.rA.x=N.s_worldManifold.m_points[Vo].x-co.m_sweep.c.x,Go=wo.rA.y=N.s_worldManifold.m_points[Vo].y-co.m_sweep.c.y,Lo=wo.rB.x=N.s_worldManifold.m_points[Vo].x-yo.m_sweep.c.x,Jo=wo.rB.y=N.s_worldManifold.m_points[Vo].y-yo.m_sweep.c.y,Fo=Io*ho-Go*vo,Po=Lo*ho-Jo*vo;Fo*=Fo,Po*=Po;var Ro=co.m_invMass+yo.m_invMass+co.m_invI*Fo+yo.m_invI*Po;wo.normalMass=1/Ro;var To=co.m_mass*co.m_invMass+yo.m_mass*yo.m_invMass;To+=co.m_mass*co.m_invI*Fo+yo.m_mass*yo.m_invI*Po,wo.equalizedMass=1/To;var zo=ho,Eo=-vo,ko=Io*Eo-Go*zo,No=Lo*Eo-Jo*zo;ko*=ko,No*=No;var jo=co.m_invMass+yo.m_invMass+co.m_invI*ko+yo.m_invI*No;wo.tangentMass=1/jo,wo.velocityBias=0;var Ko=Bo.normal.x*(Ao+-Do*Jo-Co- -go*Go)+Bo.normal.y*(So+Do*Lo-fo-go*Io);Ko<-ye.b2_velocityThreshold&&(wo.velocityBias+=-Bo.restitution*Ko)}if(2==Bo.pointCount){var Wo=Bo.points[0],Oo=Bo.points[1],Xo=co.m_invMass,Zo=co.m_invI,Ho=yo.m_invMass,Yo=yo.m_invI,Qo=Wo.rA.x*ho-Wo.rA.y*vo,$o=Wo.rB.x*ho-Wo.rB.y*vo,et=Oo.rA.x*ho-Oo.rA.y*vo,ot=Oo.rB.x*ho-Oo.rB.y*vo,tt=Xo+Ho+Zo*Qo*Qo+Yo*$o*$o,nt=Xo+Ho+Zo*et*et+Yo*ot*ot,it=Xo+Ho+Zo*Qo*et+Yo*$o*ot;tt*tt<100*(tt*nt-it*it)?(Bo.K.col1.Set(tt,it),Bo.K.col2.Set(it,nt),Bo.K.GetInverse(Bo.normalMass)):Bo.pointCount=1}}},N.prototype.InitVelocityConstraints=function(Ye){for(var oo=0;oo<this.m_constraintCount;++oo){var to=this.m_constraints[oo],no=to.bodyA,io=to.bodyB,mo=no.m_invMass,ao=no.m_invI,ro=io.m_invMass,so=io.m_invI,_o=to.normal.x,po=to.normal.y,uo=0,bo=0;if(Ye.warmStarting)for(bo=to.pointCount,uo=0;uo<bo;++uo){var Co=to.points[uo];Co.normalImpulse*=Ye.dtRatio,Co.tangentImpulse*=Ye.dtRatio;var fo=Co.normalImpulse*_o+Co.tangentImpulse*po,Ao=Co.normalImpulse*po+Co.tangentImpulse*-_o;no.m_angularVelocity-=ao*(Co.rA.x*Ao-Co.rA.y*fo),no.m_linearVelocity.x-=mo*fo,no.m_linearVelocity.y-=mo*Ao,io.m_angularVelocity+=so*(Co.rB.x*Ao-Co.rB.y*fo),io.m_linearVelocity.x+=ro*fo,io.m_linearVelocity.y+=ro*Ao}else for(bo=to.pointCount,uo=0;uo<bo;++uo){var So=to.points[uo];So.normalImpulse=0,So.tangentImpulse=0}}},N.prototype.SolveVelocityConstraints=function(){for(var Ye=0,no=0,io=0,mo=0,ao=0,ro=0,so=0,_o=0,po=0,co=0,yo=0,xo=0,uo=0,bo=0,Co=0,fo=0,go=0,Qe,Ao;go<this.m_constraintCount;++go){var Do=this.m_constraints[go],vo=Do.bodyA,ho=Do.bodyB,Bo=vo.m_angularVelocity,Vo=ho.m_angularVelocity,Mo=vo.m_linearVelocity,wo=ho.m_linearVelocity,Io=vo.m_invMass,Go=vo.m_invI,Lo=ho.m_invMass,Jo=ho.m_invI,Fo=Do.normal.x,Po=Do.normal.y,Ro=Po,To=-Fo,zo=Do.friction;for(Ye=0;Ye<Do.pointCount;Ye++)Qe=Do.points[Ye],no=wo.x-Vo*Qe.rB.y-Mo.x+Bo*Qe.rA.y,io=wo.y+Vo*Qe.rB.x-Mo.y-Bo*Qe.rA.x,ao=no*Ro+io*To,ro=Qe.tangentMass*-ao,so=zo*Qe.normalImpulse,_o=de.Clamp(Qe.tangentImpulse+ro,-so,so),ro=_o-Qe.tangentImpulse,po=ro*Ro,co=ro*To,Mo.x-=Io*po,Mo.y-=Io*co,Bo-=Go*(Qe.rA.x*co-Qe.rA.y*po),wo.x+=Lo*po,wo.y+=Lo*co,Vo+=Jo*(Qe.rB.x*co-Qe.rB.y*po),Qe.tangentImpulse=_o;parseInt(Do.pointCount);if(1==Do.pointCount)Qe=Do.points[0],no=wo.x+-Vo*Qe.rB.y-Mo.x- -Bo*Qe.rA.y,io=wo.y+Vo*Qe.rB.x-Mo.y-Bo*Qe.rA.x,mo=no*Fo+io*Po,ro=-Qe.normalMass*(mo-Qe.velocityBias),_o=Qe.normalImpulse+ro,_o=0<_o?_o:0,ro=_o-Qe.normalImpulse,po=ro*Fo,co=ro*Po,Mo.x-=Io*po,Mo.y-=Io*co,Bo-=Go*(Qe.rA.x*co-Qe.rA.y*po),wo.x+=Lo*po,wo.y+=Lo*co,Vo+=Jo*(Qe.rB.x*co-Qe.rB.y*po),Qe.normalImpulse=_o;else{var No=Do.points[0],jo=Do.points[1],Uo=No.normalImpulse,qo=jo.normalImpulse,Ko=wo.x-Vo*No.rB.y-Mo.x+Bo*No.rA.y,Wo=wo.y+Vo*No.rB.x-Mo.y-Bo*No.rA.x,Oo=wo.x-Vo*jo.rB.y-Mo.x+Bo*jo.rA.y,Xo=wo.y+Vo*jo.rB.x-Mo.y-Bo*jo.rA.x,Zo=Ko*Fo+Wo*Po,Ho=Oo*Fo+Xo*Po,Yo=Zo-No.velocityBias,Qo=Ho-jo.velocityBias;Ao=Do.K,Yo-=Ao.col1.x*Uo+Ao.col2.x*qo,Qo-=Ao.col1.y*Uo+Ao.col2.y*qo;for(;;){Ao=Do.normalMass;var et=-(Ao.col1.x*Yo+Ao.col2.x*Qo),ot=-(Ao.col1.y*Yo+Ao.col2.y*Qo);if(0<=et&&0<=ot){yo=et-Uo,xo=ot-qo,uo=yo*Fo,bo=yo*Po,Co=xo*Fo,fo=xo*Po,Mo.x-=Io*(uo+Co),Mo.y-=Io*(bo+fo),Bo-=Go*(No.rA.x*bo-No.rA.y*uo+jo.rA.x*fo-jo.rA.y*Co),wo.x+=Lo*(uo+Co),wo.y+=Lo*(bo+fo),Vo+=Jo*(No.rB.x*bo-No.rB.y*uo+jo.rB.x*fo-jo.rB.y*Co),No.normalImpulse=et,jo.normalImpulse=ot;break}if(et=-No.normalMass*Yo,ot=0,Zo=0,Ho=Do.K.col1.y*et+Qo,0<=et&&0<=Ho){yo=et-Uo,xo=ot-qo,uo=yo*Fo,bo=yo*Po,Co=xo*Fo,fo=xo*Po,Mo.x-=Io*(uo+Co),Mo.y-=Io*(bo+fo),Bo-=Go*(No.rA.x*bo-No.rA.y*uo+jo.rA.x*fo-jo.rA.y*Co),wo.x+=Lo*(uo+Co),wo.y+=Lo*(bo+fo),Vo+=Jo*(No.rB.x*bo-No.rB.y*uo+jo.rB.x*fo-jo.rB.y*Co),No.normalImpulse=et,jo.normalImpulse=ot;break}if(et=0,ot=-jo.normalMass*Qo,Zo=Do.K.col2.x*ot+Yo,Ho=0,0<=ot&&0<=Zo){yo=et-Uo,xo=ot-qo,uo=yo*Fo,bo=yo*Po,Co=xo*Fo,fo=xo*Po,Mo.x-=Io*(uo+Co),Mo.y-=Io*(bo+fo),Bo-=Go*(No.rA.x*bo-No.rA.y*uo+jo.rA.x*fo-jo.rA.y*Co),wo.x+=Lo*(uo+Co),wo.y+=Lo*(bo+fo),Vo+=Jo*(No.rB.x*bo-No.rB.y*uo+jo.rB.x*fo-jo.rB.y*Co),No.normalImpulse=et,jo.normalImpulse=ot;break}if(et=0,ot=0,Zo=Yo,Ho=Qo,0<=Zo&&0<=Ho){yo=et-Uo,xo=ot-qo,uo=yo*Fo,bo=yo*Po,Co=xo*Fo,fo=xo*Po,Mo.x-=Io*(uo+Co),Mo.y-=Io*(bo+fo),Bo-=Go*(No.rA.x*bo-No.rA.y*uo+jo.rA.x*fo-jo.rA.y*Co),wo.x+=Lo*(uo+Co),wo.y+=Lo*(bo+fo),Vo+=Jo*(No.rB.x*bo-No.rB.y*uo+jo.rB.x*fo-jo.rB.y*Co),No.normalImpulse=et,jo.normalImpulse=ot;break}break}}vo.m_angularVelocity=Bo,ho.m_angularVelocity=Vo}},N.prototype.FinalizeVelocityConstraints=function(){for(var Ye=0;Ye<this.m_constraintCount;++Ye)for(var Qe=this.m_constraints[Ye],$e=Qe.manifold,eo=0;eo<Qe.pointCount;++eo){var oo=$e.m_points[eo],to=Qe.points[eo];oo.m_normalImpulse=to.normalImpulse,oo.m_tangentImpulse=to.tangentImpulse}},N.prototype.SolvePositionConstraints=function(Ye){Ye===void 0&&(Ye=0);for(var Qe=0,$e=0;$e<this.m_constraintCount;$e++){var eo=this.m_constraints[$e],oo=eo.bodyA,to=eo.bodyB,no=oo.m_mass*oo.m_invMass,io=oo.m_mass*oo.m_invI,mo=to.m_mass*to.m_invMass,ao=to.m_mass*to.m_invI;N.s_psm.Initialize(eo);for(var ro=N.s_psm.m_normal,so=0;so<eo.pointCount;so++){var _o=eo.points[so],po=N.s_psm.m_points[so],co=N.s_psm.m_separations[so],yo=po.x-oo.m_sweep.c.x,xo=po.y-oo.m_sweep.c.y,uo=po.x-to.m_sweep.c.x,bo=po.y-to.m_sweep.c.y;Qe=Qe<co?Qe:co;var Co=de.Clamp(Ye*(co+ye.b2_linearSlop),-ye.b2_maxLinearCorrection,0),fo=-_o.equalizedMass*Co,Ao=fo*ro.x,So=fo*ro.y;oo.m_sweep.c.x-=no*Ao,oo.m_sweep.c.y-=no*So,oo.m_sweep.a-=io*(yo*So-xo*Ao),oo.SynchronizeTransform(),to.m_sweep.c.x+=mo*Ao,to.m_sweep.c.y+=mo*So,to.m_sweep.a+=ao*(uo*So-bo*Ao),to.SynchronizeTransform()}}return Qe>-1.5*ye.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new Oe,Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new Z}),Box2D.inherit(U,Box2D.Dynamics.Contacts.b2Contact),U.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,U.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},U.Create=function(){return new U},U.Destroy=function(){},U.prototype.Reset=function(Ye,Qe){this.__super.Reset.call(this,Ye,Qe)},U.prototype.Evaluate=function(){var Ye=this.m_fixtureA.GetBody(),Qe=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof _?this.m_fixtureA.GetShape():null,Ye.m_xf,this.m_fixtureB.GetShape()instanceof o?this.m_fixtureB.GetShape():null,Qe.m_xf)},U.prototype.b2CollideEdgeAndCircle=function(){},Box2D.inherit(q,Box2D.Dynamics.Contacts.b2Contact),q.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,q.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},q.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)},q.prototype.Evaluate=function(){},Box2D.inherit(W,Box2D.Dynamics.Contacts.b2Contact),W.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,W.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},W.Create=function(){return new W},W.Destroy=function(){},W.prototype.Reset=function(Ye,Qe){this.__super.Reset.call(this,Ye,Qe),ye.b2Assert(Ye.GetType()==V.e_polygonShape),ye.b2Assert(Qe.GetType()==V.e_circleShape)},W.prototype.Evaluate=function(){var Ye=this.m_fixtureA.m_body,Qe=this.m_fixtureB.m_body;ve.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof g?this.m_fixtureA.GetShape():null,Ye.m_xf,this.m_fixtureB.GetShape()instanceof o?this.m_fixtureB.GetShape():null,Qe.m_xf)},Box2D.inherit(O,Box2D.Dynamics.Contacts.b2Contact),O.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,O.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},O.Create=function(){return new O},O.Destroy=function(){},O.prototype.Reset=function(Ye,Qe){this.__super.Reset.call(this,Ye,Qe),ye.b2Assert(Ye.GetType()==V.e_polygonShape),ye.b2Assert(Qe.GetType()==V.e_edgeShape)},O.prototype.Evaluate=function(){var Ye=this.m_fixtureA.GetBody(),Qe=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof g?this.m_fixtureA.GetShape():null,Ye.m_xf,this.m_fixtureB.GetShape()instanceof _?this.m_fixtureB.GetShape():null,Qe.m_xf)},O.prototype.b2CollidePolyAndEdge=function(){},Box2D.inherit(X,Box2D.Dynamics.Contacts.b2Contact),X.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype,X.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)},X.Create=function(){return new X},X.Destroy=function(){},X.prototype.Reset=function(Ye,Qe){this.__super.Reset.call(this,Ye,Qe)},X.prototype.Evaluate=function(){var Ye=this.m_fixtureA.GetBody(),Qe=this.m_fixtureB.GetBody();ve.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof g?this.m_fixtureA.GetShape():null,Ye.m_xf,this.m_fixtureB.GetShape()instanceof g?this.m_fixtureB.GetShape():null,Qe.m_xf)},Z.b2PositionSolverManifold=function(){},Z.prototype.b2PositionSolverManifold=function(){this.m_normal=new fe,this.m_separations=new Vector_a2j_Number(ye.b2_maxManifoldPoints),this.m_points=new Vector(ye.b2_maxManifoldPoints);for(var Ye=0;Ye<ye.b2_maxManifoldPoints;Ye++)this.m_points[Ye]=new fe},Z.prototype.Initialize=function(Ye){ye.b2Assert(0<Ye.pointCount);var Qe=0,$e=0,eo=0,oo,to,no=0,io=0;switch(Ye.type){case Pe.e_circles:{oo=Ye.bodyA.m_xf.R,to=Ye.localPoint;var mo=Ye.bodyA.m_xf.position.x+(oo.col1.x*to.x+oo.col2.x*to.y),ao=Ye.bodyA.m_xf.position.y+(oo.col1.y*to.x+oo.col2.y*to.y);oo=Ye.bodyB.m_xf.R,to=Ye.points[0].localPoint;var ro=Ye.bodyB.m_xf.position.x+(oo.col1.x*to.x+oo.col2.x*to.y),so=Ye.bodyB.m_xf.position.y+(oo.col1.y*to.x+oo.col2.y*to.y),_o=ro-mo,po=so-ao,co=_o*_o+po*po;if(co>Number.MIN_VALUE*Number.MIN_VALUE){var yo=Math.sqrt(co);this.m_normal.x=_o/yo,this.m_normal.y=po/yo}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=0.5*(mo+ro),this.m_points[0].y=0.5*(ao+so),this.m_separations[0]=_o*this.m_normal.x+po*this.m_normal.y-Ye.radius}break;case Pe.e_faceA:for(oo=Ye.bodyA.m_xf.R,to=Ye.localPlaneNormal,this.m_normal.x=oo.col1.x*to.x+oo.col2.x*to.y,this.m_normal.y=oo.col1.y*to.x+oo.col2.y*to.y,oo=Ye.bodyA.m_xf.R,to=Ye.localPoint,no=Ye.bodyA.m_xf.position.x+(oo.col1.x*to.x+oo.col2.x*to.y),io=Ye.bodyA.m_xf.position.y+(oo.col1.y*to.x+oo.col2.y*to.y),oo=Ye.bodyB.m_xf.R,Qe=0;Qe<Ye.pointCount;++Qe)to=Ye.points[Qe].localPoint,$e=Ye.bodyB.m_xf.position.x+(oo.col1.x*to.x+oo.col2.x*to.y),eo=Ye.bodyB.m_xf.position.y+(oo.col1.y*to.x+oo.col2.y*to.y),this.m_separations[Qe]=($e-no)*this.m_normal.x+(eo-io)*this.m_normal.y-Ye.radius,this.m_points[Qe].x=$e,this.m_points[Qe].y=eo;break;case Pe.e_faceB:{for(oo=Ye.bodyB.m_xf.R,to=Ye.localPlaneNormal,this.m_normal.x=oo.col1.x*to.x+oo.col2.x*to.y,this.m_normal.y=oo.col1.y*to.x+oo.col2.y*to.y,oo=Ye.bodyB.m_xf.R,to=Ye.localPoint,no=Ye.bodyB.m_xf.position.x+(oo.col1.x*to.x+oo.col2.x*to.y),io=Ye.bodyB.m_xf.position.y+(oo.col1.y*to.x+oo.col2.y*to.y),oo=Ye.bodyA.m_xf.R,Qe=0;Qe<Ye.pointCount;++Qe)to=Ye.points[Qe].localPoint,$e=Ye.bodyA.m_xf.position.x+(oo.col1.x*to.x+oo.col2.x*to.y),eo=Ye.bodyA.m_xf.position.y+(oo.col1.y*to.x+oo.col2.y*to.y),this.m_separations[Qe]=($e-no)*this.m_normal.x+(eo-io)*this.m_normal.y-Ye.radius,this.m_points[Qe].Set($e,eo);this.m_normal.x*=-1,this.m_normal.y*=-1}}},Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new fe,Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new fe})}(),function(){var o=Box2D.Dynamics.b2Body,n=Box2D.Dynamics.b2BodyDef,_=Box2D.Dynamics.b2ContactFilter,S=Box2D.Dynamics.b2ContactImpulse,g=Box2D.Dynamics.b2ContactListener,V=Box2D.Dynamics.b2ContactManager,M=Box2D.Dynamics.b2DebugDraw,w=Box2D.Dynamics.b2DestructionListener,G=Box2D.Dynamics.b2FilterData,L=Box2D.Dynamics.b2Fixture,J=Box2D.Dynamics.b2FixtureDef,F=Box2D.Dynamics.b2Island,R=Box2D.Dynamics.b2TimeStep,E=Box2D.Dynamics.b2World,N=Box2D.Common.Math.b2Mat22,U=Box2D.Common.Math.b2Mat33,q=Box2D.Common.Math.b2Math,W=Box2D.Common.Math.b2Sweep,O=Box2D.Common.Math.b2Transform,X=Box2D.Common.Math.b2Vec2,Z=Box2D.Common.Math.b2Vec3,H=Box2D.Common.b2Color,Y=Box2D.Common.b2internal,Q=Box2D.Common.b2Settings,$=Box2D.Collision.Shapes.b2CircleShape,ee=Box2D.Collision.Shapes.b2EdgeChainDef,oe=Box2D.Collision.Shapes.b2EdgeShape,te=Box2D.Collision.Shapes.b2MassData,ne=Box2D.Collision.Shapes.b2PolygonShape,ie=Box2D.Collision.Shapes.b2Shape,me=Box2D.Dynamics.Controllers.b2BuoyancyController,ae=Box2D.Dynamics.Controllers.b2ConstantAccelController,le=Box2D.Dynamics.Controllers.b2ConstantForceController,re=Box2D.Dynamics.Controllers.b2Controller,se=Box2D.Dynamics.Controllers.b2ControllerEdge,_e=Box2D.Dynamics.Controllers.b2GravityController,pe=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(me,Box2D.Dynamics.Controllers.b2Controller),me.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,me.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.normal=new X(0,-1),this.offset=0,this.density=0,this.velocity=new X(0,0),this.linearDrag=2,this.angularDrag=1,this.useDensity=!1,this.useWorldGravity=!0,this.gravity=null},me.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy());for(var xe=this.m_bodyList,ue;xe;xe=xe.nextBody)if(ue=xe.body,!1!=ue.IsAwake()){for(var de=new X,be=new X,Ce=0,fe=0,Ae=ue.GetFixtureList();Ae;Ae=Ae.GetNext()){var Se=new X,ge=Ae.GetShape().ComputeSubmergedArea(this.normal,this.offset,ue.GetTransform(),Se);Ce+=ge,de.x+=ge*Se.x,de.y+=ge*Se.y;var De=0;De=this.useDensity?1:1,fe+=ge*De,be.x+=ge*Se.x*De,be.y+=ge*Se.y*De}if(de.x/=Ce,de.y/=Ce,be.x/=fe,be.y/=fe,!(Ce<Number.MIN_VALUE)){var ve=this.gravity.GetNegative();ve.Multiply(this.density*Ce),ue.ApplyForce(ve,be);var he=ue.GetLinearVelocityFromWorldPoint(de);he.Subtract(this.velocity),he.Multiply(-this.linearDrag*Ce),ue.ApplyForce(he,de),ue.ApplyTorque(-ue.GetInertia()/ue.GetMass()*Ce*ue.GetAngularVelocity()*this.angularDrag)}}}},me.prototype.Draw=function(ye){var xe=1e3,ue=new X,de=new X;ue.x=this.normal.x*this.offset+this.normal.y*xe,ue.y=this.normal.y*this.offset-this.normal.x*xe,de.x=this.normal.x*this.offset-this.normal.y*xe,de.y=this.normal.y*this.offset+this.normal.x*xe;var be=new H(0,0,1);ye.DrawSegment(ue,de,be)},Box2D.inherit(ae,Box2D.Dynamics.Controllers.b2Controller),ae.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,ae.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.A=new X(0,0)},ae.prototype.Step=function(ye){for(var xe=new X(this.A.x*ye.dt,this.A.y*ye.dt),ue=this.m_bodyList,de;ue;ue=ue.nextBody)de=ue.body,de.IsAwake()&&de.SetLinearVelocity(new X(de.GetLinearVelocity().x+xe.x,de.GetLinearVelocity().y+xe.y))},Box2D.inherit(le,Box2D.Dynamics.Controllers.b2Controller),le.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,le.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.F=new X(0,0)},le.prototype.Step=function(){for(var xe=this.m_bodyList,ue;xe;xe=xe.nextBody)ue=xe.body,ue.IsAwake()&&ue.ApplyForce(this.F,ue.GetWorldCenter())},re.b2Controller=function(){},re.prototype.Step=function(){},re.prototype.Draw=function(){},re.prototype.AddBody=function(ye){var xe=new se;xe.controller=this,xe.body=ye,xe.nextBody=this.m_bodyList,xe.prevBody=null,this.m_bodyList=xe,xe.nextBody&&(xe.nextBody.prevBody=xe),this.m_bodyCount++,xe.nextController=ye.m_controllerList,xe.prevController=null,ye.m_controllerList=xe,xe.nextController&&(xe.nextController.prevController=xe),ye.m_controllerCount++},re.prototype.RemoveBody=function(ye){for(var xe=ye.m_controllerList;xe&&xe.controller!=this;)xe=xe.nextController;xe.prevBody&&(xe.prevBody.nextBody=xe.nextBody),xe.nextBody&&(xe.nextBody.prevBody=xe.prevBody),xe.nextController&&(xe.nextController.prevController=xe.prevController),xe.prevController&&(xe.prevController.nextController=xe.nextController),this.m_bodyList==xe&&(this.m_bodyList=xe.nextBody),ye.m_controllerList==xe&&(ye.m_controllerList=xe.nextController),ye.m_controllerCount--,this.m_bodyCount--},re.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)},re.prototype.GetNext=function(){return this.m_next},re.prototype.GetWorld=function(){return this.m_world},re.prototype.GetBodyList=function(){return this.m_bodyList},se.b2ControllerEdge=function(){},Box2D.inherit(_e,Box2D.Dynamics.Controllers.b2Controller),_e.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,_e.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.G=1,this.invSqr=!0},_e.prototype.Step=function(){var xe=null,ue=null,de=null,be=0,Ce=null,fe=null,Ae=null,Se=0,ge=0,De=0,ve=null;if(this.invSqr)for(xe=this.m_bodyList;xe;xe=xe.nextBody)for(ue=xe.body,de=ue.GetWorldCenter(),be=ue.GetMass(),Ce=this.m_bodyList;Ce!=xe;Ce=Ce.nextBody)fe=Ce.body,Ae=fe.GetWorldCenter(),Se=Ae.x-de.x,ge=Ae.y-de.y,De=Se*Se+ge*ge,De<Number.MIN_VALUE||(ve=new X(Se,ge),ve.Multiply(this.G/De/Math.sqrt(De)*be*fe.GetMass()),ue.IsAwake()&&ue.ApplyForce(ve,de),ve.Multiply(-1),fe.IsAwake()&&fe.ApplyForce(ve,Ae));else for(xe=this.m_bodyList;xe;xe=xe.nextBody)for(ue=xe.body,de=ue.GetWorldCenter(),be=ue.GetMass(),Ce=this.m_bodyList;Ce!=xe;Ce=Ce.nextBody)fe=Ce.body,Ae=fe.GetWorldCenter(),Se=Ae.x-de.x,ge=Ae.y-de.y,De=Se*Se+ge*ge,De<Number.MIN_VALUE||(ve=new X(Se,ge),ve.Multiply(this.G/De*be*fe.GetMass()),ue.IsAwake()&&ue.ApplyForce(ve,de),ve.Multiply(-1),fe.IsAwake()&&fe.ApplyForce(ve,Ae))},Box2D.inherit(pe,Box2D.Dynamics.Controllers.b2Controller),pe.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype,pe.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments),this.T=new N,this.maxTimestep=0},pe.prototype.SetAxisAligned=function(ye,xe){ye===void 0&&(ye=0),xe===void 0&&(xe=0),this.T.col1.x=-ye,this.T.col1.y=0,this.T.col2.x=0,this.T.col2.y=-xe,this.maxTimestep=0<ye||0<xe?1/Math.max(ye,xe):0},pe.prototype.Step=function(ye){var xe=ye.dt;if(!(xe<=Number.MIN_VALUE)){xe>this.maxTimestep&&0<this.maxTimestep&&(xe=this.maxTimestep);for(var ue=this.m_bodyList,de;ue;ue=ue.nextBody)if(de=ue.body,!!de.IsAwake()){var be=de.GetWorldVector(q.MulMV(this.T,de.GetLocalVector(de.GetLinearVelocity())));de.SetLinearVelocity(new X(de.GetLinearVelocity().x+be.x*xe,de.GetLinearVelocity().y+be.y*xe))}}}}(),function(){var o=Box2D.Common.b2Color,n=Box2D.Common.b2internal,_=Box2D.Common.b2Settings,S=Box2D.Common.Math.b2Mat22,g=Box2D.Common.Math.b2Mat33,V=Box2D.Common.Math.b2Math,M=Box2D.Common.Math.b2Sweep,w=Box2D.Common.Math.b2Transform,G=Box2D.Common.Math.b2Vec2,L=Box2D.Common.Math.b2Vec3,J=Box2D.Dynamics.Joints.b2DistanceJoint,F=Box2D.Dynamics.Joints.b2DistanceJointDef,R=Box2D.Dynamics.Joints.b2FrictionJoint,E=Box2D.Dynamics.Joints.b2FrictionJointDef,N=Box2D.Dynamics.Joints.b2GearJoint,U=Box2D.Dynamics.Joints.b2GearJointDef,q=Box2D.Dynamics.Joints.b2Jacobian,W=Box2D.Dynamics.Joints.b2Joint,O=Box2D.Dynamics.Joints.b2JointDef,X=Box2D.Dynamics.Joints.b2JointEdge,Z=Box2D.Dynamics.Joints.b2LineJoint,H=Box2D.Dynamics.Joints.b2LineJointDef,Y=Box2D.Dynamics.Joints.b2MouseJoint,Q=Box2D.Dynamics.Joints.b2MouseJointDef,$=Box2D.Dynamics.Joints.b2PrismaticJoint,ee=Box2D.Dynamics.Joints.b2PrismaticJointDef,oe=Box2D.Dynamics.Joints.b2PulleyJoint,te=Box2D.Dynamics.Joints.b2PulleyJointDef,ne=Box2D.Dynamics.Joints.b2RevoluteJoint,ie=Box2D.Dynamics.Joints.b2RevoluteJointDef,me=Box2D.Dynamics.Joints.b2WeldJoint,ae=Box2D.Dynamics.Joints.b2WeldJointDef,le=Box2D.Dynamics.b2Body,re=Box2D.Dynamics.b2BodyDef,se=Box2D.Dynamics.b2ContactFilter,_e=Box2D.Dynamics.b2ContactImpulse,pe=Box2D.Dynamics.b2ContactListener,ye=Box2D.Dynamics.b2ContactManager,xe=Box2D.Dynamics.b2DebugDraw,ue=Box2D.Dynamics.b2DestructionListener,de=Box2D.Dynamics.b2FilterData,be=Box2D.Dynamics.b2Fixture,Ce=Box2D.Dynamics.b2FixtureDef,fe=Box2D.Dynamics.b2Island,Ae=Box2D.Dynamics.b2TimeStep,Se=Box2D.Dynamics.b2World;Box2D.inherit(J,Box2D.Dynamics.Joints.b2Joint),J.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,J.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_u=new G},J.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},J.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},J.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_impulse*this.m_u.x,ge*this.m_impulse*this.m_u.y)},J.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),0},J.prototype.GetLength=function(){return this.m_length},J.prototype.SetLength=function(ge){ge===void 0&&(ge=0),this.m_length=ge},J.prototype.GetFrequency=function(){return this.m_frequencyHz},J.prototype.SetFrequency=function(ge){ge===void 0&&(ge=0),this.m_frequencyHz=ge},J.prototype.GetDampingRatio=function(){return this.m_dampingRatio},J.prototype.SetDampingRatio=function(ge){ge===void 0&&(ge=0),this.m_dampingRatio=ge},J.prototype.b2DistanceJoint=function(ge){this.__super.b2Joint.call(this,ge);this.m_localAnchor1.SetV(ge.localAnchorA),this.m_localAnchor2.SetV(ge.localAnchorB),this.m_length=ge.length,this.m_frequencyHz=ge.frequencyHz,this.m_dampingRatio=ge.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0},J.prototype.InitVelocityConstraints=function(ge){var ve=0,he=this.m_bodyA,Be=this.m_bodyB,De;De=he.m_xf.R;var Ve=this.m_localAnchor1.x-he.m_sweep.localCenter.x,Me=this.m_localAnchor1.y-he.m_sweep.localCenter.y;ve=De.col1.x*Ve+De.col2.x*Me,Me=De.col1.y*Ve+De.col2.y*Me,Ve=ve,De=Be.m_xf.R;var we=this.m_localAnchor2.x-Be.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-Be.m_sweep.localCenter.y;ve=De.col1.x*we+De.col2.x*Ie,Ie=De.col1.y*we+De.col2.y*Ie,we=ve,this.m_u.x=Be.m_sweep.c.x+we-he.m_sweep.c.x-Ve,this.m_u.y=Be.m_sweep.c.y+Ie-he.m_sweep.c.y-Me;var Ge=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);Ge>_.b2_linearSlop?this.m_u.Multiply(1/Ge):this.m_u.SetZero();var Le=Ve*this.m_u.y-Me*this.m_u.x,Je=we*this.m_u.y-Ie*this.m_u.x,Fe=he.m_invMass+he.m_invI*Le*Le+Be.m_invMass+Be.m_invI*Je*Je;if(this.m_mass=0==Fe?0:1/Fe,0<this.m_frequencyHz){var Pe=Ge-this.m_length,Re=2*Math.PI*this.m_frequencyHz,Te=2*this.m_mass*this.m_dampingRatio*Re,ze=this.m_mass*Re*Re;this.m_gamma=ge.dt*(Te+ge.dt*ze),this.m_gamma=0==this.m_gamma?0:1/this.m_gamma,this.m_bias=Pe*ge.dt*ze*this.m_gamma,this.m_mass=Fe+this.m_gamma,this.m_mass=0==this.m_mass?0:1/this.m_mass}if(ge.warmStarting){this.m_impulse*=ge.dtRatio;var Ee=this.m_impulse*this.m_u.x,ke=this.m_impulse*this.m_u.y;he.m_linearVelocity.x-=he.m_invMass*Ee,he.m_linearVelocity.y-=he.m_invMass*ke,he.m_angularVelocity-=he.m_invI*(Ve*ke-Me*Ee),Be.m_linearVelocity.x+=Be.m_invMass*Ee,Be.m_linearVelocity.y+=Be.m_invMass*ke,Be.m_angularVelocity+=Be.m_invI*(we*ke-Ie*Ee)}else this.m_impulse=0},J.prototype.SolveVelocityConstraints=function(){var De,ve=this.m_bodyA,he=this.m_bodyB;De=ve.m_xf.R;var Be=this.m_localAnchor1.x-ve.m_sweep.localCenter.x,Ve=this.m_localAnchor1.y-ve.m_sweep.localCenter.y,Me=De.col1.x*Be+De.col2.x*Ve;Ve=De.col1.y*Be+De.col2.y*Ve,Be=Me,De=he.m_xf.R;var we=this.m_localAnchor2.x-he.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-he.m_sweep.localCenter.y;Me=De.col1.x*we+De.col2.x*Ie,Ie=De.col1.y*we+De.col2.y*Ie,we=Me;var Ge=ve.m_linearVelocity.x+-ve.m_angularVelocity*Ve,Le=ve.m_linearVelocity.y+ve.m_angularVelocity*Be,Je=he.m_linearVelocity.x+-he.m_angularVelocity*Ie,Fe=he.m_linearVelocity.y+he.m_angularVelocity*we,Pe=this.m_u.x*(Je-Ge)+this.m_u.y*(Fe-Le),Re=-this.m_mass*(Pe+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=Re;var Te=Re*this.m_u.x,ze=Re*this.m_u.y;ve.m_linearVelocity.x-=ve.m_invMass*Te,ve.m_linearVelocity.y-=ve.m_invMass*ze,ve.m_angularVelocity-=ve.m_invI*(Be*ze-Ve*Te),he.m_linearVelocity.x+=he.m_invMass*Te,he.m_linearVelocity.y+=he.m_invMass*ze,he.m_angularVelocity+=he.m_invI*(we*ze-Ie*Te)},J.prototype.SolvePositionConstraints=function(ge){void 0===ge&&(ge=0);var De;if(0<this.m_frequencyHz)return!0;var ve=this.m_bodyA,he=this.m_bodyB;De=ve.m_xf.R;var Be=this.m_localAnchor1.x-ve.m_sweep.localCenter.x,Ve=this.m_localAnchor1.y-ve.m_sweep.localCenter.y,Me=De.col1.x*Be+De.col2.x*Ve;Ve=De.col1.y*Be+De.col2.y*Ve,Be=Me,De=he.m_xf.R;var we=this.m_localAnchor2.x-he.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-he.m_sweep.localCenter.y;Me=De.col1.x*we+De.col2.x*Ie,Ie=De.col1.y*we+De.col2.y*Ie,we=Me;var Ge=he.m_sweep.c.x+we-ve.m_sweep.c.x-Be,Le=he.m_sweep.c.y+Ie-ve.m_sweep.c.y-Ve,Je=Math.sqrt(Ge*Ge+Le*Le);Ge/=Je,Le/=Je;var Fe=Je-this.m_length;Fe=V.Clamp(Fe,-_.b2_maxLinearCorrection,_.b2_maxLinearCorrection);var Pe=-this.m_mass*Fe;this.m_u.Set(Ge,Le);var Re=Pe*this.m_u.x,Te=Pe*this.m_u.y;return ve.m_sweep.c.x-=ve.m_invMass*Re,ve.m_sweep.c.y-=ve.m_invMass*Te,ve.m_sweep.a-=ve.m_invI*(Be*Te-Ve*Re),he.m_sweep.c.x+=he.m_invMass*Re,he.m_sweep.c.y+=he.m_invMass*Te,he.m_sweep.a+=he.m_invI*(we*Te-Ie*Re),ve.SynchronizeTransform(),he.SynchronizeTransform(),V.Abs(Fe)<_.b2_linearSlop},Box2D.inherit(F,Box2D.Dynamics.Joints.b2JointDef),F.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,F.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},F.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_distanceJoint,this.length=1,this.frequencyHz=0,this.dampingRatio=0},F.prototype.Initialize=function(ge,De,ve,he){this.bodyA=ge,this.bodyB=De,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(ve)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(he));var Be=he.x-ve.x,Ve=he.y-ve.y;this.length=Math.sqrt(Be*Be+Ve*Ve),this.frequencyHz=0,this.dampingRatio=0},Box2D.inherit(R,Box2D.Dynamics.Joints.b2Joint),R.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,R.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new G,this.m_localAnchorB=new G,this.m_linearMass=new S,this.m_linearImpulse=new G},R.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},R.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},R.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_linearImpulse.x,ge*this.m_linearImpulse.y)},R.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),ge*this.m_angularImpulse},R.prototype.SetMaxForce=function(ge){ge===void 0&&(ge=0),this.m_maxForce=ge},R.prototype.GetMaxForce=function(){return this.m_maxForce},R.prototype.SetMaxTorque=function(ge){ge===void 0&&(ge=0),this.m_maxTorque=ge},R.prototype.GetMaxTorque=function(){return this.m_maxTorque},R.prototype.b2FrictionJoint=function(ge){this.__super.b2Joint.call(this,ge),this.m_localAnchorA.SetV(ge.localAnchorA),this.m_localAnchorB.SetV(ge.localAnchorB),this.m_linearMass.SetZero(),this.m_angularMass=0,this.m_linearImpulse.SetZero(),this.m_angularImpulse=0,this.m_maxForce=ge.maxForce,this.m_maxTorque=ge.maxTorque},R.prototype.InitVelocityConstraints=function(ge){var ve=0,he=this.m_bodyA,Be=this.m_bodyB,De;De=he.m_xf.R;var Ve=this.m_localAnchorA.x-he.m_sweep.localCenter.x,Me=this.m_localAnchorA.y-he.m_sweep.localCenter.y;ve=De.col1.x*Ve+De.col2.x*Me,Me=De.col1.y*Ve+De.col2.y*Me,Ve=ve,De=Be.m_xf.R;var we=this.m_localAnchorB.x-Be.m_sweep.localCenter.x,Ie=this.m_localAnchorB.y-Be.m_sweep.localCenter.y;ve=De.col1.x*we+De.col2.x*Ie,Ie=De.col1.y*we+De.col2.y*Ie,we=ve;var Ge=he.m_invMass,Le=Be.m_invMass,Je=he.m_invI,Fe=Be.m_invI,Pe=new S;if(Pe.col1.x=Ge+Le,Pe.col2.x=0,Pe.col1.y=0,Pe.col2.y=Ge+Le,Pe.col1.x+=Je*Me*Me,Pe.col2.x+=-Je*Ve*Me,Pe.col1.y+=-Je*Ve*Me,Pe.col2.y+=Je*Ve*Ve,Pe.col1.x+=Fe*Ie*Ie,Pe.col2.x+=-Fe*we*Ie,Pe.col1.y+=-Fe*we*Ie,Pe.col2.y+=Fe*we*we,Pe.GetInverse(this.m_linearMass),this.m_angularMass=Je+Fe,0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass),ge.warmStarting){this.m_linearImpulse.x*=ge.dtRatio,this.m_linearImpulse.y*=ge.dtRatio,this.m_angularImpulse*=ge.dtRatio;var Re=this.m_linearImpulse;he.m_linearVelocity.x-=Ge*Re.x,he.m_linearVelocity.y-=Ge*Re.y,he.m_angularVelocity-=Je*(Ve*Re.y-Me*Re.x+this.m_angularImpulse),Be.m_linearVelocity.x+=Le*Re.x,Be.m_linearVelocity.y+=Le*Re.y,Be.m_angularVelocity+=Fe*(we*Re.y-Ie*Re.x+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0},R.prototype.SolveVelocityConstraints=function(ge){var De,ve=0,he=this.m_bodyA,Be=this.m_bodyB,Ve=he.m_linearVelocity,Me=he.m_angularVelocity,we=Be.m_linearVelocity,Ie=Be.m_angularVelocity,Ge=he.m_invMass,Le=Be.m_invMass,Je=he.m_invI,Fe=Be.m_invI;De=he.m_xf.R;var Pe=this.m_localAnchorA.x-he.m_sweep.localCenter.x,Re=this.m_localAnchorA.y-he.m_sweep.localCenter.y;ve=De.col1.x*Pe+De.col2.x*Re,Re=De.col1.y*Pe+De.col2.y*Re,Pe=ve,De=Be.m_xf.R;var Te=this.m_localAnchorB.x-Be.m_sweep.localCenter.x,ze=this.m_localAnchorB.y-Be.m_sweep.localCenter.y;ve=De.col1.x*Te+De.col2.x*ze,ze=De.col1.y*Te+De.col2.y*ze,Te=ve;var Ee=0;{var ke=Ie-Me,Ne=-this.m_angularMass*ke,je=this.m_angularImpulse;Ee=ge.dt*this.m_maxTorque,this.m_angularImpulse=V.Clamp(this.m_angularImpulse+Ne,-Ee,Ee),Ne=this.m_angularImpulse-je,Me-=Je*Ne,Ie+=Fe*Ne}{var Ue=we.x-Ie*ze-Ve.x+Me*Re,qe=we.y+Ie*Te-Ve.y-Me*Pe,Ke=V.MulMV(this.m_linearMass,new G(-Ue,-qe)),We=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(Ke),Ee=ge.dt*this.m_maxForce,this.m_linearImpulse.LengthSquared()>Ee*Ee&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(Ee)),Ke=V.SubtractVV(this.m_linearImpulse,We),Ve.x-=Ge*Ke.x,Ve.y-=Ge*Ke.y,Me-=Je*(Pe*Ke.y-Re*Ke.x),we.x+=Le*Ke.x,we.y+=Le*Ke.y,Ie+=Fe*(Te*Ke.y-ze*Ke.x)}he.m_angularVelocity=Me,Be.m_angularVelocity=Ie},R.prototype.SolvePositionConstraints=function(ge){return void 0===ge&&(ge=0),!0},Box2D.inherit(E,Box2D.Dynamics.Joints.b2JointDef),E.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,E.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},E.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_frictionJoint,this.maxForce=0,this.maxTorque=0},E.prototype.Initialize=function(ge,De,ve){this.bodyA=ge,this.bodyB=De,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(ve)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(ve))},Box2D.inherit(N,Box2D.Dynamics.Joints.b2Joint),N.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,N.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new G,this.m_groundAnchor2=new G,this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_J=new q},N.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},N.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},N.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_impulse*this.m_J.linearB.x,ge*this.m_impulse*this.m_J.linearB.y)},N.prototype.GetReactionTorque=function(ge){ge===void 0&&(ge=0);var De=this.m_bodyB.m_xf.R,ve=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,he=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,Be=De.col1.x*ve+De.col2.x*he;he=De.col1.y*ve+De.col2.y*he,ve=Be;var Ve=this.m_impulse*this.m_J.linearB.x,Me=this.m_impulse*this.m_J.linearB.y;return ge*(this.m_impulse*this.m_J.angularB-ve*Me+he*Ve)},N.prototype.GetRatio=function(){return this.m_ratio},N.prototype.SetRatio=function(ge){ge===void 0&&(ge=0),this.m_ratio=ge},N.prototype.b2GearJoint=function(ge){this.__super.b2Joint.call(this,ge);var De=parseInt(ge.joint1.m_type),ve=parseInt(ge.joint2.m_type);this.m_revolute1=null,this.m_prismatic1=null,this.m_revolute2=null,this.m_prismatic2=null;var he=0,Be=0;this.m_ground1=ge.joint1.GetBodyA(),this.m_bodyA=ge.joint1.GetBodyB(),De==W.e_revoluteJoint?(this.m_revolute1=ge.joint1 instanceof ne?ge.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),he=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=ge.joint1 instanceof $?ge.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),he=this.m_prismatic1.GetJointTranslation()),this.m_ground2=ge.joint2.GetBodyA(),this.m_bodyB=ge.joint2.GetBodyB(),ve==W.e_revoluteJoint?(this.m_revolute2=ge.joint2 instanceof ne?ge.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),Be=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=ge.joint2 instanceof $?ge.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),Be=this.m_prismatic2.GetJointTranslation()),this.m_ratio=ge.ratio,this.m_constant=he+this.m_ratio*Be,this.m_impulse=0},N.prototype.InitVelocityConstraints=function(ge){var De=this.m_ground1,ve=this.m_ground2,he=this.m_bodyA,Be=this.m_bodyB,Ve=0,Me=0,we=0,Ie=0,Ge,Le,Je=0,Fe=0,Pe=0;this.m_J.SetZero(),this.m_revolute1?(this.m_J.angularA=-1,Pe+=he.m_invI):(Ge=De.m_xf.R,Le=this.m_prismatic1.m_localXAxis1,Ve=Ge.col1.x*Le.x+Ge.col2.x*Le.y,Me=Ge.col1.y*Le.x+Ge.col2.y*Le.y,Ge=he.m_xf.R,we=this.m_localAnchor1.x-he.m_sweep.localCenter.x,Ie=this.m_localAnchor1.y-he.m_sweep.localCenter.y,Fe=Ge.col1.x*we+Ge.col2.x*Ie,Ie=Ge.col1.y*we+Ge.col2.y*Ie,we=Fe,Je=we*Me-Ie*Ve,this.m_J.linearA.Set(-Ve,-Me),this.m_J.angularA=-Je,Pe+=he.m_invMass+he.m_invI*Je*Je),this.m_revolute2?(this.m_J.angularB=-this.m_ratio,Pe+=this.m_ratio*this.m_ratio*Be.m_invI):(Ge=ve.m_xf.R,Le=this.m_prismatic2.m_localXAxis1,Ve=Ge.col1.x*Le.x+Ge.col2.x*Le.y,Me=Ge.col1.y*Le.x+Ge.col2.y*Le.y,Ge=Be.m_xf.R,we=this.m_localAnchor2.x-Be.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-Be.m_sweep.localCenter.y,Fe=Ge.col1.x*we+Ge.col2.x*Ie,Ie=Ge.col1.y*we+Ge.col2.y*Ie,we=Fe,Je=we*Me-Ie*Ve,this.m_J.linearB.Set(-this.m_ratio*Ve,-this.m_ratio*Me),this.m_J.angularB=-this.m_ratio*Je,Pe+=this.m_ratio*this.m_ratio*(Be.m_invMass+Be.m_invI*Je*Je)),this.m_mass=0<Pe?1/Pe:0,ge.warmStarting?(he.m_linearVelocity.x+=he.m_invMass*this.m_impulse*this.m_J.linearA.x,he.m_linearVelocity.y+=he.m_invMass*this.m_impulse*this.m_J.linearA.y,he.m_angularVelocity+=he.m_invI*this.m_impulse*this.m_J.angularA,Be.m_linearVelocity.x+=Be.m_invMass*this.m_impulse*this.m_J.linearB.x,Be.m_linearVelocity.y+=Be.m_invMass*this.m_impulse*this.m_J.linearB.y,Be.m_angularVelocity+=Be.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},N.prototype.SolveVelocityConstraints=function(){var De=this.m_bodyA,ve=this.m_bodyB,he=this.m_J.Compute(De.m_linearVelocity,De.m_angularVelocity,ve.m_linearVelocity,ve.m_angularVelocity),Be=-this.m_mass*he;this.m_impulse+=Be,De.m_linearVelocity.x+=De.m_invMass*Be*this.m_J.linearA.x,De.m_linearVelocity.y+=De.m_invMass*Be*this.m_J.linearA.y,De.m_angularVelocity+=De.m_invI*Be*this.m_J.angularA,ve.m_linearVelocity.x+=ve.m_invMass*Be*this.m_J.linearB.x,ve.m_linearVelocity.y+=ve.m_invMass*Be*this.m_J.linearB.y,ve.m_angularVelocity+=ve.m_invI*Be*this.m_J.angularB},N.prototype.SolvePositionConstraints=function(ge){void 0===ge&&(ge=0);var ve=this.m_bodyA,he=this.m_bodyB,Be=0,Ve=0;Be=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),Ve=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation();var Me=this.m_constant-(Be+this.m_ratio*Ve),we=-this.m_mass*Me;return ve.m_sweep.c.x+=ve.m_invMass*we*this.m_J.linearA.x,ve.m_sweep.c.y+=ve.m_invMass*we*this.m_J.linearA.y,ve.m_sweep.a+=ve.m_invI*we*this.m_J.angularA,he.m_sweep.c.x+=he.m_invMass*we*this.m_J.linearB.x,he.m_sweep.c.y+=he.m_invMass*we*this.m_J.linearB.y,he.m_sweep.a+=he.m_invI*we*this.m_J.angularB,ve.SynchronizeTransform(),he.SynchronizeTransform(),0<_.b2_linearSlop},Box2D.inherit(U,Box2D.Dynamics.Joints.b2JointDef),U.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,U.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)},U.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_gearJoint,this.joint1=null,this.joint2=null,this.ratio=1},q.b2Jacobian=function(){this.linearA=new G,this.linearB=new G},q.prototype.SetZero=function(){this.linearA.SetZero(),this.angularA=0,this.linearB.SetZero(),this.angularB=0},q.prototype.Set=function(ge,De,ve,he){De===void 0&&(De=0),he===void 0&&(he=0),this.linearA.SetV(ge),this.angularA=De,this.linearB.SetV(ve),this.angularB=he},q.prototype.Compute=function(ge,De,ve,he){return void 0===De&&(De=0),void 0===he&&(he=0),this.linearA.x*ge.x+this.linearA.y*ge.y+this.angularA*De+(this.linearB.x*ve.x+this.linearB.y*ve.y)+this.angularB*he},W.b2Joint=function(){this.m_edgeA=new X,this.m_edgeB=new X,this.m_localCenterA=new G,this.m_localCenterB=new G},W.prototype.GetType=function(){return this.m_type},W.prototype.GetAnchorA=function(){return null},W.prototype.GetAnchorB=function(){return null},W.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),null},W.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),0},W.prototype.GetBodyA=function(){return this.m_bodyA},W.prototype.GetBodyB=function(){return this.m_bodyB},W.prototype.GetNext=function(){return this.m_next},W.prototype.GetUserData=function(){return this.m_userData},W.prototype.SetUserData=function(ge){this.m_userData=ge},W.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},W.Create=function(ge){var ve=null;switch(ge.type){case W.e_distanceJoint:ve=new J(ge instanceof F?ge:null);break;case W.e_mouseJoint:ve=new Y(ge instanceof Q?ge:null);break;case W.e_prismaticJoint:ve=new $(ge instanceof ee?ge:null);break;case W.e_revoluteJoint:ve=new ne(ge instanceof ie?ge:null);break;case W.e_pulleyJoint:ve=new oe(ge instanceof te?ge:null);break;case W.e_gearJoint:ve=new N(ge instanceof U?ge:null);break;case W.e_lineJoint:ve=new Z(ge instanceof H?ge:null);break;case W.e_weldJoint:ve=new me(ge instanceof ae?ge:null);break;case W.e_frictionJoint:ve=new R(ge instanceof E?ge:null);break;default:}return ve},W.Destroy=function(){},W.prototype.b2Joint=function(ge){_.b2Assert(ge.bodyA!=ge.bodyB),this.m_type=ge.type,this.m_prev=null,this.m_next=null,this.m_bodyA=ge.bodyA,this.m_bodyB=ge.bodyB,this.m_collideConnected=ge.collideConnected,this.m_islandFlag=!1,this.m_userData=ge.userData},W.prototype.InitVelocityConstraints=function(){},W.prototype.SolveVelocityConstraints=function(){},W.prototype.FinalizeVelocityConstraints=function(){},W.prototype.SolvePositionConstraints=function(ge){return void 0===ge&&(ge=0),!1},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0,Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1,Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2,Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3,Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4,Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5,Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6,Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7,Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8,Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9,Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0,Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1,Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2,Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3}),O.b2JointDef=function(){},O.prototype.b2JointDef=function(){this.type=W.e_unknownJoint,this.userData=null,this.bodyA=null,this.bodyB=null,this.collideConnected=!1},X.b2JointEdge=function(){},Box2D.inherit(Z,Box2D.Dynamics.Joints.b2Joint),Z.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,Z.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_localXAxis1=new G,this.m_localYAxis1=new G,this.m_axis=new G,this.m_perp=new G,this.m_K=new S,this.m_impulse=new G},Z.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},Z.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},Z.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),ge*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},Z.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),ge*this.m_impulse.y},Z.prototype.GetJointTranslation=function(){var ge=this.m_bodyA,De=this.m_bodyB,he=ge.GetWorldPoint(this.m_localAnchor1),Be=De.GetWorldPoint(this.m_localAnchor2),Ve=Be.x-he.x,Me=Be.y-he.y,we=ge.GetWorldVector(this.m_localXAxis1),Ie=we.x*Ve+we.y*Me;return Ie},Z.prototype.GetJointSpeed=function(){var ge=this.m_bodyA,De=this.m_bodyB,ve;ve=ge.m_xf.R;var he=this.m_localAnchor1.x-ge.m_sweep.localCenter.x,Be=this.m_localAnchor1.y-ge.m_sweep.localCenter.y,Ve=ve.col1.x*he+ve.col2.x*Be;Be=ve.col1.y*he+ve.col2.y*Be,he=Ve,ve=De.m_xf.R;var Me=this.m_localAnchor2.x-De.m_sweep.localCenter.x,we=this.m_localAnchor2.y-De.m_sweep.localCenter.y;Ve=ve.col1.x*Me+ve.col2.x*we,we=ve.col1.y*Me+ve.col2.y*we,Me=Ve;var Ie=ge.m_sweep.c.x+he,Ge=ge.m_sweep.c.y+Be,Le=De.m_sweep.c.x+Me,Je=De.m_sweep.c.y+we,Re=ge.GetWorldVector(this.m_localXAxis1),Te=ge.m_linearVelocity,ze=De.m_linearVelocity,Ee=ge.m_angularVelocity,ke=De.m_angularVelocity,Ne=(Le-Ie)*(-Ee*Re.y)+(Je-Ge)*(Ee*Re.x)+(Re.x*(ze.x+-ke*we-Te.x- -Ee*Be)+Re.y*(ze.y+ke*Me-Te.y-Ee*he));return Ne},Z.prototype.IsLimitEnabled=function(){return this.m_enableLimit},Z.prototype.EnableLimit=function(ge){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=ge},Z.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},Z.prototype.GetUpperLimit=function(){return this.m_upperTranslation},Z.prototype.SetLimits=function(ge,De){ge===void 0&&(ge=0),De===void 0&&(De=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=ge,this.m_upperTranslation=De},Z.prototype.IsMotorEnabled=function(){return this.m_enableMotor},Z.prototype.EnableMotor=function(ge){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=ge},Z.prototype.SetMotorSpeed=function(ge){ge===void 0&&(ge=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=ge},Z.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},Z.prototype.SetMaxMotorForce=function(ge){ge===void 0&&(ge=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=ge},Z.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},Z.prototype.GetMotorForce=function(){return this.m_motorImpulse},Z.prototype.b2LineJoint=function(ge){this.__super.b2Joint.call(this,ge);this.m_localAnchor1.SetV(ge.localAnchorA),this.m_localAnchor2.SetV(ge.localAnchorB),this.m_localXAxis1.SetV(ge.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=ge.lowerTranslation,this.m_upperTranslation=ge.upperTranslation,this.m_maxMotorForce=ge.maxMotorForce,this.m_motorSpeed=ge.motorSpeed,this.m_enableLimit=ge.enableLimit,this.m_enableMotor=ge.enableMotor,this.m_limitState=W.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},Z.prototype.InitVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,Be=0,he;this.m_localCenterA.SetV(De.GetLocalCenter()),this.m_localCenterB.SetV(ve.GetLocalCenter());var Ve=De.GetTransform(),Me=ve.GetTransform();he=De.m_xf.R;var we=this.m_localAnchor1.x-this.m_localCenterA.x,Ie=this.m_localAnchor1.y-this.m_localCenterA.y;Be=he.col1.x*we+he.col2.x*Ie,Ie=he.col1.y*we+he.col2.y*Ie,we=Be,he=ve.m_xf.R;var Ge=this.m_localAnchor2.x-this.m_localCenterB.x,Le=this.m_localAnchor2.y-this.m_localCenterB.y;Be=he.col1.x*Ge+he.col2.x*Le,Le=he.col1.y*Ge+he.col2.y*Le,Ge=Be;var Je=ve.m_sweep.c.x+Ge-De.m_sweep.c.x-we,Fe=ve.m_sweep.c.y+Le-De.m_sweep.c.y-Ie;this.m_invMassA=De.m_invMass,this.m_invMassB=ve.m_invMass,this.m_invIA=De.m_invI,this.m_invIB=ve.m_invI,this.m_axis.SetV(V.MulMV(Ve.R,this.m_localXAxis1)),this.m_a1=(Je+we)*this.m_axis.y-(Fe+Ie)*this.m_axis.x,this.m_a2=Ge*this.m_axis.y-Le*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;{this.m_perp.SetV(V.MulMV(Ve.R,this.m_localYAxis1)),this.m_s1=(Je+we)*this.m_perp.y-(Fe+Ie)*this.m_perp.x,this.m_s2=Ge*this.m_perp.y-Le*this.m_perp.x;var Pe=this.m_invMassA,Re=this.m_invMassB,Te=this.m_invIA,ze=this.m_invIB;this.m_K.col1.x=Pe+Re+Te*this.m_s1*this.m_s1+ze*this.m_s2*this.m_s2,this.m_K.col1.y=Te*this.m_s1*this.m_a1+ze*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=Pe+Re+Te*this.m_a1*this.m_a1+ze*this.m_a2*this.m_a2}if(this.m_enableLimit){var Ee=this.m_axis.x*Je+this.m_axis.y*Fe;V.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*_.b2_linearSlop?this.m_limitState=W.e_equalLimits:Ee<=this.m_lowerTranslation?this.m_limitState!=W.e_atLowerLimit&&(this.m_limitState=W.e_atLowerLimit,this.m_impulse.y=0):Ee>=this.m_upperTranslation?this.m_limitState!=W.e_atUpperLimit&&(this.m_limitState=W.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=W.e_inactiveLimit,this.m_impulse.y=0)}else this.m_limitState=W.e_inactiveLimit;if(!1==this.m_enableMotor&&(this.m_motorImpulse=0),ge.warmStarting){this.m_impulse.x*=ge.dtRatio,this.m_impulse.y*=ge.dtRatio,this.m_motorImpulse*=ge.dtRatio;var ke=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,Ne=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,je=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,Ue=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;De.m_linearVelocity.x-=this.m_invMassA*ke,De.m_linearVelocity.y-=this.m_invMassA*Ne,De.m_angularVelocity-=this.m_invIA*je,ve.m_linearVelocity.x+=this.m_invMassB*ke,ve.m_linearVelocity.y+=this.m_invMassB*Ne,ve.m_angularVelocity+=this.m_invIB*Ue}else this.m_impulse.SetZero(),this.m_motorImpulse=0},Z.prototype.SolveVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,he=De.m_linearVelocity,Be=De.m_angularVelocity,Ve=ve.m_linearVelocity,Me=ve.m_angularVelocity,we=0,Ie=0,Ge=0,Le=0;if(this.m_enableMotor&&this.m_limitState!=W.e_equalLimits){var Je=this.m_axis.x*(Ve.x-he.x)+this.m_axis.y*(Ve.y-he.y)+this.m_a2*Me-this.m_a1*Be,Fe=this.m_motorMass*(this.m_motorSpeed-Je),Pe=this.m_motorImpulse,Re=ge.dt*this.m_maxMotorForce;this.m_motorImpulse=V.Clamp(this.m_motorImpulse+Fe,-Re,Re),Fe=this.m_motorImpulse-Pe,we=Fe*this.m_axis.x,Ie=Fe*this.m_axis.y,Ge=Fe*this.m_a1,Le=Fe*this.m_a2,he.x-=this.m_invMassA*we,he.y-=this.m_invMassA*Ie,Be-=this.m_invIA*Ge,Ve.x+=this.m_invMassB*we,Ve.y+=this.m_invMassB*Ie,Me+=this.m_invIB*Le}var Te=this.m_perp.x*(Ve.x-he.x)+this.m_perp.y*(Ve.y-he.y)+this.m_s2*Me-this.m_s1*Be;if(this.m_enableLimit&&this.m_limitState!=W.e_inactiveLimit){var ze=this.m_axis.x*(Ve.x-he.x)+this.m_axis.y*(Ve.y-he.y)+this.m_a2*Me-this.m_a1*Be,Ee=this.m_impulse.Copy(),ke=this.m_K.Solve(new G,-Te,-ze);this.m_impulse.Add(ke),this.m_limitState==W.e_atLowerLimit?this.m_impulse.y=V.Max(this.m_impulse.y,0):this.m_limitState==W.e_atUpperLimit&&(this.m_impulse.y=V.Min(this.m_impulse.y,0));var Ne=-Te-(this.m_impulse.y-Ee.y)*this.m_K.col2.x,je=0;je=0==this.m_K.col1.x?Ee.x:Ne/this.m_K.col1.x+Ee.x,this.m_impulse.x=je,ke.x=this.m_impulse.x-Ee.x,ke.y=this.m_impulse.y-Ee.y,we=ke.x*this.m_perp.x+ke.y*this.m_axis.x,Ie=ke.x*this.m_perp.y+ke.y*this.m_axis.y,Ge=ke.x*this.m_s1+ke.y*this.m_a1,Le=ke.x*this.m_s2+ke.y*this.m_a2,he.x-=this.m_invMassA*we,he.y-=this.m_invMassA*Ie,Be-=this.m_invIA*Ge,Ve.x+=this.m_invMassB*we,Ve.y+=this.m_invMassB*Ie,Me+=this.m_invIB*Le}else{var Ue=0;Ue=0==this.m_K.col1.x?0:-Te/this.m_K.col1.x,this.m_impulse.x+=Ue,we=Ue*this.m_perp.x,Ie=Ue*this.m_perp.y,Ge=Ue*this.m_s1,Le=Ue*this.m_s2,he.x-=this.m_invMassA*we,he.y-=this.m_invMassA*Ie,Be-=this.m_invIA*Ge,Ve.x+=this.m_invMassB*we,Ve.y+=this.m_invMassB*Ie,Me+=this.m_invIB*Le}De.m_linearVelocity.SetV(he),De.m_angularVelocity=Be,ve.m_linearVelocity.SetV(Ve),ve.m_angularVelocity=Me},Z.prototype.SolvePositionConstraints=function(ge){void 0===ge&&(ge=0);var he=this.m_bodyA,Be=this.m_bodyB,Ve=he.m_sweep.c,Me=he.m_sweep.a,we=Be.m_sweep.c,Ie=Be.m_sweep.a,Le=0,Je=0,Fe=0,Pe=0,Re=0,Te=0,ze=0,Ee=!1,ke=0,Ne=S.FromAngle(Me),je=S.FromAngle(Ie),Ge;Ge=Ne;var Ue=this.m_localAnchor1.x-this.m_localCenterA.x,qe=this.m_localAnchor1.y-this.m_localCenterA.y;Le=Ge.col1.x*Ue+Ge.col2.x*qe,qe=Ge.col1.y*Ue+Ge.col2.y*qe,Ue=Le,Ge=je;var Ke=this.m_localAnchor2.x-this.m_localCenterB.x,We=this.m_localAnchor2.y-this.m_localCenterB.y;Le=Ge.col1.x*Ke+Ge.col2.x*We,We=Ge.col1.y*Ke+Ge.col2.y*We,Ke=Le;var Oe=we.x+Ke-Ve.x-Ue,Xe=we.y+We-Ve.y-qe;if(this.m_enableLimit){this.m_axis=V.MulMV(Ne,this.m_localXAxis1),this.m_a1=(Oe+Ue)*this.m_axis.y-(Xe+qe)*this.m_axis.x,this.m_a2=Ke*this.m_axis.y-We*this.m_axis.x;var Ze=this.m_axis.x*Oe+this.m_axis.y*Xe;V.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*_.b2_linearSlop?(ke=V.Clamp(Ze,-_.b2_maxLinearCorrection,_.b2_maxLinearCorrection),Te=V.Abs(Ze),Ee=!0):Ze<=this.m_lowerTranslation?(ke=V.Clamp(Ze-this.m_lowerTranslation+_.b2_linearSlop,-_.b2_maxLinearCorrection,0),Te=this.m_lowerTranslation-Ze,Ee=!0):Ze>=this.m_upperTranslation&&(ke=V.Clamp(Ze-this.m_upperTranslation+_.b2_linearSlop,0,_.b2_maxLinearCorrection),Te=Ze-this.m_upperTranslation,Ee=!0)}this.m_perp=V.MulMV(Ne,this.m_localYAxis1),this.m_s1=(Oe+Ue)*this.m_perp.y-(Xe+qe)*this.m_perp.x,this.m_s2=Ke*this.m_perp.y-We*this.m_perp.x;var He=new G,Ye=this.m_perp.x*Oe+this.m_perp.y*Xe;if(Te=V.Max(Te,V.Abs(Ye)),ze=0,Ee)Je=this.m_invMassA,Fe=this.m_invMassB,Pe=this.m_invIA,Re=this.m_invIB,this.m_K.col1.x=Je+Fe+Pe*this.m_s1*this.m_s1+Re*this.m_s2*this.m_s2,this.m_K.col1.y=Pe*this.m_s1*this.m_a1+Re*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=Je+Fe+Pe*this.m_a1*this.m_a1+Re*this.m_a2*this.m_a2,this.m_K.Solve(He,-Ye,-ke);else{Je=this.m_invMassA,Fe=this.m_invMassB,Pe=this.m_invIA,Re=this.m_invIB;var Qe=Je+Fe+Pe*this.m_s1*this.m_s1+Re*this.m_s2*this.m_s2,$e=0;$e=0==Qe?0:-Ye/Qe,He.x=$e,He.y=0}var eo=He.x*this.m_perp.x+He.y*this.m_axis.x,oo=He.x*this.m_perp.y+He.y*this.m_axis.y,to=He.x*this.m_s1+He.y*this.m_a1,no=He.x*this.m_s2+He.y*this.m_a2;return Ve.x-=this.m_invMassA*eo,Ve.y-=this.m_invMassA*oo,Me-=this.m_invIA*to,we.x+=this.m_invMassB*eo,we.y+=this.m_invMassB*oo,Ie+=this.m_invIB*no,he.m_sweep.a=Me,Be.m_sweep.a=Ie,he.SynchronizeTransform(),Be.SynchronizeTransform(),Te<=_.b2_linearSlop&&ze<=_.b2_angularSlop},Box2D.inherit(H,Box2D.Dynamics.Joints.b2JointDef),H.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,H.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G,this.localAxisA=new G},H.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_lineJoint,this.localAxisA.Set(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},H.prototype.Initialize=function(ge,De,ve,he){this.bodyA=ge,this.bodyB=De,this.localAnchorA=this.bodyA.GetLocalPoint(ve),this.localAnchorB=this.bodyB.GetLocalPoint(ve),this.localAxisA=this.bodyA.GetLocalVector(he)},Box2D.inherit(Y,Box2D.Dynamics.Joints.b2Joint),Y.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,Y.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new S,this.K1=new S,this.K2=new S,this.m_localAnchor=new G,this.m_target=new G,this.m_impulse=new G,this.m_mass=new S,this.m_C=new G},Y.prototype.GetAnchorA=function(){return this.m_target},Y.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)},Y.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_impulse.x,ge*this.m_impulse.y)},Y.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),0},Y.prototype.GetTarget=function(){return this.m_target},Y.prototype.SetTarget=function(ge){!1==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=ge},Y.prototype.GetMaxForce=function(){return this.m_maxForce},Y.prototype.SetMaxForce=function(ge){ge===void 0&&(ge=0),this.m_maxForce=ge},Y.prototype.GetFrequency=function(){return this.m_frequencyHz},Y.prototype.SetFrequency=function(ge){ge===void 0&&(ge=0),this.m_frequencyHz=ge},Y.prototype.GetDampingRatio=function(){return this.m_dampingRatio},Y.prototype.SetDampingRatio=function(ge){ge===void 0&&(ge=0),this.m_dampingRatio=ge},Y.prototype.b2MouseJoint=function(ge){this.__super.b2Joint.call(this,ge),this.m_target.SetV(ge.target);var De=this.m_target.x-this.m_bodyB.m_xf.position.x,ve=this.m_target.y-this.m_bodyB.m_xf.position.y,he=this.m_bodyB.m_xf.R;this.m_localAnchor.x=De*he.col1.x+ve*he.col1.y,this.m_localAnchor.y=De*he.col2.x+ve*he.col2.y,this.m_maxForce=ge.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=ge.frequencyHz,this.m_dampingRatio=ge.dampingRatio,this.m_beta=0,this.m_gamma=0},Y.prototype.InitVelocityConstraints=function(ge){var De=this.m_bodyB,ve=De.GetMass(),he=2*Math.PI*this.m_frequencyHz,Be=2*ve*this.m_dampingRatio*he,Ve=ve*he*he;this.m_gamma=ge.dt*(Be+ge.dt*Ve),this.m_gamma=0==this.m_gamma?0:1/this.m_gamma,this.m_beta=ge.dt*Ve*this.m_gamma;var Me=De.m_xf.R;var we=this.m_localAnchor.x-De.m_sweep.localCenter.x,Ie=this.m_localAnchor.y-De.m_sweep.localCenter.y,Ge=Me.col1.x*we+Me.col2.x*Ie;Ie=Me.col1.y*we+Me.col2.y*Ie,we=Ge;var Le=De.m_invMass,Je=De.m_invI;this.K1.col1.x=Le,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=Le,this.K2.col1.x=Je*Ie*Ie,this.K2.col2.x=-Je*we*Ie,this.K2.col1.y=-Je*we*Ie,this.K2.col2.y=Je*we*we,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=De.m_sweep.c.x+we-this.m_target.x,this.m_C.y=De.m_sweep.c.y+Ie-this.m_target.y,De.m_angularVelocity*=0.98,this.m_impulse.x*=ge.dtRatio,this.m_impulse.y*=ge.dtRatio,De.m_linearVelocity.x+=Le*this.m_impulse.x,De.m_linearVelocity.y+=Le*this.m_impulse.y,De.m_angularVelocity+=Je*(we*this.m_impulse.y-Ie*this.m_impulse.x)},Y.prototype.SolveVelocityConstraints=function(ge){var De=this.m_bodyB,ve,he=0,Be=0;ve=De.m_xf.R;var Ve=this.m_localAnchor.x-De.m_sweep.localCenter.x,Me=this.m_localAnchor.y-De.m_sweep.localCenter.y;he=ve.col1.x*Ve+ve.col2.x*Me,Me=ve.col1.y*Ve+ve.col2.y*Me,Ve=he;var we=De.m_linearVelocity.x+-De.m_angularVelocity*Me,Ie=De.m_linearVelocity.y+De.m_angularVelocity*Ve;ve=this.m_mass,he=we+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,Be=Ie+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var Ge=-(ve.col1.x*he+ve.col2.x*Be),Le=-(ve.col1.y*he+ve.col2.y*Be),Je=this.m_impulse.x,Fe=this.m_impulse.y;this.m_impulse.x+=Ge,this.m_impulse.y+=Le;var Pe=ge.dt*this.m_maxForce;this.m_impulse.LengthSquared()>Pe*Pe&&this.m_impulse.Multiply(Pe/this.m_impulse.Length()),Ge=this.m_impulse.x-Je,Le=this.m_impulse.y-Fe,De.m_linearVelocity.x+=De.m_invMass*Ge,De.m_linearVelocity.y+=De.m_invMass*Le,De.m_angularVelocity+=De.m_invI*(Ve*Le-Me*Ge)},Y.prototype.SolvePositionConstraints=function(ge){return void 0===ge&&(ge=0),!0},Box2D.inherit(Q,Box2D.Dynamics.Joints.b2JointDef),Q.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,Q.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.target=new G},Q.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_mouseJoint,this.maxForce=0,this.frequencyHz=5,this.dampingRatio=0.7},Box2D.inherit($,Box2D.Dynamics.Joints.b2Joint),$.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,$.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_localXAxis1=new G,this.m_localYAxis1=new G,this.m_axis=new G,this.m_perp=new G,this.m_K=new g,this.m_impulse=new L},$.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},$.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},$.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),ge*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},$.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),ge*this.m_impulse.y},$.prototype.GetJointTranslation=function(){var ge=this.m_bodyA,De=this.m_bodyB,he=ge.GetWorldPoint(this.m_localAnchor1),Be=De.GetWorldPoint(this.m_localAnchor2),Ve=Be.x-he.x,Me=Be.y-he.y,we=ge.GetWorldVector(this.m_localXAxis1),Ie=we.x*Ve+we.y*Me;return Ie},$.prototype.GetJointSpeed=function(){var ge=this.m_bodyA,De=this.m_bodyB,ve;ve=ge.m_xf.R;var he=this.m_localAnchor1.x-ge.m_sweep.localCenter.x,Be=this.m_localAnchor1.y-ge.m_sweep.localCenter.y,Ve=ve.col1.x*he+ve.col2.x*Be;Be=ve.col1.y*he+ve.col2.y*Be,he=Ve,ve=De.m_xf.R;var Me=this.m_localAnchor2.x-De.m_sweep.localCenter.x,we=this.m_localAnchor2.y-De.m_sweep.localCenter.y;Ve=ve.col1.x*Me+ve.col2.x*we,we=ve.col1.y*Me+ve.col2.y*we,Me=Ve;var Ie=ge.m_sweep.c.x+he,Ge=ge.m_sweep.c.y+Be,Le=De.m_sweep.c.x+Me,Je=De.m_sweep.c.y+we,Re=ge.GetWorldVector(this.m_localXAxis1),Te=ge.m_linearVelocity,ze=De.m_linearVelocity,Ee=ge.m_angularVelocity,ke=De.m_angularVelocity,Ne=(Le-Ie)*(-Ee*Re.y)+(Je-Ge)*(Ee*Re.x)+(Re.x*(ze.x+-ke*we-Te.x- -Ee*Be)+Re.y*(ze.y+ke*Me-Te.y-Ee*he));return Ne},$.prototype.IsLimitEnabled=function(){return this.m_enableLimit},$.prototype.EnableLimit=function(ge){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=ge},$.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},$.prototype.GetUpperLimit=function(){return this.m_upperTranslation},$.prototype.SetLimits=function(ge,De){ge===void 0&&(ge=0),De===void 0&&(De=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=ge,this.m_upperTranslation=De},$.prototype.IsMotorEnabled=function(){return this.m_enableMotor},$.prototype.EnableMotor=function(ge){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=ge},$.prototype.SetMotorSpeed=function(ge){ge===void 0&&(ge=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=ge},$.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},$.prototype.SetMaxMotorForce=function(ge){ge===void 0&&(ge=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=ge},$.prototype.GetMotorForce=function(){return this.m_motorImpulse},$.prototype.b2PrismaticJoint=function(ge){this.__super.b2Joint.call(this,ge);this.m_localAnchor1.SetV(ge.localAnchorA),this.m_localAnchor2.SetV(ge.localAnchorB),this.m_localXAxis1.SetV(ge.localAxisA),this.m_localYAxis1.x=-this.m_localXAxis1.y,this.m_localYAxis1.y=this.m_localXAxis1.x,this.m_refAngle=ge.referenceAngle,this.m_impulse.SetZero(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=ge.lowerTranslation,this.m_upperTranslation=ge.upperTranslation,this.m_maxMotorForce=ge.maxMotorForce,this.m_motorSpeed=ge.motorSpeed,this.m_enableLimit=ge.enableLimit,this.m_enableMotor=ge.enableMotor,this.m_limitState=W.e_inactiveLimit,this.m_axis.SetZero(),this.m_perp.SetZero()},$.prototype.InitVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,Be=0,he;this.m_localCenterA.SetV(De.GetLocalCenter()),this.m_localCenterB.SetV(ve.GetLocalCenter());var Ve=De.GetTransform(),Me=ve.GetTransform();he=De.m_xf.R;var we=this.m_localAnchor1.x-this.m_localCenterA.x,Ie=this.m_localAnchor1.y-this.m_localCenterA.y;Be=he.col1.x*we+he.col2.x*Ie,Ie=he.col1.y*we+he.col2.y*Ie,we=Be,he=ve.m_xf.R;var Ge=this.m_localAnchor2.x-this.m_localCenterB.x,Le=this.m_localAnchor2.y-this.m_localCenterB.y;Be=he.col1.x*Ge+he.col2.x*Le,Le=he.col1.y*Ge+he.col2.y*Le,Ge=Be;var Je=ve.m_sweep.c.x+Ge-De.m_sweep.c.x-we,Fe=ve.m_sweep.c.y+Le-De.m_sweep.c.y-Ie;this.m_invMassA=De.m_invMass,this.m_invMassB=ve.m_invMass,this.m_invIA=De.m_invI,this.m_invIB=ve.m_invI,this.m_axis.SetV(V.MulMV(Ve.R,this.m_localXAxis1)),this.m_a1=(Je+we)*this.m_axis.y-(Fe+Ie)*this.m_axis.x,this.m_a2=Ge*this.m_axis.y-Le*this.m_axis.x,this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2,this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp.SetV(V.MulMV(Ve.R,this.m_localYAxis1)),this.m_s1=(Je+we)*this.m_perp.y-(Fe+Ie)*this.m_perp.x,this.m_s2=Ge*this.m_perp.y-Le*this.m_perp.x;var Pe=this.m_invMassA,Re=this.m_invMassB,Te=this.m_invIA,ze=this.m_invIB;this.m_K.col1.x=Pe+Re+Te*this.m_s1*this.m_s1+ze*this.m_s2*this.m_s2,this.m_K.col1.y=Te*this.m_s1+ze*this.m_s2,this.m_K.col1.z=Te*this.m_s1*this.m_a1+ze*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=Te+ze,this.m_K.col2.z=Te*this.m_a1+ze*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=Pe+Re+Te*this.m_a1*this.m_a1+ze*this.m_a2*this.m_a2}if(this.m_enableLimit){var Ee=this.m_axis.x*Je+this.m_axis.y*Fe;V.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*_.b2_linearSlop?this.m_limitState=W.e_equalLimits:Ee<=this.m_lowerTranslation?this.m_limitState!=W.e_atLowerLimit&&(this.m_limitState=W.e_atLowerLimit,this.m_impulse.z=0):Ee>=this.m_upperTranslation?this.m_limitState!=W.e_atUpperLimit&&(this.m_limitState=W.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=W.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=W.e_inactiveLimit;if(!1==this.m_enableMotor&&(this.m_motorImpulse=0),ge.warmStarting){this.m_impulse.x*=ge.dtRatio,this.m_impulse.y*=ge.dtRatio,this.m_motorImpulse*=ge.dtRatio;var ke=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,Ne=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,je=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,Ue=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;De.m_linearVelocity.x-=this.m_invMassA*ke,De.m_linearVelocity.y-=this.m_invMassA*Ne,De.m_angularVelocity-=this.m_invIA*je,ve.m_linearVelocity.x+=this.m_invMassB*ke,ve.m_linearVelocity.y+=this.m_invMassB*Ne,ve.m_angularVelocity+=this.m_invIB*Ue}else this.m_impulse.SetZero(),this.m_motorImpulse=0},$.prototype.SolveVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,he=De.m_linearVelocity,Be=De.m_angularVelocity,Ve=ve.m_linearVelocity,Me=ve.m_angularVelocity,we=0,Ie=0,Ge=0,Le=0;if(this.m_enableMotor&&this.m_limitState!=W.e_equalLimits){var Je=this.m_axis.x*(Ve.x-he.x)+this.m_axis.y*(Ve.y-he.y)+this.m_a2*Me-this.m_a1*Be,Fe=this.m_motorMass*(this.m_motorSpeed-Je),Pe=this.m_motorImpulse,Re=ge.dt*this.m_maxMotorForce;this.m_motorImpulse=V.Clamp(this.m_motorImpulse+Fe,-Re,Re),Fe=this.m_motorImpulse-Pe,we=Fe*this.m_axis.x,Ie=Fe*this.m_axis.y,Ge=Fe*this.m_a1,Le=Fe*this.m_a2,he.x-=this.m_invMassA*we,he.y-=this.m_invMassA*Ie,Be-=this.m_invIA*Ge,Ve.x+=this.m_invMassB*we,Ve.y+=this.m_invMassB*Ie,Me+=this.m_invIB*Le}var Te=this.m_perp.x*(Ve.x-he.x)+this.m_perp.y*(Ve.y-he.y)+this.m_s2*Me-this.m_s1*Be,ze=Me-Be;if(this.m_enableLimit&&this.m_limitState!=W.e_inactiveLimit){var Ee=this.m_axis.x*(Ve.x-he.x)+this.m_axis.y*(Ve.y-he.y)+this.m_a2*Me-this.m_a1*Be,ke=this.m_impulse.Copy(),Ne=this.m_K.Solve33(new L,-Te,-ze,-Ee);this.m_impulse.Add(Ne),this.m_limitState==W.e_atLowerLimit?this.m_impulse.z=V.Max(this.m_impulse.z,0):this.m_limitState==W.e_atUpperLimit&&(this.m_impulse.z=V.Min(this.m_impulse.z,0));var je=-Te-(this.m_impulse.z-ke.z)*this.m_K.col3.x,Ue=-ze-(this.m_impulse.z-ke.z)*this.m_K.col3.y,qe=this.m_K.Solve22(new G,je,Ue);qe.x+=ke.x,qe.y+=ke.y,this.m_impulse.x=qe.x,this.m_impulse.y=qe.y,Ne.x=this.m_impulse.x-ke.x,Ne.y=this.m_impulse.y-ke.y,Ne.z=this.m_impulse.z-ke.z,we=Ne.x*this.m_perp.x+Ne.z*this.m_axis.x,Ie=Ne.x*this.m_perp.y+Ne.z*this.m_axis.y,Ge=Ne.x*this.m_s1+Ne.y+Ne.z*this.m_a1,Le=Ne.x*this.m_s2+Ne.y+Ne.z*this.m_a2,he.x-=this.m_invMassA*we,he.y-=this.m_invMassA*Ie,Be-=this.m_invIA*Ge,Ve.x+=this.m_invMassB*we,Ve.y+=this.m_invMassB*Ie,Me+=this.m_invIB*Le}else{var Ke=this.m_K.Solve22(new G,-Te,-ze);this.m_impulse.x+=Ke.x,this.m_impulse.y+=Ke.y,we=Ke.x*this.m_perp.x,Ie=Ke.x*this.m_perp.y,Ge=Ke.x*this.m_s1+Ke.y,Le=Ke.x*this.m_s2+Ke.y,he.x-=this.m_invMassA*we,he.y-=this.m_invMassA*Ie,Be-=this.m_invIA*Ge,Ve.x+=this.m_invMassB*we,Ve.y+=this.m_invMassB*Ie,Me+=this.m_invIB*Le}De.m_linearVelocity.SetV(he),De.m_angularVelocity=Be,ve.m_linearVelocity.SetV(Ve),ve.m_angularVelocity=Me},$.prototype.SolvePositionConstraints=function(ge){void 0===ge&&(ge=0);var he=this.m_bodyA,Be=this.m_bodyB,Ve=he.m_sweep.c,Me=he.m_sweep.a,we=Be.m_sweep.c,Ie=Be.m_sweep.a,Le=0,Je=0,Fe=0,Pe=0,Re=0,Te=0,ze=0,Ee=!1,ke=0,Ne=S.FromAngle(Me),je=S.FromAngle(Ie),Ge;Ge=Ne;var Ue=this.m_localAnchor1.x-this.m_localCenterA.x,qe=this.m_localAnchor1.y-this.m_localCenterA.y;Le=Ge.col1.x*Ue+Ge.col2.x*qe,qe=Ge.col1.y*Ue+Ge.col2.y*qe,Ue=Le,Ge=je;var Ke=this.m_localAnchor2.x-this.m_localCenterB.x,We=this.m_localAnchor2.y-this.m_localCenterB.y;Le=Ge.col1.x*Ke+Ge.col2.x*We,We=Ge.col1.y*Ke+Ge.col2.y*We,Ke=Le;var Oe=we.x+Ke-Ve.x-Ue,Xe=we.y+We-Ve.y-qe;if(this.m_enableLimit){this.m_axis=V.MulMV(Ne,this.m_localXAxis1),this.m_a1=(Oe+Ue)*this.m_axis.y-(Xe+qe)*this.m_axis.x,this.m_a2=Ke*this.m_axis.y-We*this.m_axis.x;var Ze=this.m_axis.x*Oe+this.m_axis.y*Xe;V.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*_.b2_linearSlop?(ke=V.Clamp(Ze,-_.b2_maxLinearCorrection,_.b2_maxLinearCorrection),Te=V.Abs(Ze),Ee=!0):Ze<=this.m_lowerTranslation?(ke=V.Clamp(Ze-this.m_lowerTranslation+_.b2_linearSlop,-_.b2_maxLinearCorrection,0),Te=this.m_lowerTranslation-Ze,Ee=!0):Ze>=this.m_upperTranslation&&(ke=V.Clamp(Ze-this.m_upperTranslation+_.b2_linearSlop,0,_.b2_maxLinearCorrection),Te=Ze-this.m_upperTranslation,Ee=!0)}this.m_perp=V.MulMV(Ne,this.m_localYAxis1),this.m_s1=(Oe+Ue)*this.m_perp.y-(Xe+qe)*this.m_perp.x,this.m_s2=Ke*this.m_perp.y-We*this.m_perp.x;var He=new L,Ye=this.m_perp.x*Oe+this.m_perp.y*Xe,Qe=Ie-Me-this.m_refAngle;if(Te=V.Max(Te,V.Abs(Ye)),ze=V.Abs(Qe),Ee)Je=this.m_invMassA,Fe=this.m_invMassB,Pe=this.m_invIA,Re=this.m_invIB,this.m_K.col1.x=Je+Fe+Pe*this.m_s1*this.m_s1+Re*this.m_s2*this.m_s2,this.m_K.col1.y=Pe*this.m_s1+Re*this.m_s2,this.m_K.col1.z=Pe*this.m_s1*this.m_a1+Re*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=Pe+Re,this.m_K.col2.z=Pe*this.m_a1+Re*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=Je+Fe+Pe*this.m_a1*this.m_a1+Re*this.m_a2*this.m_a2,this.m_K.Solve33(He,-Ye,-Qe,-ke);else{Je=this.m_invMassA,Fe=this.m_invMassB,Pe=this.m_invIA,Re=this.m_invIB;var $e=Je+Fe+Pe*this.m_s1*this.m_s1+Re*this.m_s2*this.m_s2,eo=Pe*this.m_s1+Re*this.m_s2,oo=Pe+Re;this.m_K.col1.Set($e,eo,0),this.m_K.col2.Set(eo,oo,0);var to=this.m_K.Solve22(new G,-Ye,-Qe);He.x=to.x,He.y=to.y,He.z=0}var no=He.x*this.m_perp.x+He.z*this.m_axis.x,io=He.x*this.m_perp.y+He.z*this.m_axis.y,mo=He.x*this.m_s1+He.y+He.z*this.m_a1,ao=He.x*this.m_s2+He.y+He.z*this.m_a2;return Ve.x-=this.m_invMassA*no,Ve.y-=this.m_invMassA*io,Me-=this.m_invIA*mo,we.x+=this.m_invMassB*no,we.y+=this.m_invMassB*io,Ie+=this.m_invIB*ao,he.m_sweep.a=Me,Be.m_sweep.a=Ie,he.SynchronizeTransform(),Be.SynchronizeTransform(),Te<=_.b2_linearSlop&&ze<=_.b2_angularSlop},Box2D.inherit(ee,Box2D.Dynamics.Joints.b2JointDef),ee.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,ee.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G,this.localAxisA=new G},ee.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_prismaticJoint,this.localAxisA.Set(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0},ee.prototype.Initialize=function(ge,De,ve,he){this.bodyA=ge,this.bodyB=De,this.localAnchorA=this.bodyA.GetLocalPoint(ve),this.localAnchorB=this.bodyB.GetLocalPoint(ve),this.localAxisA=this.bodyA.GetLocalVector(he),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(oe,Box2D.Dynamics.Joints.b2Joint),oe.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,oe.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_groundAnchor1=new G,this.m_groundAnchor2=new G,this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_u1=new G,this.m_u2=new G},oe.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},oe.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},oe.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_impulse*this.m_u2.x,ge*this.m_impulse*this.m_u2.y)},oe.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),0},oe.prototype.GetGroundAnchorA=function(){var ge=this.m_ground.m_xf.position.Copy();return ge.Add(this.m_groundAnchor1),ge},oe.prototype.GetGroundAnchorB=function(){var ge=this.m_ground.m_xf.position.Copy();return ge.Add(this.m_groundAnchor2),ge},oe.prototype.GetLength1=function(){var ge=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),De=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,ve=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,he=ge.x-De,Be=ge.y-ve;return Math.sqrt(he*he+Be*Be)},oe.prototype.GetLength2=function(){var ge=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),De=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,ve=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,he=ge.x-De,Be=ge.y-ve;return Math.sqrt(he*he+Be*Be)},oe.prototype.GetRatio=function(){return this.m_ratio},oe.prototype.b2PulleyJoint=function(ge){this.__super.b2Joint.call(this,ge);this.m_ground=this.m_bodyA.m_world.m_groundBody,this.m_groundAnchor1.x=ge.groundAnchorA.x-this.m_ground.m_xf.position.x,this.m_groundAnchor1.y=ge.groundAnchorA.y-this.m_ground.m_xf.position.y,this.m_groundAnchor2.x=ge.groundAnchorB.x-this.m_ground.m_xf.position.x,this.m_groundAnchor2.y=ge.groundAnchorB.y-this.m_ground.m_xf.position.y,this.m_localAnchor1.SetV(ge.localAnchorA),this.m_localAnchor2.SetV(ge.localAnchorB),this.m_ratio=ge.ratio,this.m_constant=ge.lengthA+this.m_ratio*ge.lengthB,this.m_maxLength1=V.Min(ge.maxLengthA,this.m_constant-this.m_ratio*oe.b2_minPulleyLength),this.m_maxLength2=V.Min(ge.maxLengthB,(this.m_constant-oe.b2_minPulleyLength)/this.m_ratio),this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},oe.prototype.InitVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,he;he=De.m_xf.R;var Be=this.m_localAnchor1.x-De.m_sweep.localCenter.x,Ve=this.m_localAnchor1.y-De.m_sweep.localCenter.y,Me=he.col1.x*Be+he.col2.x*Ve;Ve=he.col1.y*Be+he.col2.y*Ve,Be=Me,he=ve.m_xf.R;var we=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-ve.m_sweep.localCenter.y;Me=he.col1.x*we+he.col2.x*Ie,Ie=he.col1.y*we+he.col2.y*Ie,we=Me;var Ge=De.m_sweep.c.x+Be,Le=De.m_sweep.c.y+Ve,Je=ve.m_sweep.c.x+we,Fe=ve.m_sweep.c.y+Ie,Pe=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,Re=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,Te=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,ze=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(Ge-Pe,Le-Re),this.m_u2.Set(Je-Te,Fe-ze);var Ee=this.m_u1.Length(),ke=this.m_u2.Length();Ee>_.b2_linearSlop?this.m_u1.Multiply(1/Ee):this.m_u1.SetZero(),ke>_.b2_linearSlop?this.m_u2.Multiply(1/ke):this.m_u2.SetZero();var Ne=this.m_constant-Ee-this.m_ratio*ke;0<Ne?(this.m_state=W.e_inactiveLimit,this.m_impulse=0):this.m_state=W.e_atUpperLimit,Ee<this.m_maxLength1?(this.m_limitState1=W.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=W.e_atUpperLimit,ke<this.m_maxLength2?(this.m_limitState2=W.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=W.e_atUpperLimit;var je=Be*this.m_u1.y-Ve*this.m_u1.x,Ue=we*this.m_u2.y-Ie*this.m_u2.x;if(this.m_limitMass1=De.m_invMass+De.m_invI*je*je,this.m_limitMass2=ve.m_invMass+ve.m_invI*Ue*Ue,this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2,this.m_limitMass1=1/this.m_limitMass1,this.m_limitMass2=1/this.m_limitMass2,this.m_pulleyMass=1/this.m_pulleyMass,ge.warmStarting){this.m_impulse*=ge.dtRatio,this.m_limitImpulse1*=ge.dtRatio,this.m_limitImpulse2*=ge.dtRatio;var qe=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,Ke=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,We=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,Oe=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y;De.m_linearVelocity.x+=De.m_invMass*qe,De.m_linearVelocity.y+=De.m_invMass*Ke,De.m_angularVelocity+=De.m_invI*(Be*Ke-Ve*qe),ve.m_linearVelocity.x+=ve.m_invMass*We,ve.m_linearVelocity.y+=ve.m_invMass*Oe,ve.m_angularVelocity+=ve.m_invI*(we*Oe-Ie*We)}else this.m_impulse=0,this.m_limitImpulse1=0,this.m_limitImpulse2=0},oe.prototype.SolveVelocityConstraints=function(){var De=this.m_bodyA,ve=this.m_bodyB,he;he=De.m_xf.R;var Be=this.m_localAnchor1.x-De.m_sweep.localCenter.x,Ve=this.m_localAnchor1.y-De.m_sweep.localCenter.y,Me=he.col1.x*Be+he.col2.x*Ve;Ve=he.col1.y*Be+he.col2.y*Ve,Be=Me,he=ve.m_xf.R;var we=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-ve.m_sweep.localCenter.y;Me=he.col1.x*we+he.col2.x*Ie,Ie=he.col1.y*we+he.col2.y*Ie,we=Me;var Ge=0,Le=0,Je=0,Fe=0,Pe=0,Re=0,Te=0,ze=0,Ee=0,ke=0,Ne=0;this.m_state==W.e_atUpperLimit&&(Ge=De.m_linearVelocity.x+-De.m_angularVelocity*Ve,Le=De.m_linearVelocity.y+De.m_angularVelocity*Be,Je=ve.m_linearVelocity.x+-ve.m_angularVelocity*Ie,Fe=ve.m_linearVelocity.y+ve.m_angularVelocity*we,Ee=-(this.m_u1.x*Ge+this.m_u1.y*Le)-this.m_ratio*(this.m_u2.x*Je+this.m_u2.y*Fe),ke=this.m_pulleyMass*-Ee,Ne=this.m_impulse,this.m_impulse=V.Max(0,this.m_impulse+ke),ke=this.m_impulse-Ne,Pe=-ke*this.m_u1.x,Re=-ke*this.m_u1.y,Te=-this.m_ratio*ke*this.m_u2.x,ze=-this.m_ratio*ke*this.m_u2.y,De.m_linearVelocity.x+=De.m_invMass*Pe,De.m_linearVelocity.y+=De.m_invMass*Re,De.m_angularVelocity+=De.m_invI*(Be*Re-Ve*Pe),ve.m_linearVelocity.x+=ve.m_invMass*Te,ve.m_linearVelocity.y+=ve.m_invMass*ze,ve.m_angularVelocity+=ve.m_invI*(we*ze-Ie*Te)),this.m_limitState1==W.e_atUpperLimit&&(Ge=De.m_linearVelocity.x+-De.m_angularVelocity*Ve,Le=De.m_linearVelocity.y+De.m_angularVelocity*Be,Ee=-(this.m_u1.x*Ge+this.m_u1.y*Le),ke=-this.m_limitMass1*Ee,Ne=this.m_limitImpulse1,this.m_limitImpulse1=V.Max(0,this.m_limitImpulse1+ke),ke=this.m_limitImpulse1-Ne,Pe=-ke*this.m_u1.x,Re=-ke*this.m_u1.y,De.m_linearVelocity.x+=De.m_invMass*Pe,De.m_linearVelocity.y+=De.m_invMass*Re,De.m_angularVelocity+=De.m_invI*(Be*Re-Ve*Pe)),this.m_limitState2==W.e_atUpperLimit&&(Je=ve.m_linearVelocity.x+-ve.m_angularVelocity*Ie,Fe=ve.m_linearVelocity.y+ve.m_angularVelocity*we,Ee=-(this.m_u2.x*Je+this.m_u2.y*Fe),ke=-this.m_limitMass2*Ee,Ne=this.m_limitImpulse2,this.m_limitImpulse2=V.Max(0,this.m_limitImpulse2+ke),ke=this.m_limitImpulse2-Ne,Te=-ke*this.m_u2.x,ze=-ke*this.m_u2.y,ve.m_linearVelocity.x+=ve.m_invMass*Te,ve.m_linearVelocity.y+=ve.m_invMass*ze,ve.m_angularVelocity+=ve.m_invI*(we*ze-Ie*Te))},oe.prototype.SolvePositionConstraints=function(ge){void 0===ge&&(ge=0);var De=this.m_bodyA,ve=this.m_bodyB,Be=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,Ve=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,Me=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,we=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,Ie=0,Ge=0,Le=0,Je=0,Fe=0,Pe=0,Re=0,Te=0,ze=0,Ee=0,ke=0,Ne=0,qe=0,Ke=0,he;return this.m_state==W.e_atUpperLimit&&(he=De.m_xf.R,Ie=this.m_localAnchor1.x-De.m_sweep.localCenter.x,Ge=this.m_localAnchor1.y-De.m_sweep.localCenter.y,qe=he.col1.x*Ie+he.col2.x*Ge,Ge=he.col1.y*Ie+he.col2.y*Ge,Ie=qe,he=ve.m_xf.R,Le=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Je=this.m_localAnchor2.y-ve.m_sweep.localCenter.y,qe=he.col1.x*Le+he.col2.x*Je,Je=he.col1.y*Le+he.col2.y*Je,Le=qe,Fe=De.m_sweep.c.x+Ie,Pe=De.m_sweep.c.y+Ge,Re=ve.m_sweep.c.x+Le,Te=ve.m_sweep.c.y+Je,this.m_u1.Set(Fe-Be,Pe-Ve),this.m_u2.Set(Re-Me,Te-we),ze=this.m_u1.Length(),Ee=this.m_u2.Length(),ze>_.b2_linearSlop?this.m_u1.Multiply(1/ze):this.m_u1.SetZero(),Ee>_.b2_linearSlop?this.m_u2.Multiply(1/Ee):this.m_u2.SetZero(),ke=this.m_constant-ze-this.m_ratio*Ee,Ke=V.Max(Ke,-ke),ke=V.Clamp(ke+_.b2_linearSlop,-_.b2_maxLinearCorrection,0),Ne=-this.m_pulleyMass*ke,Fe=-Ne*this.m_u1.x,Pe=-Ne*this.m_u1.y,Re=-this.m_ratio*Ne*this.m_u2.x,Te=-this.m_ratio*Ne*this.m_u2.y,De.m_sweep.c.x+=De.m_invMass*Fe,De.m_sweep.c.y+=De.m_invMass*Pe,De.m_sweep.a+=De.m_invI*(Ie*Pe-Ge*Fe),ve.m_sweep.c.x+=ve.m_invMass*Re,ve.m_sweep.c.y+=ve.m_invMass*Te,ve.m_sweep.a+=ve.m_invI*(Le*Te-Je*Re),De.SynchronizeTransform(),ve.SynchronizeTransform()),this.m_limitState1==W.e_atUpperLimit&&(he=De.m_xf.R,Ie=this.m_localAnchor1.x-De.m_sweep.localCenter.x,Ge=this.m_localAnchor1.y-De.m_sweep.localCenter.y,qe=he.col1.x*Ie+he.col2.x*Ge,Ge=he.col1.y*Ie+he.col2.y*Ge,Ie=qe,Fe=De.m_sweep.c.x+Ie,Pe=De.m_sweep.c.y+Ge,this.m_u1.Set(Fe-Be,Pe-Ve),ze=this.m_u1.Length(),ze>_.b2_linearSlop?(this.m_u1.x*=1/ze,this.m_u1.y*=1/ze):this.m_u1.SetZero(),ke=this.m_maxLength1-ze,Ke=V.Max(Ke,-ke),ke=V.Clamp(ke+_.b2_linearSlop,-_.b2_maxLinearCorrection,0),Ne=-this.m_limitMass1*ke,Fe=-Ne*this.m_u1.x,Pe=-Ne*this.m_u1.y,De.m_sweep.c.x+=De.m_invMass*Fe,De.m_sweep.c.y+=De.m_invMass*Pe,De.m_sweep.a+=De.m_invI*(Ie*Pe-Ge*Fe),De.SynchronizeTransform()),this.m_limitState2==W.e_atUpperLimit&&(he=ve.m_xf.R,Le=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Je=this.m_localAnchor2.y-ve.m_sweep.localCenter.y,qe=he.col1.x*Le+he.col2.x*Je,Je=he.col1.y*Le+he.col2.y*Je,Le=qe,Re=ve.m_sweep.c.x+Le,Te=ve.m_sweep.c.y+Je,this.m_u2.Set(Re-Me,Te-we),Ee=this.m_u2.Length(),Ee>_.b2_linearSlop?(this.m_u2.x*=1/Ee,this.m_u2.y*=1/Ee):this.m_u2.SetZero(),ke=this.m_maxLength2-Ee,Ke=V.Max(Ke,-ke),ke=V.Clamp(ke+_.b2_linearSlop,-_.b2_maxLinearCorrection,0),Ne=-this.m_limitMass2*ke,Re=-Ne*this.m_u2.x,Te=-Ne*this.m_u2.y,ve.m_sweep.c.x+=ve.m_invMass*Re,ve.m_sweep.c.y+=ve.m_invMass*Te,ve.m_sweep.a+=ve.m_invI*(Le*Te-Je*Re),ve.SynchronizeTransform()),Ke<_.b2_linearSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2}),Box2D.inherit(te,Box2D.Dynamics.Joints.b2JointDef),te.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,te.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.groundAnchorA=new G,this.groundAnchorB=new G,this.localAnchorA=new G,this.localAnchorB=new G},te.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_pulleyJoint,this.groundAnchorA.Set(-1,1),this.groundAnchorB.Set(1,1),this.localAnchorA.Set(-1,0),this.localAnchorB.Set(1,0),this.lengthA=0,this.maxLengthA=0,this.lengthB=0,this.maxLengthB=0,this.ratio=1,this.collideConnected=!0},te.prototype.Initialize=function(ge,De,ve,he,Be,Ve,Me){Me===void 0&&(Me=0),this.bodyA=ge,this.bodyB=De,this.groundAnchorA.SetV(ve),this.groundAnchorB.SetV(he),this.localAnchorA=this.bodyA.GetLocalPoint(Be),this.localAnchorB=this.bodyB.GetLocalPoint(Ve);var we=Be.x-ve.x,Ie=Be.y-ve.y;this.lengthA=Math.sqrt(we*we+Ie*Ie);var Ge=Ve.x-he.x,Le=Ve.y-he.y;this.lengthB=Math.sqrt(Ge*Ge+Le*Le),this.ratio=Me;var Je=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=Je-this.ratio*oe.b2_minPulleyLength,this.maxLengthB=(Je-oe.b2_minPulleyLength)/this.ratio},Box2D.inherit(ne,Box2D.Dynamics.Joints.b2Joint),ne.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,ne.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.K=new S,this.K1=new S,this.K2=new S,this.K3=new S,this.impulse3=new L,this.impulse2=new G,this.reduced=new G,this.m_localAnchor1=new G,this.m_localAnchor2=new G,this.m_impulse=new L,this.m_mass=new g},ne.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)},ne.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)},ne.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_impulse.x,ge*this.m_impulse.y)},ne.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),ge*this.m_impulse.z},ne.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},ne.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},ne.prototype.IsLimitEnabled=function(){return this.m_enableLimit},ne.prototype.EnableLimit=function(ge){this.m_enableLimit=ge},ne.prototype.GetLowerLimit=function(){return this.m_lowerAngle},ne.prototype.GetUpperLimit=function(){return this.m_upperAngle},ne.prototype.SetLimits=function(ge,De){ge===void 0&&(ge=0),De===void 0&&(De=0),this.m_lowerAngle=ge,this.m_upperAngle=De},ne.prototype.IsMotorEnabled=function(){return this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor},ne.prototype.EnableMotor=function(ge){this.m_enableMotor=ge},ne.prototype.SetMotorSpeed=function(ge){ge===void 0&&(ge=0),this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=ge},ne.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},ne.prototype.SetMaxMotorTorque=function(ge){ge===void 0&&(ge=0),this.m_maxMotorTorque=ge},ne.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque},ne.prototype.b2RevoluteJoint=function(ge){this.__super.b2Joint.call(this,ge),this.m_localAnchor1.SetV(ge.localAnchorA),this.m_localAnchor2.SetV(ge.localAnchorB),this.m_referenceAngle=ge.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=ge.lowerAngle,this.m_upperAngle=ge.upperAngle,this.m_maxMotorTorque=ge.maxMotorTorque,this.m_motorSpeed=ge.motorSpeed,this.m_enableLimit=ge.enableLimit,this.m_enableMotor=ge.enableMotor,this.m_limitState=W.e_inactiveLimit},ne.prototype.InitVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,Be=0,he;this.m_enableMotor||this.m_enableLimit,he=De.m_xf.R;var Ve=this.m_localAnchor1.x-De.m_sweep.localCenter.x,Me=this.m_localAnchor1.y-De.m_sweep.localCenter.y;Be=he.col1.x*Ve+he.col2.x*Me,Me=he.col1.y*Ve+he.col2.y*Me,Ve=Be,he=ve.m_xf.R;var we=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Ie=this.m_localAnchor2.y-ve.m_sweep.localCenter.y;Be=he.col1.x*we+he.col2.x*Ie,Ie=he.col1.y*we+he.col2.y*Ie,we=Be;var Ge=De.m_invMass,Le=ve.m_invMass,Je=De.m_invI,Fe=ve.m_invI;if(this.m_mass.col1.x=Ge+Le+Me*Me*Je+Ie*Ie*Fe,this.m_mass.col2.x=-Me*Ve*Je-Ie*we*Fe,this.m_mass.col3.x=-Me*Je-Ie*Fe,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=Ge+Le+Ve*Ve*Je+we*we*Fe,this.m_mass.col3.y=Ve*Je+we*Fe,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=Je+Fe,this.m_motorMass=1/(Je+Fe),!1==this.m_enableMotor&&(this.m_motorImpulse=0),this.m_enableLimit){var Pe=ve.m_sweep.a-De.m_sweep.a-this.m_referenceAngle;V.Abs(this.m_upperAngle-this.m_lowerAngle)<2*_.b2_angularSlop?this.m_limitState=W.e_equalLimits:Pe<=this.m_lowerAngle?(this.m_limitState!=W.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=W.e_atLowerLimit):Pe>=this.m_upperAngle?(this.m_limitState!=W.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=W.e_atUpperLimit):(this.m_limitState=W.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=W.e_inactiveLimit;if(ge.warmStarting){this.m_impulse.x*=ge.dtRatio,this.m_impulse.y*=ge.dtRatio,this.m_motorImpulse*=ge.dtRatio;var Re=this.m_impulse.x,Te=this.m_impulse.y;De.m_linearVelocity.x-=Ge*Re,De.m_linearVelocity.y-=Ge*Te,De.m_angularVelocity-=Je*(Ve*Te-Me*Re+this.m_motorImpulse+this.m_impulse.z),ve.m_linearVelocity.x+=Le*Re,ve.m_linearVelocity.y+=Le*Te,ve.m_angularVelocity+=Fe*(we*Te-Ie*Re+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0},ne.prototype.SolveVelocityConstraints=function(ge){var De=this.m_bodyA,ve=this.m_bodyB,he,Be=0,Ve=0,Me=0,we=0,Ie=0,Ge=0,Le=De.m_linearVelocity,Je=De.m_angularVelocity,Fe=ve.m_linearVelocity,Pe=ve.m_angularVelocity,Re=De.m_invMass,Te=ve.m_invMass,ze=De.m_invI,Ee=ve.m_invI;if(this.m_enableMotor&&this.m_limitState!=W.e_equalLimits){var ke=Pe-Je-this.m_motorSpeed,Ne=this.m_motorMass*-ke,je=this.m_motorImpulse,Ue=ge.dt*this.m_maxMotorTorque;this.m_motorImpulse=V.Clamp(this.m_motorImpulse+Ne,-Ue,Ue),Ne=this.m_motorImpulse-je,Je-=ze*Ne,Pe+=Ee*Ne}if(this.m_enableLimit&&this.m_limitState!=W.e_inactiveLimit){he=De.m_xf.R,Me=this.m_localAnchor1.x-De.m_sweep.localCenter.x,we=this.m_localAnchor1.y-De.m_sweep.localCenter.y,Be=he.col1.x*Me+he.col2.x*we,we=he.col1.y*Me+he.col2.y*we,Me=Be,he=ve.m_xf.R,Ie=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Ge=this.m_localAnchor2.y-ve.m_sweep.localCenter.y,Be=he.col1.x*Ie+he.col2.x*Ge,Ge=he.col1.y*Ie+he.col2.y*Ge,Ie=Be;var qe=Fe.x+-Pe*Ge-Le.x- -Je*we,Ke=Fe.y+Pe*Ie-Le.y-Je*Me,We=Pe-Je;this.m_mass.Solve33(this.impulse3,-qe,-Ke,-We),this.m_limitState==W.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==W.e_atLowerLimit?(Ve=this.m_impulse.z+this.impulse3.z,0>Ve&&(this.m_mass.Solve22(this.reduced,-qe,-Ke),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==W.e_atUpperLimit&&(Ve=this.m_impulse.z+this.impulse3.z,0<Ve&&(this.m_mass.Solve22(this.reduced,-qe,-Ke),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)),Le.x-=Re*this.impulse3.x,Le.y-=Re*this.impulse3.y,Je-=ze*(Me*this.impulse3.y-we*this.impulse3.x+this.impulse3.z),Fe.x+=Te*this.impulse3.x,Fe.y+=Te*this.impulse3.y,Pe+=Ee*(Ie*this.impulse3.y-Ge*this.impulse3.x+this.impulse3.z)}else{he=De.m_xf.R,Me=this.m_localAnchor1.x-De.m_sweep.localCenter.x,we=this.m_localAnchor1.y-De.m_sweep.localCenter.y,Be=he.col1.x*Me+he.col2.x*we,we=he.col1.y*Me+he.col2.y*we,Me=Be,he=ve.m_xf.R,Ie=this.m_localAnchor2.x-ve.m_sweep.localCenter.x,Ge=this.m_localAnchor2.y-ve.m_sweep.localCenter.y,Be=he.col1.x*Ie+he.col2.x*Ge,Ge=he.col1.y*Ie+he.col2.y*Ge,Ie=Be;var Oe=Fe.x+-Pe*Ge-Le.x- -Je*we,Xe=Fe.y+Pe*Ie-Le.y-Je*Me;this.m_mass.Solve22(this.impulse2,-Oe,-Xe),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,Le.x-=Re*this.impulse2.x,Le.y-=Re*this.impulse2.y,Je-=ze*(Me*this.impulse2.y-we*this.impulse2.x),Fe.x+=Te*this.impulse2.x,Fe.y+=Te*this.impulse2.y,Pe+=Ee*(Ie*this.impulse2.y-Ge*this.impulse2.x)}De.m_linearVelocity.SetV(Le),De.m_angularVelocity=Je,ve.m_linearVelocity.SetV(Fe),ve.m_angularVelocity=Pe},ne.prototype.SolvePositionConstraints=function(ge){ge===void 0&&(ge=0);var ve=0,he,Be=this.m_bodyA,Ve=this.m_bodyB,Me=0,we=0,Ie=0,Ge=0,Le=0;if(this.m_enableLimit&&this.m_limitState!=W.e_inactiveLimit){var Je=Ve.m_sweep.a-Be.m_sweep.a-this.m_referenceAngle,Fe=0;this.m_limitState==W.e_equalLimits?(ve=V.Clamp(Je-this.m_lowerAngle,-_.b2_maxAngularCorrection,_.b2_maxAngularCorrection),Fe=-this.m_motorMass*ve,Me=V.Abs(ve)):this.m_limitState==W.e_atLowerLimit?(ve=Je-this.m_lowerAngle,Me=-ve,ve=V.Clamp(ve+_.b2_angularSlop,-_.b2_maxAngularCorrection,0),Fe=-this.m_motorMass*ve):this.m_limitState==W.e_atUpperLimit&&(ve=Je-this.m_upperAngle,Me=ve,ve=V.Clamp(ve-_.b2_angularSlop,0,_.b2_maxAngularCorrection),Fe=-this.m_motorMass*ve),Be.m_sweep.a-=Be.m_invI*Fe,Ve.m_sweep.a+=Ve.m_invI*Fe,Be.SynchronizeTransform(),Ve.SynchronizeTransform()}{he=Be.m_xf.R;var Pe=this.m_localAnchor1.x-Be.m_sweep.localCenter.x,Re=this.m_localAnchor1.y-Be.m_sweep.localCenter.y;Ie=he.col1.x*Pe+he.col2.x*Re,Re=he.col1.y*Pe+he.col2.y*Re,Pe=Ie,he=Ve.m_xf.R;var Te=this.m_localAnchor2.x-Ve.m_sweep.localCenter.x,ze=this.m_localAnchor2.y-Ve.m_sweep.localCenter.y;Ie=he.col1.x*Te+he.col2.x*ze,ze=he.col1.y*Te+he.col2.y*ze,Te=Ie;var Ee=Ve.m_sweep.c.x+Te-Be.m_sweep.c.x-Pe,ke=Ve.m_sweep.c.y+ze-Be.m_sweep.c.y-Re,Ne=Ee*Ee+ke*ke,je=Math.sqrt(Ne);we=je;var Ue=Be.m_invMass,qe=Ve.m_invMass,Ke=Be.m_invI,We=Ve.m_invI,Oe=10*_.b2_linearSlop;if(Ne>Oe*Oe){var Ye=1/(Ue+qe);Ge=Ye*-Ee,Le=Ye*-ke;var Qe=0.5;Be.m_sweep.c.x-=Qe*Ue*Ge,Be.m_sweep.c.y-=Qe*Ue*Le,Ve.m_sweep.c.x+=Qe*qe*Ge,Ve.m_sweep.c.y+=Qe*qe*Le,Ee=Ve.m_sweep.c.x+Te-Be.m_sweep.c.x-Pe,ke=Ve.m_sweep.c.y+ze-Be.m_sweep.c.y-Re}this.K1.col1.x=Ue+qe,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=Ue+qe,this.K2.col1.x=Ke*Re*Re,this.K2.col2.x=-Ke*Pe*Re,this.K2.col1.y=-Ke*Pe*Re,this.K2.col2.y=Ke*Pe*Pe,this.K3.col1.x=We*ze*ze,this.K3.col2.x=-We*Te*ze,this.K3.col1.y=-We*Te*ze,this.K3.col2.y=We*Te*Te,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.AddM(this.K3),this.K.Solve(ne.tImpulse,-Ee,-ke),Ge=ne.tImpulse.x,Le=ne.tImpulse.y,Be.m_sweep.c.x-=Be.m_invMass*Ge,Be.m_sweep.c.y-=Be.m_invMass*Le,Be.m_sweep.a-=Be.m_invI*(Pe*Le-Re*Ge),Ve.m_sweep.c.x+=Ve.m_invMass*Ge,Ve.m_sweep.c.y+=Ve.m_invMass*Le,Ve.m_sweep.a+=Ve.m_invI*(Te*Le-ze*Ge),Be.SynchronizeTransform(),Ve.SynchronizeTransform()}return we<=_.b2_linearSlop&&Me<=_.b2_angularSlop},Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new G}),Box2D.inherit(ie,Box2D.Dynamics.Joints.b2JointDef),ie.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,ie.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},ie.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_revoluteJoint,this.localAnchorA.Set(0,0),this.localAnchorB.Set(0,0),this.referenceAngle=0,this.lowerAngle=0,this.upperAngle=0,this.maxMotorTorque=0,this.motorSpeed=0,this.enableLimit=!1,this.enableMotor=!1},ie.prototype.Initialize=function(ge,De,ve){this.bodyA=ge,this.bodyB=De,this.localAnchorA=this.bodyA.GetLocalPoint(ve),this.localAnchorB=this.bodyB.GetLocalPoint(ve),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()},Box2D.inherit(me,Box2D.Dynamics.Joints.b2Joint),me.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype,me.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments),this.m_localAnchorA=new G,this.m_localAnchorB=new G,this.m_impulse=new L,this.m_mass=new g},me.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)},me.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)},me.prototype.GetReactionForce=function(ge){return void 0===ge&&(ge=0),new G(ge*this.m_impulse.x,ge*this.m_impulse.y)},me.prototype.GetReactionTorque=function(ge){return void 0===ge&&(ge=0),ge*this.m_impulse.z},me.prototype.b2WeldJoint=function(ge){this.__super.b2Joint.call(this,ge),this.m_localAnchorA.SetV(ge.localAnchorA),this.m_localAnchorB.SetV(ge.localAnchorB),this.m_referenceAngle=ge.referenceAngle,this.m_impulse.SetZero(),this.m_mass=new g},me.prototype.InitVelocityConstraints=function(ge){var De,ve=0,he=this.m_bodyA,Be=this.m_bodyB;De=he.m_xf.R;var Ve=this.m_localAnchorA.x-he.m_sweep.localCenter.x,Me=this.m_localAnchorA.y-he.m_sweep.localCenter.y;ve=De.col1.x*Ve+De.col2.x*Me,Me=De.col1.y*Ve+De.col2.y*Me,Ve=ve,De=Be.m_xf.R;var we=this.m_localAnchorB.x-Be.m_sweep.localCenter.x,Ie=this.m_localAnchorB.y-Be.m_sweep.localCenter.y;ve=De.col1.x*we+De.col2.x*Ie,Ie=De.col1.y*we+De.col2.y*Ie,we=ve;var Ge=he.m_invMass,Le=Be.m_invMass,Je=he.m_invI,Fe=Be.m_invI;this.m_mass.col1.x=Ge+Le+Me*Me*Je+Ie*Ie*Fe,this.m_mass.col2.x=-Me*Ve*Je-Ie*we*Fe,this.m_mass.col3.x=-Me*Je-Ie*Fe,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=Ge+Le+Ve*Ve*Je+we*we*Fe,this.m_mass.col3.y=Ve*Je+we*Fe,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=Je+Fe,ge.warmStarting?(this.m_impulse.x*=ge.dtRatio,this.m_impulse.y*=ge.dtRatio,this.m_impulse.z*=ge.dtRatio,he.m_linearVelocity.x-=Ge*this.m_impulse.x,he.m_linearVelocity.y-=Ge*this.m_impulse.y,he.m_angularVelocity-=Je*(Ve*this.m_impulse.y-Me*this.m_impulse.x+this.m_impulse.z),Be.m_linearVelocity.x+=Le*this.m_impulse.x,Be.m_linearVelocity.y+=Le*this.m_impulse.y,Be.m_angularVelocity+=Fe*(we*this.m_impulse.y-Ie*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()},me.prototype.SolveVelocityConstraints=function(){var De,ve=0,he=this.m_bodyA,Be=this.m_bodyB,Ve=he.m_linearVelocity,Me=he.m_angularVelocity,we=Be.m_linearVelocity,Ie=Be.m_angularVelocity,Ge=he.m_invMass,Le=Be.m_invMass,Je=he.m_invI,Fe=Be.m_invI;De=he.m_xf.R;var Pe=this.m_localAnchorA.x-he.m_sweep.localCenter.x,Re=this.m_localAnchorA.y-he.m_sweep.localCenter.y;ve=De.col1.x*Pe+De.col2.x*Re,Re=De.col1.y*Pe+De.col2.y*Re,Pe=ve,De=Be.m_xf.R;var Te=this.m_localAnchorB.x-Be.m_sweep.localCenter.x,ze=this.m_localAnchorB.y-Be.m_sweep.localCenter.y;ve=De.col1.x*Te+De.col2.x*ze,ze=De.col1.y*Te+De.col2.y*ze,Te=ve;var Ee=we.x-Ie*ze-Ve.x+Me*Re,ke=we.y+Ie*Te-Ve.y-Me*Pe,Ne=Ie-Me,je=new L;this.m_mass.Solve33(je,-Ee,-ke,-Ne),this.m_impulse.Add(je),Ve.x-=Ge*je.x,Ve.y-=Ge*je.y,Me-=Je*(Pe*je.y-Re*je.x+je.z),we.x+=Le*je.x,we.y+=Le*je.y,Ie+=Fe*(Te*je.y-ze*je.x+je.z),he.m_angularVelocity=Me,Be.m_angularVelocity=Ie},me.prototype.SolvePositionConstraints=function(ge){void 0===ge&&(ge=0);var ve=0,he=this.m_bodyA,Be=this.m_bodyB,De;De=he.m_xf.R;var Ve=this.m_localAnchorA.x-he.m_sweep.localCenter.x,Me=this.m_localAnchorA.y-he.m_sweep.localCenter.y;ve=De.col1.x*Ve+De.col2.x*Me,Me=De.col1.y*Ve+De.col2.y*Me,Ve=ve,De=Be.m_xf.R;var we=this.m_localAnchorB.x-Be.m_sweep.localCenter.x,Ie=this.m_localAnchorB.y-Be.m_sweep.localCenter.y;ve=De.col1.x*we+De.col2.x*Ie,Ie=De.col1.y*we+De.col2.y*Ie,we=ve;var Ge=he.m_invMass,Le=Be.m_invMass,Je=he.m_invI,Fe=Be.m_invI,Pe=Be.m_sweep.c.x+we-he.m_sweep.c.x-Ve,Re=Be.m_sweep.c.y+Ie-he.m_sweep.c.y-Me,Te=Be.m_sweep.a-he.m_sweep.a-this.m_referenceAngle,ze=10*_.b2_linearSlop,Ee=Math.sqrt(Pe*Pe+Re*Re),ke=V.Abs(Te);Ee>ze&&(Je*=1,Fe*=1),this.m_mass.col1.x=Ge+Le+Me*Me*Je+Ie*Ie*Fe,this.m_mass.col2.x=-Me*Ve*Je-Ie*we*Fe,this.m_mass.col3.x=-Me*Je-Ie*Fe,this.m_mass.col1.y=this.m_mass.col2.x,this.m_mass.col2.y=Ge+Le+Ve*Ve*Je+we*we*Fe,this.m_mass.col3.y=Ve*Je+we*Fe,this.m_mass.col1.z=this.m_mass.col3.x,this.m_mass.col2.z=this.m_mass.col3.y,this.m_mass.col3.z=Je+Fe;var Ne=new L;return this.m_mass.Solve33(Ne,-Pe,-Re,-Te),he.m_sweep.c.x-=Ge*Ne.x,he.m_sweep.c.y-=Ge*Ne.y,he.m_sweep.a-=Je*(Ve*Ne.y-Me*Ne.x+Ne.z),Be.m_sweep.c.x+=Le*Ne.x,Be.m_sweep.c.y+=Le*Ne.y,Be.m_sweep.a+=Fe*(we*Ne.y-Ie*Ne.x+Ne.z),he.SynchronizeTransform(),Be.SynchronizeTransform(),Ee<=_.b2_linearSlop&&ke<=_.b2_angularSlop},Box2D.inherit(ae,Box2D.Dynamics.Joints.b2JointDef),ae.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype,ae.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments),this.localAnchorA=new G,this.localAnchorB=new G},ae.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this),this.type=W.e_weldJoint,this.referenceAngle=0},ae.prototype.Initialize=function(ge,De,ve){this.bodyA=ge,this.bodyB=De,this.localAnchorA.SetV(this.bodyA.GetLocalPoint(ve)),this.localAnchorB.SetV(this.bodyB.GetLocalPoint(ve)),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}(),function(){var o=Box2D.Dynamics.b2DebugDraw;o.b2DebugDraw=function(){this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1;var n=this;this.m_sprite={graphics:{clear:function clear(){n.m_ctx.clearRect(0,0,n.m_ctx.canvas.width,n.m_ctx.canvas.height)}}}},o.prototype._color=function(n,_){return"rgba("+((16711680&n)>>16)+","+((65280&n)>>8)+","+(255&n)+","+_+")"},o.prototype.b2DebugDraw=function(){this.m_drawFlags=0},o.prototype.SetFlags=function(n){n===void 0&&(n=0),this.m_drawFlags=n},o.prototype.GetFlags=function(){return this.m_drawFlags},o.prototype.AppendFlags=function(n){n===void 0&&(n=0),this.m_drawFlags|=n},o.prototype.ClearFlags=function(n){n===void 0&&(n=0),this.m_drawFlags&=~n},o.prototype.SetSprite=function(n){this.m_ctx=n},o.prototype.GetSprite=function(){return this.m_ctx},o.prototype.SetDrawScale=function(n){n===void 0&&(n=0),this.m_drawScale=n},o.prototype.GetDrawScale=function(){return this.m_drawScale},o.prototype.SetLineThickness=function(n){n===void 0&&(n=0),this.m_lineThickness=n,this.m_ctx.strokeWidth=n},o.prototype.GetLineThickness=function(){return this.m_lineThickness},o.prototype.SetAlpha=function(n){n===void 0&&(n=0),this.m_alpha=n},o.prototype.GetAlpha=function(){return this.m_alpha},o.prototype.SetFillAlpha=function(n){n===void 0&&(n=0),this.m_fillAlpha=n},o.prototype.GetFillAlpha=function(){return this.m_fillAlpha},o.prototype.SetXFormScale=function(n){n===void 0&&(n=0),this.m_xformScale=n},o.prototype.GetXFormScale=function(){return this.m_xformScale},o.prototype.DrawPolygon=function(n,_,S){if(_){var g=this.m_ctx,V=this.m_drawScale;g.beginPath(),g.strokeStyle=this._color(S.color,this.m_alpha),g.moveTo(n[0].x*V,n[0].y*V);for(var M=1;M<_;M++)g.lineTo(n[M].x*V,n[M].y*V);g.lineTo(n[0].x*V,n[0].y*V),g.closePath(),g.stroke()}},o.prototype.DrawSolidPolygon=function(n,_,S){if(_){var g=this.m_ctx,V=this.m_drawScale;g.beginPath(),g.strokeStyle=this._color(S.color,this.m_alpha),g.fillStyle=this._color(S.color,this.m_fillAlpha),g.moveTo(n[0].x*V,n[0].y*V);for(var M=1;M<_;M++)g.lineTo(n[M].x*V,n[M].y*V);g.lineTo(n[0].x*V,n[0].y*V),g.closePath(),g.fill(),g.stroke()}},o.prototype.DrawCircle=function(n,_,S){if(_){var g=this.m_ctx,V=this.m_drawScale;g.beginPath(),g.strokeStyle=this._color(S.color,this.m_alpha),g.arc(n.x*V,n.y*V,_*V,0,2*Math.PI,!0),g.closePath(),g.stroke()}},o.prototype.DrawSolidCircle=function(n,_,S,g){if(_){var V=this.m_ctx,M=this.m_drawScale,w=n.x*M,G=n.y*M;V.moveTo(0,0),V.beginPath(),V.strokeStyle=this._color(g.color,this.m_alpha),V.fillStyle=this._color(g.color,this.m_fillAlpha),V.arc(w,G,_*M,0,2*Math.PI,!0),V.moveTo(w,G),V.lineTo((n.x+S.x*_)*M,(n.y+S.y*_)*M),V.closePath(),V.fill(),V.stroke()}},o.prototype.DrawSegment=function(n,_,S){var g=this.m_ctx,V=this.m_drawScale;g.strokeStyle=this._color(S.color,this.m_alpha),g.beginPath(),g.moveTo(n.x*V,n.y*V),g.lineTo(_.x*V,_.y*V),g.closePath(),g.stroke()},o.prototype.DrawTransform=function(n){var _=this.m_ctx,S=this.m_drawScale;_.beginPath(),_.strokeStyle=this._color(16711680,this.m_alpha),_.moveTo(n.position.x*S,n.position.y*S),_.lineTo((n.position.x+this.m_xformScale*n.R.col1.x)*S,(n.position.y+this.m_xformScale*n.R.col1.y)*S),_.strokeStyle=this._color(65280,this.m_alpha),_.moveTo(n.position.x*S,n.position.y*S),_.lineTo((n.position.x+this.m_xformScale*n.R.col2.x)*S,(n.position.y+this.m_xformScale*n.R.col2.y)*S),_.closePath(),_.stroke()}}();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();window.Box2D=Box2D,window.b2Vec2=Box2D.Common.Math.b2Vec2,window.b2BodyDef=Box2D.Dynamics.b2BodyDef,window.b2Body=Box2D.Dynamics.b2Body,window.b2FixtureDef=Box2D.Dynamics.b2FixtureDef,window.b2Fixture=Box2D.Dynamics.b2Fixture,window.b2World=Box2D.Dynamics.b2World,window.b2ContactListener=Box2D.Dynamics.b2ContactListener,window.b2FilterData=Box2D.Dynamics.b2FilterData,window.b2MassData=Box2D.Collision.Shapes.b2MassData,window.b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,window.b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,window.b2DebugDraw=Box2D.Dynamics.b2DebugDraw,window.b2JointDef=Box2D.Dynamics.Joints.b2JointDef,window.b2RevoluteJointDef=Box2D.Dynamics.Joints.b2RevoluteJointDef;